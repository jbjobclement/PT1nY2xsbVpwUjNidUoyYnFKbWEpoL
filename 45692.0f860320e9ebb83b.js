"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[45692],{45692:(X,u,a)=>{a.r(u),a.d(u,{AllPushLogsModule:()=>W});var p=a(96814),m=a(23758);const g={index:"/api/app/all-notification-push-logs"},v=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"}],C=[],h=[{dataField:"id",mapping:["notificationPushLogId"]},{dataField:"notificationPushLogId",mapping:["notificationPushLogId"]},{dataField:"notificationSchedulePlanName",queryStringKey:"NotificationSchedulePlanName",mapping:["notificationSchedulePlanName"]},{dataField:"pushTime",queryStringKey:"PushTime",mapping:["pushTime"]},{dataField:"receiverName",queryStringKey:"ReceiverName",mapping:["receiverName"]},{dataField:"title",queryStringKey:"Title",mapping:["title"]},{dataField:"subtitle",queryStringKey:"Subtitle",mapping:["subtitle"]},{dataField:"shortTextContent",queryStringKey:"TextContent",mapping:["shortTextContent"]},{dataField:"shortHtmlContent",queryStringKey:"HtmlContent",mapping:["shortHtmlContent"]},{dataField:"isModifiedWhenPending",queryStringKey:"IsModifiedWhenPending",mapping:["isModifiedWhenPending"]},{dataField:"isSuccess",queryStringKey:"IsSuccess",mapping:["isSuccess"]},{dataField:"shortResultMessages",queryStringKey:"ShortResultMessages",mapping:["shortResultMessages"]},{dataField:"isReceiverRead",queryStringKey:"IsReceiverRead",mapping:["isReceiverRead"]},{dataField:"isRePushable",queryStringKey:"IsRePushable",mapping:["isRePushable"]}],f={imageUpload:{fileUploadMode:"both",tabs:["url","file"]},toolbar:{items:[{name:"undo"},{name:"redo"},{name:"separator"},{name:"size",acceptedValues:["8pt","10pt","12pt","14pt","18pt","24pt","36pt"]},{name:"font",acceptedValues:["Arial","Georgia","Tahoma","Times New Roman","Verdana"]},{name:"separator"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"underline"},{name:"separator"},{name:"alignLeft"},{name:"alignCenter"},{name:"alignRight"},{name:"alignJustify"},{name:"separator"},{name:"orderedList"},{name:"bulletList"},{name:"separator"},{name:"header",acceptedValues:[!1,1,2,3,4,5]},{name:"separator"},{name:"color"},{name:"background"},{name:"separator"},{name:"link"},{name:"image"},{name:"separator"},{name:"clear"},{name:"codeBlock"},{name:"blockquote"},{name:"separator"},{name:"insertTable"},{name:"deleteTable"},{name:"insertRowAbove"},{name:"insertRowBelow"},{name:"deleteRow"},{name:"insertColumnLeft"},{name:"insertColumnRight"},{name:"deleteColumn"},{name:"cellProperties"},{name:"tableProperties"}]}},y=[{itemType:"group",name:"basicGroup",caption:"\u57fa\u672c",colCount:2,items:[{dataField:"notificationProviderDefinitionIds"},{itemType:"group",name:"receiverGroup",colCount:2,items:[{dataField:"isForAllReceivers",editorType:"dxCheckBox"},{itemType:"empty"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]}]},{itemType:"group",name:"notificationSettingGroup",caption:"\u8a2d\u5b9a",colCount:2,items:[{dataField:"notificationSettingRadioGroup",label:{visible:!1}},{dataField:"notificationSettingItems",label:{visible:!1}}]},{itemType:"group",name:"notificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{dataField:"title",editorType:"dxTextBox"},{itemType:"group",name:"textboxGroup",items:[{dataField:"subtitle",editorType:"dxTextBox"},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"}]},{itemType:"group",name:"textareaGroup",items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"100px"}},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox"}]},{dataField:"htmlContent",colSpan:2,editorType:"dxHtmlEditor",editorOptions:{...f,height:"250px"}}]}],P=[{itemType:"group",name:"basicGroup",caption:"\u57fa\u672c",colCount:2,items:[{dataField:"notificationProviderDefinitionIds"},{itemType:"group",name:"receiverGroup",colCount:2,items:[{dataField:"isForAllReceivers",editorType:"dxCheckBox",editorOptions:{disabled:!0}},{itemType:"empty"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]}]},{itemType:"group",name:"notificationSettingGroup",caption:"\u8a2d\u5b9a",colCount:2,items:[{dataField:"notificationSettingRadioGroup",label:{visible:!1}},{dataField:"notificationSettingItems",label:{visible:!1}}]},{itemType:"group",name:"notificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"notificationCategoryId",editorType:"dxSelectBox",editorOptions:{disabled:!0}},{dataField:"title",editorType:"dxTextBox",editorOptions:{disabled:!0}},{itemType:"group",name:"textboxGroup",items:[{dataField:"subtitle",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"hookEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}}]},{itemType:"group",name:"textareaGroup",items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"100px",disabled:!0}},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",editorOptions:{disabled:!0}}]},{dataField:"htmlContent",colSpan:2,editorType:"dxHtmlEditor",editorOptions:{...f,height:"250px",disabled:!0}}]}],S={form:{colCount:1,items:y}},b={form:{colCount:1,items:P},popup:{wrapperAttr:{class:"instant-notification-infos-view"},toolbarItems:[]}},L=[{type:"buttons",fixed:!0,buttons:[{name:"repush",template:"repush",visible:t=>t.row.data.isRePushable}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"notificationPushLogId",visible:!1},{dataField:"notificationSchedulePlanName",caption:"\u6642\u9593\u8a08\u756b\u540d\u7a31",dataType:"string"},{dataField:"pushTime",caption:"\u63a8\u9001\u6642\u9593",dataType:"datetime",format:"yyyy/MM/dd HH:mm:ss",filterOperations:a(35461).I.datetime},{dataField:"receiverName",caption:"\u63a5\u6536\u8005\u540d\u7a31",dataType:"string"},{dataField:"title",caption:"\u6a19\u984c",dataType:"string"},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string"},{dataField:"shortTextContent",caption:"\u7d14\u6587\u5b57\u5167\u5bb9",cellTemplate:"shortTextContent"},{dataField:"shortHtmlContent",caption:"HTML\u5167\u5bb9",cellTemplate:"shortHtmlContent"},{dataField:"isModifiedWhenPending",caption:"\u7b49\u5019\u5340\u7570\u52d5",dataType:"boolean"},{dataField:"isSuccess",caption:"\u6210\u529f",dataType:"boolean"},{dataField:"shortResultMessages",caption:"\u8a73\u7d30\u8a0a\u606f",dataType:"string"},{dataField:"isReceiverRead",caption:"\u63a5\u6536\u8005\u5df2\u8b80",dataType:"boolean"}];var e=a(19212),M=a(53009),A=a(67),I=a(72783),B=a(88762),K=a(24270),O=a(20481),N=a(64133),G=a(20843),T=a(2173),_=a(25012),x=a(89267),F=a(33630);const Q=["grid"];function J(t,s){if(1&t&&e._UZ(0,"app-grid-general-filter",9),2&t){e.oxw();const i=e.MAs(1);e.Q6J("grid",i)}}function D(t,s){1&t&&e.GkF(0)}const U=t=>({$implicit:t});function w(t,s){if(1&t&&(e.ynx(0),e.YNc(1,D,1,0,"ng-container",11),e.BQk()),2&t){const i=s.$implicit,n=e.oxw().$implicit,o=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",o.templateStore.getGridTemplates(n.key))("ngTemplateOutletContext",e.VKq(2,U,i))}}function Z(t,s){if(1&t&&(e.ynx(0),e.YNc(1,w,2,4,"ng-container",10),e.BQk()),2&t){const i=s.$implicit;e.xp6(),e.Q6J("dxTemplateOf",i.key)}}function H(t,s){if(1&t&&e._UZ(0,"app-text-content-viewer",12),2&t){const i=s.$implicit;e.Q6J("simplifiedText",i.value)("url","/api/app/all-notification-push-logs/text-contents/"+(null==i.data?null:i.data.id))}}function k(t,s){if(1&t&&e._UZ(0,"app-html-content-viewer",12),2&t){const i=s.$implicit;e.Q6J("simplifiedText",i.value)("url","/api/app/all-notification-push-logs/html-contents/"+(null==i.data?null:i.data.id))}}function E(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"app-repush-button",13),e.NdJ("buttonClick",function(){const l=e.CHM(i).$implicit,d=e.oxw();return e.KtG(d.singleRepush(l.data.notificationPushLogId))}),e.qZA()}}const V=[{path:"",component:(()=>{class t{constructor(i,n,o,l,d){this.appRestService=i,this.gridDataSourceService=n,this.templateStore=o,this.configStateService=l,this.toastService=d,this.columns=L,this.cRUDEndpoints=g,this.dataFieldLookupSourceMapping=v,this.dataFieldTranslationKeysMapping=C,this.relatedDataValueAndQueryStringKeyMapping=h,this.editingPropertiesForCreating=S,this.editingPropertiesForUpdating=b,this.selectedNotificationPushLogs=[],this.textContent="",this.htmlContent="",this.gridProperties={editing:{allowAdding:!1},selection:{mode:"multiple",allowSelectAll:!0,selectAllMode:"page"}},this.repushButtonProperties={type:"default",stylingMode:"contained",text:"\u518d\u6b21\u767c\u9001(\u591a\u7b46)",onClick:()=>{const r=this.selectedNotificationPushLogs.map(c=>c.notificationPushLogId);this.repush(r)}},this.repush=r=>{const c=this.configStateService.getOne("currentUser");this.appRestService.request({method:"POST",url:"/api/app/all-notification-push-logs/repush-by-notification-push-log-ids",body:{tenantId:c.tenantId,notificationPushLogIds:r}}).subscribe(()=>{this.toastService.success("\u64cd\u4f5c\u6210\u529f!\uff0c\u56e0\u767c\u9001\u9700\u8981\u6642\u9593\uff0c\u6210\u529f\u6b21\u6578\u4e0d\u6703\u99ac\u4e0a\u767c\u751f\u8b8a\u5316\u3002")})},this.columns.find(r=>"shortResultMessages"===r.dataField).calculateDisplayValue=r=>r.shortResultMessages||"\u7121\u932f\u8aa4\u8a0a\u606f"}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(g,h)}singleRepush(i){this.repush([i])}static#e=this.\u0275fac=function(n){return new(n||t)(e.Y36(M.$),e.Y36(A.I),e.Y36(I.z),e.Y36(B.XJE),e.Y36(K.P))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-all-push-logs"]],viewQuery:function(n,o){if(1&n&&e.Gf(Q,5),2&n){let l;e.iGM(l=e.CRH())&&(o.grid=l.first)}},decls:12,vars:16,consts:[["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","gridProperties","selectedRowKeys","selectedRowKeysChange"],["grid",""],["location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"simplifiedText","url",4,"dxTemplate","dxTemplateOf"],[3,"buttonClick",4,"dxTemplate","dxTemplateOf"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"simplifiedText","url"],[3,"buttonClick"]],template:function(n,o){1&n&&(e.TgZ(0,"dx-data-grid",0,1),e.NdJ("selectedRowKeysChange",function(d){return o.selectedNotificationPushLogs=d}),e.TgZ(2,"dxo-toolbar"),e._UZ(3,"dxi-item",2),e.TgZ(4,"dxi-item",3),e.YNc(5,J,1,1,"app-grid-general-filter",4),e.qZA(),e._UZ(6,"dxi-item",5),e.qZA(),e.YNc(7,Z,2,1,"ng-container",6),e.ALo(8,"keyvalue"),e.YNc(9,H,1,2,"app-text-content-viewer",7)(10,k,1,2,"app-html-content-viewer",7)(11,E,1,0,"app-repush-button",8),e.qZA()),2&n&&(e.Q6J("dataFieldTranslationKeysMapping",o.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("editingPropertiesForCreating",o.editingPropertiesForCreating)("editingPropertiesForUpdating",o.editingPropertiesForUpdating)("columns",o.columns)("dataSource",o.gridDataSource)("gridProperties",o.gridProperties)("selectedRowKeys",o.selectedNotificationPushLogs),e.xp6(3),e.Q6J("options",o.repushButtonProperties),e.xp6(4),e.Q6J("ngForOf",e.lcZ(8,14,o.templateStore.gridTemplates)),e.xp6(2),e.Q6J("dxTemplateOf","shortTextContent"),e.xp6(),e.Q6J("dxTemplateOf","shortHtmlContent"),e.xp6(),e.Q6J("dxTemplateOf","repush"))},dependencies:[p.sg,p.tP,O._,N.f,G.p6,T.ZT3,_.e,T.y1f,x.Q,F.$,p.Nd]})}return t})()}];let Y=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(V),m.Bz]})}return t})();var $=a(31610),z=a(5533);let W=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[p.ez,$.m,z.P,Y,x.Q,F.$]})}return t})()}}]);