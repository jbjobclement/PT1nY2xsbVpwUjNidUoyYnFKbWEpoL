"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[1685],{46203:(x,v,t)=>{t.d(v,{J:()=>m});var p=t(21137),o=t(6990),d=t(88762),e=t(19212),h=t(53009);const f=(u,l)=>l.id;function _(u,l){if(1&u){const n=e.EpF();e.TgZ(0,"div",1)(1,"dx-check-box",2),e.NdJ("click",function(c){const s=e.CHM(n).$implicit,r=e.oxw();return e.KtG(r.checkIsOnlyOneNotificationProviderDefinitionIdSelected(c,s.id))})("onValueChanged",function(c){const s=e.CHM(n).$implicit,r=e.oxw();return e.KtG(r.onValueChanged(c,s.id))}),e.qZA()()}if(2&u){const n=l.$implicit,i=e.oxw();e.xp6(),e.Q6J("text",n.name)("value",i.checkIsNotificationProviderDefinitionIdSelected(n.id))("disabled",i.isViewMode)}}let m=(()=>{class u{constructor(n){this.appRestService=n,this.isViewMode=!1,this.notificationProviderDefinitions=[],this.notificationProviderDefinitionIds=[]}ngOnInit(){this.fetchNotificationProviderDefinitions()}onValueChanged(n,i){this.updateNotificationProviderDefinitionIds(n.value,i)}fetchNotificationProviderDefinitions(){this.appRestService.request({method:"GET",url:"/api/app/notification-infos/assignable-notification-provider-definitions"}).subscribe(n=>{n.items.forEach(i=>{this.notificationProviderDefinitions.push((0,o.cloneDeep)(i))}),this.fillUpNotificationProviderDefinitionIds()})}fillUpNotificationProviderDefinitionIds(){this.cellInfo.value&&0!==this.cellInfo.value.length?this.notificationProviderDefinitionIds=[...this.cellInfo.value]:this.initNotificationProviderDefinitionIds(),this.cellInfo.setValue((0,o.cloneDeep)(this.notificationProviderDefinitionIds))}initNotificationProviderDefinitionIds(){this.notificationProviderDefinitionIds.push(this.notificationProviderDefinitions[0].id)}checkIsNotificationProviderDefinitionIdSelected(n){return this.notificationProviderDefinitionIds.includes(n)}checkIsOnlyOneNotificationProviderDefinitionIdSelected(n,i){1===this.notificationProviderDefinitionIds.length&&this.checkIsNotificationProviderDefinitionIdSelected(i)&&n.stopImmediatePropagation()}updateNotificationProviderDefinitionIds(n,i){const c=this.notificationProviderDefinitionIds.indexOf(i);n&&-1===c?this.notificationProviderDefinitionIds.push(i):!n&&-1!==c&&this.notificationProviderDefinitionIds.splice(c,1),this.cellInfo.setValue((0,o.cloneDeep)(this.notificationProviderDefinitionIds))}static#e=this.\u0275fac=function(i){return new(i||u)(e.Y36(h.$))};static#i=this.\u0275cmp=e.Xpm({type:u,selectors:[["app-notification-provider-definitions"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[e.jDz],decls:3,vars:0,consts:[[1,"row"],[1,"col-4"],[3,"text","value","disabled","click","onValueChanged"],["class","col-4"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e.SjG(1,_,2,3,"div",3,f),e.qZA()),2&i&&(e.xp6(),e.wJu(c.notificationProviderDefinitions))},dependencies:[p.W,p.v,d.vaR]})}return u})()},36744:(x,v,t)=>{t.d(v,{b:()=>g});var p=t(86359),o=t(19212);let g=(()=>{class d{constructor(){this.isViewMode=!1,this.notificationSettingRadioGroupDataSource=[],this.notificationSettingRadioGroupValue=null}ngOnInit(){this.notificationSettingRadioGroupDataSource=[{type:"share",text:"\u5957\u7528\u5171\u7528\u8a2d\u5b9a"},{type:"custom",text:"\u53e6\u884c\u8a2d\u5b9a"}],this.notificationSettingRadioGroupValue=this.notificationSettingRadioGroupDataSource[0]}onNotificationSettingRadioGroupChanged(h){this.cellInfo.setValue("share"===h.value.type?"share":"custom")}static#e=this.\u0275fac=function(f){return new(f||d)};static#i=this.\u0275cmp=o.Xpm({type:d,selectors:[["app-notification-setting-items-radio-group"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[o.jDz],decls:2,vars:3,consts:[["displayExpr","text","layout","horizontal",3,"dataSource","value","readOnly","valueChange","onValueChanged"],["radioGroup",""]],template:function(f,_){1&f&&(o.TgZ(0,"dx-radio-group",0,1),o.NdJ("valueChange",function(u){return _.notificationSettingRadioGroupValue=u})("onValueChanged",function(u){return _.onNotificationSettingRadioGroupChanged(u)}),o.qZA()),2&f&&o.Q6J("dataSource",_.notificationSettingRadioGroupDataSource)("value",_.notificationSettingRadioGroupValue)("readOnly",_.isViewMode)},dependencies:[p._,p.I]})}return d})()},90962:(x,v,t)=>{t.d(v,{b:()=>n});var p=t(6990),g=t(74291),d=t(10518),e=t(19212),h=t(53009);const f=(i,c)=>c.notificationSettingDefinitionId;function _(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"dx-select-box",6),e.NdJ("valueChange",function(r){e.CHM(a);const C=e.oxw().$implicit;return e.KtG(C.value=r)})("onValueChanged",function(r){e.CHM(a);const C=e.oxw().$index,I=e.oxw(2);return e.KtG(I.onSettingValueChanged(r,C))}),e.qZA()}if(2&i){const a=e.oxw().$implicit,s=e.oxw(2);e.Q6J("dataSource",s.selectBoxDataSource)("value",a.value)}}function m(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"dx-text-box",7),e.NdJ("valueChange",function(r){e.CHM(a);const C=e.oxw().$implicit;return e.KtG(C.value=r)})("onValueChanged",function(r){e.CHM(a);const C=e.oxw().$index,I=e.oxw(2);return e.KtG(I.onSettingValueChanged(r,C))}),e.qZA()}if(2&i){const a=e.oxw().$implicit;e.Q6J("value",a.value)}}function u(i,c){if(1&i&&(e.TgZ(0,"div",3)(1,"div",2),e._uU(2),e.qZA(),e.TgZ(3,"div",4),e.YNc(4,_,1,2,"dx-select-box",5)(5,m,1,1),e.qZA()()),2&i){const a=c.$implicit,s=c.$index,r=e.oxw(2);e.xp6(2),e.hij(" ",r.displayNames[s]," "),e.xp6(2),e.um2(4,"b6b5fb16-6f45-f7ad-85e3-3a1229a3ead0"===a.notificationSettingDefinitionId?4:5)}}function l(i,c){if(1&i&&(e.TgZ(0,"label",0)(1,"span",1)(2,"span",2),e._uU(3,"\u901a\u77e5\u8a2d\u5b9a"),e.qZA()()(),e.SjG(4,u,6,2,"div",8,f)),2&i){const a=e.oxw();e.xp6(4),e.wJu(a.notificationSetting)}}let n=(()=>{class i{constructor(a){this.appRestService=a,this.isUseCustomSetting=!1,this.isViewMode=!1,this.notificationSetting=[],this.displayNames=[],this.selectBoxDataSource=["A","M"]}ngOnChanges(){this.applyNotificationSettingItems(),this.fetchCustomNotificationSettingItems(),this.clearCustomNotificationSettingItems()}applyNotificationSettingItems(){if(0===this.notificationSetting.length)return;const a=(0,p.cloneDeep)(this.notificationSetting);this.cellInfo.setValue(a)}fetchCustomNotificationSettingItems(){!this.isUseCustomSetting||this.notificationSetting.length>0||this.appRestService.request({method:"GET",url:"/api/app/notification-settings/current-tenant"}).subscribe(a=>{a.forEach(s=>{this.notificationSetting.push((0,p.cloneDeep)({notificationSettingDefinitionId:s.notificationSettingDefinition.id,value:s.notificationSetting.value||s.notificationSettingDefinition.defaultValue,isInherited:s.notificationSetting.isInherited})),this.displayNames.push(s.notificationSettingDefinition.displayName)}),this.applyNotificationSettingItems()})}clearCustomNotificationSettingItems(){this.isUseCustomSetting||0===this.notificationSetting.length||this.cellInfo.setValue(null)}onSettingValueChanged(a,s){this.notificationSetting[s].value=a.value,this.applyNotificationSettingItems()}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(h.$))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-notification-setting-items"]],inputs:{isUseCustomSetting:"isUseCustomSetting",cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[e.TTD,e.jDz],decls:1,vars:1,consts:[[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],[1,"d-flex","align-items-center","mb-3"],[1,"ps-3","pe-3"],["valueChangeEvent","keyup",3,"dataSource","value"],["valueChangeEvent","keyup",3,"dataSource","value","valueChange","onValueChanged"],["valueChangeEvent","keyup",3,"value","valueChange","onValueChanged"],["class","d-flex align-items-center mb-3"]],template:function(s,r){1&s&&e.YNc(0,l,6,0),2&s&&e.um2(0,r.isUseCustomSetting?0:-1)},dependencies:[g.a,g.I,d.D,d._]})}return i})()},98991:(x,v,t)=>{t.d(v,{D:()=>g});var p=t(26600),o=t(19212);let g=(()=>{class d{constructor(){this.isViewMode=!1,this.hideReceiverTreeView=!1,this.selected=["1","1-1-1","2-1"],this.dataSource=[{id:"1",name:"1"},{id:"1-1",name:"1-1",parentId:"1"},{id:"1-1-1",name:"1-1-1",parentId:"1-1"},{id:"1-1-2",name:"1-1-2",parentId:"1-1"},{id:"2",name:"2"},{id:"2-1",name:"2-1",parentId:"2"},{id:"2-1-1",name:"2-1-1",parentId:"2-1"},{id:"2-1-2",name:"2-1-2",parentId:"2-1"},{id:"2-1-3",name:"2-1-3",parentId:"2-1"}]}selectedChange(h){this.selected=h}static#e=this.\u0275fac=function(f){return new(f||d)};static#i=this.\u0275cmp=o.Xpm({type:d,selectors:[["app-receiver-group-tree-view"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode",hideReceiverTreeView:"hideReceiverTreeView"},standalone:!0,features:[o.jDz],decls:6,vars:3,consts:[[3,"hidden"],[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],[3,"selected","dataSource","selectedChange"]],template:function(f,_){1&f&&(o.TgZ(0,"div",0)(1,"label",1)(2,"span",2)(3,"span",3),o._uU(4," \u63a5\u6536\u7fa4\u7d44 (\u591a\u7b46) "),o.qZA()()(),o.TgZ(5,"app-jb-tree-view",4),o.NdJ("selectedChange",function(u){return _.selectedChange(u)}),o.qZA()()),2&f&&(o.Q6J("hidden",_.hideReceiverTreeView),o.xp6(5),o.Q6J("selected",_.selected)("dataSource",_.dataSource))},dependencies:[p.c]})}return d})()},38653:(x,v,t)=>{t.d(v,{k:()=>_});var p=t(96814),o=t(61157),g=t(37398),d=t(66648),e=t(19212),h=t(88762),f=t(24106);let _=(()=>{class m{constructor(l,n){this.restService=l,this.localizationService=n,this.isViewMode=!1,this.hideReceiverTagBox=!1,this.receiversDataSource$=null,this.currentDataField=""}ngOnInit(){this.currentDataField=this.cellInfo.column.dataField,this.cellInfo.column.validationRules=[{type:"custom",message:this.localizationService.instant("AbpValidation::ThisFieldIsRequired."),validationCallback:this.receiverTagBoxValidationCallback}],this.receiversDataSource$=this.restService.request({method:"GET",url:"/api/app/notification-infos/assignable-receivers"}).pipe((0,g.U)(l=>l.items))}receiverTagBoxValidationCallback(l){return console.log(l),!!(l.data.isForAllReceivers||l.data[l.column.dataField]&&0!==l.data[l.column.dataField].length)}static#e=this.\u0275fac=function(n){return new(n||m)(e.Y36(h.vgb),e.Y36(h.oQ8))};static#i=this.\u0275cmp=e.Xpm({type:m,selectors:[["app-receiver-tag-box"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode",hideReceiverTagBox:"hideReceiverTagBox"},standalone:!0,features:[e.jDz],decls:7,vars:6,consts:[[3,"hidden"],[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],["appTagBox","","receiverTagBox","","displayExpr","name","valueExpr","id","validationMessageMode","always",3,"dataSource","value","disabled","onValueChanged"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"label",1)(2,"span",2)(3,"span",3),e._uU(4," \u63a5\u6536\u8005 (\u591a\u7b46) "),e.qZA()()(),e.TgZ(5,"dx-tag-box",4),e.NdJ("onValueChanged",function(a){return i.cellInfo.setValue(a.value)}),e.ALo(6,"async"),e.qZA()()),2&n&&(e.Q6J("hidden",i.hideReceiverTagBox),e.xp6(5),e.Q6J("dataSource",e.lcZ(6,4,i.receiversDataSource$))("value",i.cellInfo.value)("disabled",i.isViewMode))},dependencies:[o._,o.U,p.ez,p.Ov,d.m,f.x],styles:["dx-tag-box[apptagbox][receiverTagBox] .dx-overlay-wrapper.dx-invalid-message.dx-invalid-message-always{width:100%!important}"]})}return m})()}}]);