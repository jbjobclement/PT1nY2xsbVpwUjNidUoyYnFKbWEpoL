"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[87845],{87845:(q,m,i)=>{i.r(m),i.d(m,{CronExpressionsJobListModule:()=>z});var d=i(96814),c=i(23758),r=i(35461),h=i(93116),l=i(85054);const C=[{type:"buttons",fixed:!0,buttons:[{name:"delete",template:"grid-delete-button",visible:e=>e.row.data.isDeletable}],width:36},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:r.I$.text,headerCellTemplate:"tenantName",minWidth:120},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:r.I$.text,headerCellTemplate:"notificationCategoryName",minWidth:120},{dataField:"name",caption:"\u901a\u77e5\u540d\u7a31",dataType:"string",filterOperations:r.I$.text,validationRules:[l.L],headerCellTemplate:"notificationName",minWidth:120},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:r.I$.text,validationRules:[l.L],headerCellTemplate:"notificationTitle",minWidth:120},{name:"notificationProviders",caption:"\u901a\u77e5\u63d0\u4f9b\u8005",dataType:"string",filterOperations:r.I$.text,calculateDisplayValue:e=>e.notificationProviders?.map(p=>p.displayName).join("\u3001"),headerCellTemplate:"notificationProviders",minWidth:120,allowSorting:!1,allowFiltering:!1},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:r.I$.text,headerCellTemplate:"receiverDescription",minWidth:120,allowSorting:!1,allowFiltering:!1},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:r.I$.text,headerCellTemplate:"notificationDataFetchEndpoint",minWidth:120,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:r.I$.text,headerCellTemplate:"hookEndpoint",minWidth:120,visible:!1},{dataField:"expectedEndTime",caption:"\u9810\u8a08\u7d50\u675f\u6642\u9593",dataType:"datetime",filterOperations:r.I$.datetime,headerCellTemplate:"expectedEndTime",minWidth:120,calculateDisplayValue:e=>e.notificationSchedulePlan?.expectedEndTime?(0,h.m)(e.notificationSchedulePlan?.expectedEndTime):"",visible:!1},{dataField:"expectedPushCount",caption:"\u9810\u8a08\u63a8\u9001\u6b21\u6578",dataType:"number",filterOperations:r.I$.number,alignment:"left",visible:!1},{dataField:"isFullyFinished",caption:"\u5168\u90e8\u7d50\u675f",dataType:"boolean"},{dataField:"isCompletelySuccessful",caption:"\u5168\u90e8\u5b8c\u6210",dataType:"boolean",calculateCellValue:e=>!!e.isCompletelySuccessful},{dataField:"notificationProviderIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviderIds",validationRules:[l.L]},{dataField:"isSendToAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isSendToAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"topicIds",caption:"\u4e3b\u984c (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"topicIds"},{dataField:"isIndependentNotificationSettingUsing",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettings"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[l.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[l.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"filePaths",dataType:"string",visible:!1},{dataField:"hyperlink",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"textContentNotificationTemplateId",caption:"\u901a\u77e5\u6a21\u677f Id",dataType:"string",visible:!1},{dataField:"textContentNotificationTemplateArgs",caption:"\u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"textContentNotificationTemplateArgs"}],v={index:"/api/app/jbnotifier-admin/cron-expressions/notifications",get:"/api/app/jbnotifier-admin/cron-expressions/notifications",create:"/api/app/jbnotifier-admin/cron-expressions/notifications",update:"/api/app/jbnotifier-admin/cron-expressions/notifications",delete:"/api/app/jbnotifier-admin/cron-expressions/notifications"},T=[{dataField:"notificationProviderIds",path:"/api/app/recurring-notifications/notification-provider-lookup"},{dataField:"receiverIds",path:"/api/app/recurring-notifications/receiver-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receivers"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receiver-groups"},{dataField:"topicIds",path:"/api/app/recurring-notifications/topic-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/topics"},{dataField:"textContentNotificationTemplateId",path:"/api/app/recurring-notifications/notification-template-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/notification-templates"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app//receiver-groups"},{dataField:"notificationCategoryId",path:"/api/app/recurring-notifications/notification-category-lookup",pathForSelectedDisplay:"/api/app/notification-categories"}],f=[{dataField:"id",mapping:["notificationSchedulePlan","id"]},{dataField:"concurrencyStamp",mapping:["notificationInfo","concurrencyStamp"]},{dataField:"type",mapping:["notificationInfo","type"]},{dataField:"title",queryStringKey:"Title",mapping:["notificationInfo","title"]},{name:"name",queryStringKey:"Name",mapping:["notificationInfo","name"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategory","name"]},{name:"notificationProviders",queryStringKey:"NotificationProviderNames",mapping:["notificationProviders"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["notificationInfo","hookEndpoint"]},{dataField:"isFullyFinished",queryStringKey:"IsFullyFinished",mapping:["notificationInfo","isFullyFinished"]},{dataField:"isCompletelySuccessful",queryStringKey:"IsCompletelySuccessful",mapping:["notificationInfo","isCompletelySuccessful"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderIds",mapping:["notificationProviderIds"]},{dataField:"isSendToAllReceivers",mapping:["notificationInfo","isSendToAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"topicIds",mapping:["topicIds"]},{dataField:"isIndependentNotificationSettingUsing",mapping:["notificationInfo","isIndependentNotificationSettingUsing"]},{dataField:"notificationSettings",mapping:["notificationSettings"]},{dataField:"notificationCategoryId",mapping:["notificationCategory","id"]},{dataField:"subtitle",mapping:["notificationInfo","subtitle"]},{dataField:"textContent",mapping:["notificationInfo","textContent"]},{dataField:"htmlContent",mapping:["notificationInfo","htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["notificationInfo","isFetchNotificationDataByEachReceiver"]},{dataField:"filePaths",mapping:["notificationInfo","filePaths"]},{dataField:"hyperlink",mapping:["notificationInfo","hyperlink"]},{dataField:"textContentNotificationTemplateId",mapping:["textContentNotificationTemplate","id"]},{dataField:"htmlContentNotificationTemplateId",mapping:["htmlContentNotificationTemplate","id"]},{dataField:"textContentNotificationTemplateArgs",mapping:["notificationInfo","textContentNotificationTemplateArgs"]},{dataField:"htmlContentNotificationTemplateArgs",mapping:["notificationInfo","htmlContentNotificationTemplateArgs"]},{name:"notificationSchedulePlan",mapping:["notificationSchedulePlan"]},{dataField:"expectedPushCount",mapping:["notificationSchedulePlan","expectedPushCount"]},{dataField:"expectedEndTime",mapping:["notificationSchedulePlan","expectedEndTime"]}],g=[{itemType:"group",name:"CronExpressionGroup",cssClass:"CronExpressionGroup",colCount:2,caption:"\u6bcf\u5206\u9418 | ******",items:[{dataField:"expectedPushCount",editorType:"dxNumberBox",editorOptions:{min:0}},{dataField:"expectedEndTime",editorType:"dxDateBox",editorOptions:{dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss.SSS+08:00"}}]},{itemType:"group",name:"TopGroup",cssClass:"TopGroup",colCount:8,items:[{itemType:"group",name:"BasicGroup",cssClass:"BasicGroup",caption:"\u57fa\u672c",colSpan:5,items:[{dataField:"notificationProviderIds",label:{visible:!1}},{dataField:"isSendToAllReceivers",cssClass:"isSendToAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}},{dataField:"topicIds",label:{visible:!1}}]},{itemType:"group",name:"SettingGroup",cssClass:"SettingGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",label:{visible:!1}}]}]},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",cssClass:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...i(35130).W,height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"textContentNotificationTemplateId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"textContentNotificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"EndpointGroup",cssClass:"EndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"}]}]}],F={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:g,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}},b={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:g,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}};var t=i(19212),S=i(67),I=i(72783),E=i(82310),N=i(59444),P=i(53009),D=i(16358),A=i(20843),O=i(25012),G=i(67846),j=i(13443),M=i(65343),U=i(35098),R=i(21194),u=i(34906);const B=["grid"];function J(e,p){1&e&&t.GkF(0)}const y=e=>({$implicit:e});function L(e,p){if(1&e&&(t.ynx(0),t.YNc(1,J,1,0,"ng-container",9),t.BQk()),2&e){const o=p.$implicit,a=t.oxw().$implicit,n=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",t.VKq(2,y,o))}}function K(e,p){if(1&e&&(t.ynx(0),t.YNc(1,L,2,4,"ng-container",10),t.BQk()),2&e){const o=p.$implicit;t.xp6(),t.Q6J("dxTemplateOf",o.key)}}function $(e,p){1&e&&t.GkF(0)}const Q=[{path:"",component:(()=>{class e{constructor(o,a,n,s,H,X,w){this.route=o,this.router=a,this.gridDataSourceService=n,this.templateStore=s,this.notificationTemplateStore=H,this.tenantChooser=X,this.appRestService=w,this.columns=C,this.cRUDEndpoints=v,this.dataFieldLookupSourceMapping=T,this.relatedDataValueAndQueryStringKeyMapping=f,this.editingPropertiesForCreating=F,this.editingPropertiesForUpdating=b,this.tenantChooser.tenantId$.subscribe(tt=>{this.grid?.instance?.refresh()})}ngOnInit(){this.route.paramMap.subscribe(o=>{console.log(o),this.cronExpression=encodeURIComponent(o.get("cronExpression"));const a=decodeURIComponent(this.cronExpression);console.log(this.cronExpression),console.log(decodeURIComponent(this.cronExpression)),this.appRestService.request({method:"GET",url:`/api/app/jbnotifier-admin/cron-expressions/description/${this.cronExpression}`}).subscribe(n=>{this.titleCronExpression=`${n.description} | ${a}`})}),this.gridDataSource=this.gridDataSourceService.getDataSource({index:`/api/app/jbnotifier-admin/cron-expressions/${this.cronExpression}/notifications`,create:"/api/app/jbnotifier-admin/cron-expressions/notifications",delete:"/api/app/jbnotifier-admin/cron-expressions/notifications"},f)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(S.I),t.Y36(I.z),t.Y36(E.P),t.Y36(N.L),t.Y36(P.$))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-cron-expressions-job-list"]],viewQuery:function(a,n){if(1&a&&t.Gf(B,5),2&a){let s;t.iGM(s=t.CRH())&&(n.grid=s.first)}},decls:18,vars:17,consts:[[1,"custom-grid-container"],[1,"cron-expressions-title"],[1,"grid-tool-bar"],[3,"grid"],[1,"d-flex","justify-content-between"],["appGridAddButton","",3,"onClick"],["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync"],["grid",""],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"dxTemplate","dxTemplateOf"]],template:function(a,n){if(1&a&&(t.TgZ(0,"div",0),t._UZ(1,"app-tenant-chooser"),t.TgZ(2,"div",1)(3,"span"),t._uU(4,"\u901a\u77e5\u6e05\u55ae"),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"div",2)(7,"div"),t._UZ(8,"app-grid-filter-items",3),t.qZA(),t.TgZ(9,"div",4)(10,"div")(11,"dx-button",5),t.NdJ("onClick",function(){return n.router.navigate(["./cron-expressions/"+n.cronExpression+"/create-notification-info"])}),t.qZA()(),t._UZ(12,"app-grid-after-tool-bar",3),t.qZA()(),t.TgZ(13,"dx-data-grid",6,7),t.YNc(15,K,2,1,"ng-container",8),t.ALo(16,"keyvalue"),t.qZA(),t.YNc(17,$,1,0,"ng-container",9),t.qZA()),2&a){const s=t.MAs(14);t.xp6(5),t.hij(" ",n.titleCronExpression,""),t.xp6(3),t.Q6J("grid",s),t.xp6(4),t.Q6J("grid",s),t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForCreating",n.editingPropertiesForCreating)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("isEditingDataAsync",!0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(16,13,n.templateStore.gridTemplates)),t.xp6(2),t.Q6J("ngTemplateOutlet",n.notificationTemplateStore.getTemplates("notificationPager"))("ngTemplateOutletContext",t.VKq(15,y,s))}},dependencies:[d.sg,d.tP,D.K,A.p6,O.e,G.S,j._,M.f,U.V,R.D,u.W,d.Nd],styles:[".jb-toolbar-density[_ngcontent-%COMP%]{display:flex;align-items:center}.jb-toolbar-filter[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.jb-toolbar-filter-row[_ngcontent-%COMP%]{background-color:var(--blue-2);min-height:48px;padding:12px 16px;border-radius:12px;display:flex;gap:16px}.jb-toolbar-filter-item[_ngcontent-%COMP%]{padding:4px 8px;border-radius:16px;background-color:var(--white-1);color:var(--gray-1);display:flex;gap:2px}.jb-toolbar-filter-item--remove-all[_ngcontent-%COMP%]{background-color:var(--blue-1);color:var(--white-1);cursor:default}.cron-expressions-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;letter-spacing:var(--letter-2);color:var(--blue-4);margin-bottom:8px}.cron-expressions-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--black-1)}"]})}return e})()},{path:"create-notification-info",loadChildren:()=>Promise.all([i.e(68592),i.e(78488)]).then(i.bind(i,78488)).then(e=>e.CreateNotificationInfoModule)}];let Z=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(Q),c.Bz]})}return e})();var k=i(5533),W=i(31610),V=i(41992),Y=i(82140);let z=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[d.ez,k.P,Z,W.m,V.e,Y.j,u.W]})}return e})()}}]);