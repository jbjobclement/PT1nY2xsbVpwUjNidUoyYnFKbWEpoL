"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[62566],{62566:(it,l,a)=>{a.r(l),a.d(l,{NotificationCategoriesModule:()=>et});var p=a(96814),N=a(31610),g=a(88762),m=a(23758),u=a(35461),f=a(85054);const S=[{type:"buttons",fixed:!0,buttons:[{name:"save",template:"grid-save-button"},{name:"edit",template:"grid-edit-button"},{name:"delete",template:"grid-delete-button"},{name:"cancel",template:"grid-cancel-button"}]},{dataField:"SpecifiedTenantId",caption:"\u6307\u5b9a\u79df\u6236",dataType:"string",visible:!1},{dataField:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string"},{dataField:"id",visible:!1},{dataField:"idCode",caption:"idCode",dataType:"string",filterOperations:u.I$.text,validationRules:[f.L]},{dataField:"name",caption:"\u901a\u77e5\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:u.I$.text,validationRules:[f.L]},{dataField:"sortingNumber",caption:"\u6392\u5e8f",dataType:"number",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"parentNotificationCategoryId",caption:"",dataType:"string",visible:!1}],C={index:"/api/app/notification-categories",get:"/api/app/notification-categories",create:"/api/app/notification-categories",update:"/api/app/notification-categories",delete:"/api/app/notification-categories"},x=[{dataField:"SpecifiedTenantId",path:"/api/app/jbnotifier-admin/customized-users/tenant-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/customized-tenants"}],h=[{dataField:"id",mapping:["id"]},{dataField:"concurrencyStamp",mapping:["concurrencyStamp"]},{dataField:"tenantId",queryStringKey:"TenantId",mapping:["tenantId"]},{name:"tenantCode",queryStringKey:"TenantId",mapping:["tenant"]},{name:"tenantName",queryStringKey:"TenantId",mapping:["tenant","name"]},{dataField:"parentNotificationCategoryId",queryStringKey:"ParentNotificationCategoryId",mapping:["parentNotificationCategoryId"]},{name:"parentNotificationCategoryCode",queryStringKey:"ParentNotificationCategoryId",mapping:["parentNotificationCategory"]},{name:"parentNotificationCategoryName",queryStringKey:"ParentNotificationCategoryId",mapping:["parentNotificationCategory"]},{dataField:"name",queryStringKey:"Name",mapping:["notificationCategory","name"]},{dataField:"idCode",queryStringKey:"IdCode",mapping:["notificationCategory","idCode"]}],T={popup:{title:"JbNotifier::Permission:NotificationCategories",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:500},form:{colCount:1,items:[{dataField:"idCode",editorType:"dxTextBox"},{dataField:"name",editorType:"dxTextBox"},{dataField:"sortingNumber",editorType:"dxNumberBox",editorOptions:{min:1}}],elementAttr:{class:"custom-form custom-form--edit"}}},F={popup:{title:"JbNotifier::Permission:NotificationCategories",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:500},form:{colCount:1,items:[{dataField:"name",editorType:"dxTextBox"},{dataField:"sortingNumber",editorType:"dxNumberBox",editorOptions:{min:1}}],elementAttr:{class:"custom-form custom-form--edit"}}},b=[];var t=a(19212),D=a(67),M=a(72783),R=a(59444),P=a(21194),O=a(67846),V=a(13443),A=a(65343),K=a(5476),_=a(92931),J=a(25659),Q=a(16358),v=a(95051),Z=a(20843),B=a(25012),G=a(17105),y=a(12305);const L=["grid"],U=["treeview"];function E(i,c){1&i&&t.GkF(0)}const Y=i=>({$implicit:i});function $(i,c){if(1&i&&(t.ynx(0),t.YNc(1,E,1,0,"ng-container",14),t.BQk()),2&i){const e=c.$implicit,n=t.oxw().$implicit,o=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",o.templateStore.getGridTemplates(n.key))("ngTemplateOutletContext",t.VKq(2,Y,e))}}function k(i,c){if(1&i&&(t.ynx(0),t.YNc(1,$,2,4,"ng-container",12),t.BQk()),2&i){const e=c.$implicit;t.xp6(),t.Q6J("dxTemplateOf",e.key)}}function z(i,c){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",13),t.qZA()),2&i){t.oxw();const e=t.MAs(11);t.xp6(),t.Q6J("grid",e)}}const j=i=>({of:i}),H=()=>({class:"custom-tree-view"}),X=[{path:"",component:(()=>{class i{constructor(e,n,o,r,s){this.gridDataSourceService=e,this.templateStore=n,this.restService=o,this.configStateService=r,this.tenantChooser=s,this.columns=S,this.cRUDEndpoints=C,this.dataFieldLookupSourceMapping=x,this.dataFieldTranslationKeysMapping=b,this.relatedDataValueAndQueryStringKeyMapping=h,this.editingPropertiesForCreating=T,this.editingPropertiesForUpdating=F,this.treeViewLoading=!1,this.gridProperties={toolbar:{visible:!1},height:"85%"},this.treeViewDataSource=[],this.setGridDataSource=d=>{this.gridDataSource=this.gridDataSourceService.getDataSource(C,h),this.gridDataSource.filter(["parentNotificationCategoryId","=",d])}}ngOnInit(){this.tenantChooser.tenantId$.subscribe(e=>{this.setGridDataSource(),this.setTreeViewDataSource(e)})}onInitNewRow(e){e.data.parentNotificationCategoryId=this.parentNotificationCategoryId}onRowClick(e){if(e.event.target.classList.contains("dx-button-content"))return;const n=this.treeViewDataSource.find(o=>o.id===e.data.id);this.setGridDataSource(e.data.id),this.treeview.instance.expandItem(n),this.treeview.instance.selectItem(n),this.parentNotificationCategoryId=e.data.id}onRowInserted(e){this.treeViewDataSource.push({id:e.data.id,name:e.data.name,parentId:e.data.parentNotificationCategoryId||"notificationCategories"})}onRowRemoved(e){this.treeViewDataSource=this.treeViewDataSource.filter(n=>n.id!==e.data.id)}setTreeViewDataSource(e){this.treeViewLoading=!0,this.restService.request({method:"GET",url:"/api/app/notification-categories/treeview",params:{SpecifiedTenantId:e}}).subscribe(n=>{const o=n.items.map(r=>({id:r.id,name:r.name,parentId:r.parentId||"notificationCategories"}));this.treeViewDataSource=o,this.treeViewDataSource.unshift({id:"notificationCategories",name:"\u901a\u77e5\u5206\u985e",parentId:null,selected:!0,expanded:!0}),this.treeViewLoading=!1})}onTreeViewItemClick(e){this.setGridDataSource("notificationCategories"===e.itemData.id?null:e.itemData.id),this.treeview.instance.expandItem(e.itemData),this.treeview.instance.selectItem(e.itemData),this.parentNotificationCategoryId=e.itemData.id}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(D.I),t.Y36(M.z),t.Y36(g.vgb),t.Y36(g.XJE),t.Y36(R.L))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-notification-categories"]],viewQuery:function(n,o){if(1&n&&(t.Gf(L,5),t.Gf(U,5)),2&n){let r;t.iGM(r=t.CRH())&&(o.grid=r.first),t.iGM(r=t.CRH())&&(o.treeview=r.first)}},decls:16,vars:28,consts:[[1,"notification-categories"],[1,"notification-categories-tree-view"],["treeViewContainer",""],["shadingColor","rgba(0,0,0,0.3)",3,"container","position","visible","showIndicator","showPane","shading","hideOnOutsideClick"],["appGridAddButton","",3,"onClick"],["appTreeView","","selectionMode","single","dataStructure","plain","keyExpr","id","displayExpr","name","parentIdExpr","parentId","scrollDirection","both",3,"dataSource","elementAttr","onItemClick"],["treeview",""],[1,"notification-categories-data-grid"],[3,"grid","hideCreateBtn"],["appGridFeature","","appGridFeatureNotification","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","gridProperties","isEditingDataAsync","onInitNewRow","onRowClick","onRowInserted","onRowRemoved"],["grid",""],[4,"ngFor","ngForOf"],[4,"dxTemplate","dxTemplateOf"],[3,"grid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,o){if(1&n){const r=t.EpF();t._UZ(0,"app-tenant-chooser"),t.TgZ(1,"div",0)(2,"div",1,2),t._UZ(4,"dx-load-panel",3),t.TgZ(5,"dx-button",4),t.NdJ("onClick",function(){t.CHM(r);const d=t.MAs(11);return t.KtG(d.instance.addRow())}),t.qZA(),t.TgZ(6,"dx-tree-view",5,6),t.NdJ("onItemClick",function(d){return o.onTreeViewItemClick(d)}),t.qZA()(),t.TgZ(8,"div",7),t._UZ(9,"app-grid-tool-bar",8),t.TgZ(10,"dx-data-grid",9,10),t.NdJ("onInitNewRow",function(d){return o.onInitNewRow(d)})("onRowClick",function(d){return o.onRowClick(d)})("onRowInserted",function(d){return o.onRowInserted(d)})("onRowRemoved",function(d){return o.onRowRemoved(d)}),t.YNc(12,k,2,1,"ng-container",11),t.ALo(13,"keyvalue"),t.YNc(14,z,2,1,"div",12),t.qZA(),t._UZ(15,"app-notification-pager",13),t.qZA()()}if(2&n){const r=t.MAs(3),s=t.MAs(11);t.xp6(4),t.Q6J("container",r)("position",t.VKq(25,j,r))("visible",o.treeViewLoading)("showIndicator",!0)("showPane",!0)("shading",!1)("hideOnOutsideClick",!1),t.xp6(2),t.Q6J("dataSource",o.treeViewDataSource)("elementAttr",t.DdM(27,H)),t.xp6(3),t.Q6J("grid",s)("hideCreateBtn",!0),t.xp6(),t.Q6J("dataFieldTranslationKeysMapping",o.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("editingPropertiesForCreating",o.editingPropertiesForCreating)("editingPropertiesForUpdating",o.editingPropertiesForUpdating)("columns",o.columns)("dataSource",o.gridDataSource)("gridProperties",o.gridProperties)("isEditingDataAsync",!0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(13,23,o.templateStore.gridTemplates)),t.xp6(2),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("grid",s)}},dependencies:[P.D,p.sg,p.tP,O.S,V._,A.f,K.m,_.R,J.l,Q.K,Z.p6,v.u,B.e,G.Z,y.D,p.Nd],styles:[".notification-categories[_ngcontent-%COMP%]{margin:-8px;height:100%;display:flex}.notification-categories-tree-view[_ngcontent-%COMP%]{width:25%;height:calc(100% - 30px);border-right:1px solid var(--gray-3)}.notification-categories-tree-view[_ngcontent-%COMP%]   dx-tree-view[_ngcontent-%COMP%]{margin-top:4px}.notification-categories-data-grid[_ngcontent-%COMP%]{width:75%;height:calc(100% - 30px);padding:0 8px;display:flex;flex-direction:column;justify-content:space-between}.notification-categories-data-grid[_ngcontent-%COMP%]     .dx-datagrid-header-panel{display:none}.notification-categories-data-grid[_ngcontent-%COMP%]     dx-data-grid{padding-top:0}.notification-categories-data-grid[_ngcontent-%COMP%]     app-notification-pager .pager{margin-top:0}"]})}return i})(),canActivate:[g.a1M,g.nG9]}];let W=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(X),m.Bz]})}return i})();var q=a(5533),tt=a(41992);let et=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[tt.e,p.ez,W,N.m,q.P,v.V,y.D]})}return i})()}}]);