{"version":3,"file":"59524.df9184403e1f8ed5.js","mappings":"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","names":["type","id","name","columns","fixed","alignment","buttons","template","visible","caption","dataType","filterOperations","filterOperationTypes","text","lookup","valueExpr","displayExpr","allowClearing","dataSource","store","CustomStore","key","load","loadOptions","searchValue","filter","s","includes","byKey","extraOptions","data","find","Promise","res","calculateDisplayValue","rowData","typeShow","notificationProviders","map","provider","displayName","join","allowFiltering","allowSorting","formatTime","notificationSchedulePlans","pushTime","plan","cronDescription","dataField","fixedPosition","cRUDEndpoints","index","dataFieldLookupSourceMapping","path","pathForSelectedDisplay","relatedDataValueAndQueryStringKeyMapping","mapping","queryStringKey","editingPropertiesForUpdating","popup","title","showCloseButton","wrapperAttr","class","toolbarItems","toolbar","width","height","form","colCount","items","editorType","editorOptions","disabled","itemType","cssClass","colSpan","htmlProperties","elementAttr","NotificationsGroupingRecordsMasterDetailComponent","constructor","appRestService","this","notificationInfo","parseSuccessfulCount","parseFailedCount","parseCount","pushSuccessfulCount","pushFailedCount","pushCount","isFullyFinished","isCompletelySuccessful","ngOnChanges","getData","notificationInfoId","request","method","url","subscribe","static","t","i0","i1","core","Xpm","selectors","inputs","features","decls","vars","consts","rf","ctx","tmp_0_0","undefined","tmp_1_0","tmp_2_0","tmp_3_0","tmp_4_0","tmp_5_0","_c2","_c0","_c1","_c4","_c3","notificationSchedulePlan","notificationBackgroundJob","calculateCellValue","isManual","expectedParseTime","isParseFinished","isParseSuccessful","cellTemplate","cellInfo_r6","_r8","$implicit","ctx_r7","showTextContent","logMessages","cellInfo_r9","column","NotificationsGroupingRecordDetailsComponent_div_2_div_5_Template","NotificationsGroupingRecordDetailsComponent_div_2_div_6_Template","ctx_r0","gridDataSource","gridProperties","_r3","_r12","ctx_r11","closePopup","NotificationsGroupingRecordDetailsComponent","gridDataSourceService","configStateService","isDetailsVisibleChange","EventEmitter","isTextContentVisible","editing","allowDeleting","allowUpdating","filterRow","pager","sorting","mode","getOne$","tenantId","getDataSource","isDetailsVisible","override","getFlattenedFilter","sortingString","getSortingString","lastValueFrom","params","Sorting","SpecifiedTenantId","MaxResultCount","take","SkipCount","skip","pipe","totalCount","emit","grid","instance","pageIndex","i2","i3","viewQuery","$event","NotificationsGroupingRecordDetailsComponent_div_2_Template","NotificationsGroupingRecordDetailsComponent_div_3_Template","_c5","_r0","cancelEditData","NotificationGroupingRecordsComponent_ng_container_6_ng_container_1_ng_container_1_Template","ctx_r10","templateStore","getGridTemplates","template_r9","cellInfo_r11","NotificationGroupingRecordsComponent_ng_container_6_ng_container_1_Template","ctx_r3","masterDetailRowCollapseKey","cellInfo_r15","_r17","ctx_r16","openDetailsTable","_r22","cellInfo_r18","ctx_r20","repush","NotificationGroupingRecordsComponent_ng_container_10_app_repush_button_1_Template","isRepushable","routes","component","NotificationGroupingRecordsComponent","tenantChooser","allowAdding","masterDetail","enabled","rowExpanded","e","applyyNotificationMasterDetailRowCollapse","tenantId$","tenandId","refresh","ngOnInit","ngAfterViewInit","on","setTimeout","trElementRowIndex","element","querySelector","parentElement","ariaRowIndex","classList","add","collapseRow","i4","NotificationGroupingRecordsComponent_div_5_Template","NotificationGroupingRecordsComponent_ng_container_6_Template","NotificationGroupingRecordsComponent_app_notifications_grouping_records_master_detail_8_Template","NotificationGroupingRecordsComponent_dx_button_9_Template","NotificationGroupingRecordsComponent_ng_container_10_Template","gridTemplates","NotificationGroupingRecordsRoutingModule","oAB","cJS","RouterModule","forChild","NotificationGroupingRecordsModule","CommonModule","SharedModule","DXComponentsModule","NotificationPagerComponent","TextContentViewerComponent","TenantChooserModule"],"sourceRoot":"webpack:///","sources":["./src/app/notification-grouping-records/config/notifications-grouping-records/columns.ts","./src/app/notification-grouping-records/config/notifications-grouping-records/crud-endpoints.ts","./src/app/notification-grouping-records/config/notifications-grouping-records/datafield-lookup-source-mapping.ts","./src/app/notification-grouping-records/config/notifications-grouping-records/datafield-value-query-string-key-mapping.ts","./src/app/notification-grouping-records/config/notifications-grouping-records/form-properties.ts","./src/app/notification-grouping-records/components/notifications-grouping-records-master-detail/notifications-grouping-records-master-detail.component.ts","./src/app/notification-grouping-records/components/notifications-grouping-records-master-detail/notifications-grouping-records-master-detail.component.html","./src/app/notification-grouping-records/config/notifications-grouping-record-details/columns.ts","./src/app/notification-grouping-records/config/notifications-grouping-record-details/datafield-lookup-source-mapping.ts","./src/app/notification-grouping-records/config/notifications-grouping-record-details/datafield-value-query-string-key-mapping.ts","./src/app/notification-grouping-records/config/notifications-grouping-record-details/crud-endpoints.ts","./src/app/notification-grouping-records/components/notifications-grouping-record-details/notifications-grouping-record-details.component.html","./src/app/notification-grouping-records/components/notifications-grouping-record-details/notifications-grouping-record-details.component.ts","./src/app/notification-grouping-records/components/notification-grouping-records.component.html","./src/app/notification-grouping-records/notification-grouping-records-routing.module.ts","./src/app/notification-grouping-records/components/notification-grouping-records.component.ts","./src/app/notification-grouping-records/notification-grouping-records.module.ts"],"sourcesContent":["import CustomStore from 'devextreme/data/custom_store';\r\nimport { Column } from 'devextreme/ui/data_grid';\r\nimport { filterOperationTypes } from 'src/app/shared/grid/filterOperations';\r\nimport { formatTime } from 'src/app/shared/utils/time-format/utils';\r\n\r\nconst type = [\r\n  { id: 0, name: '即時' },\r\n  { id: 1, name: '預約' },\r\n  { id: 2, name: '重複' }\r\n]\r\n\r\nexport const columns: Column[] = [\r\n  {\r\n    type: 'buttons',\r\n    fixed: true,\r\n    alignment: 'left',\r\n    buttons: [\r\n      {\r\n        name: 'detail',\r\n        template: 'grid-table-list-button'\r\n      },\r\n      {\r\n        name: 'repush',\r\n        template: 'repush'\r\n      }\r\n    ],\r\n  },\r\n  {\r\n    name: 'id',\r\n    visible: false,\r\n  },\r\n  {\r\n    name: 'concurrencyStamp',\r\n    visible: false,\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    caption: '租戶名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text\r\n  },\r\n  {\r\n    name: 'type',\r\n    caption: '型態',\r\n    dataType: 'string',\r\n    lookup: {\r\n      valueExpr: 'id',\r\n      displayExpr: 'name',\r\n      allowClearing: true,\r\n      dataSource: {\r\n        store: new CustomStore({\r\n          key: 'id',\r\n          load: (loadOptions) => {\r\n            if (loadOptions.searchValue) {\r\n              const data = type.filter(s => s.name.includes(loadOptions.searchValue))\r\n              return data;\r\n            }\r\n            return type;\r\n          },\r\n          byKey(key, extraOptions) {\r\n            const data = type.find(s => s.id === key)\r\n            return new Promise(res => { res(data) })\r\n          },\r\n        })\r\n      }\r\n    },\r\n    calculateDisplayValue(rowData) {\r\n      return rowData.typeShow\r\n    },\r\n  },\r\n  {\r\n    name: 'notificationInfoName',\r\n    caption: '名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text\r\n  },\r\n  {\r\n    name: 'notificationProviders',\r\n    caption: '提供者',\r\n    dataType: 'object',\r\n    calculateDisplayValue(rowData) {\r\n      return rowData.notificationProviders.map(provider => provider.displayName).join('、')\r\n    },\r\n    allowFiltering: false,\r\n    allowSorting: false\r\n  },\r\n  {\r\n    name: 'notificationSchedulePlans',\r\n    caption: '時間計畫',\r\n    dataType: 'object',\r\n    calculateDisplayValue(rowData) {\r\n      if (rowData.type === 0) {\r\n        return formatTime(rowData.notificationSchedulePlans[0].pushTime)\r\n      }\r\n\r\n      if (rowData.type === 1) {\r\n        return rowData.notificationSchedulePlans.map(plan => formatTime(plan.pushTime) + ` (${plan.name})`).join('、')\r\n      }\r\n\r\n      if (rowData.type === 2) {\r\n        return rowData.notificationSchedulePlans.map(plan => {\r\n          // 由cron工作管理直接新增的通知不會有時間計畫名稱\r\n          // 所以先只給cronDescription\r\n          if (!plan.name) {\r\n            return plan.cronDescription\r\n          }\r\n\r\n          return plan.cronDescription + ` (${plan.name})`\r\n        }).join('、')\r\n      }\r\n    },\r\n    allowFiltering: false,\r\n    allowSorting: false\r\n  },\r\n  {\r\n    name: 'receiverDescription',\r\n    caption: '接收者描述',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    allowFiltering: false,\r\n    allowSorting: false\r\n  },\r\n\r\n  // \r\n  {\r\n    dataField: 'title',\r\n    caption: '標題',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'subtitle',\r\n    caption: '子標題',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'notificationDataFetchEndpoint',\r\n    caption: '取得通知資料 Endpoint',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'hookEndpoint',\r\n    caption: 'Hook',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'textContent',\r\n    caption: '文字內容',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'htmlContent',\r\n    caption: 'HTML 內容',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n\r\n\r\n  // master detail\r\n  {\r\n    type: 'detailExpand',\r\n    fixed: true,\r\n    fixedPosition: 'right'\r\n  },\r\n];","import { CRUDEndpoints } from \"src/app/shared/typing\";\r\n\r\nexport const cRUDEndpoints: CRUDEndpoints = {\r\n  index: '/api/app/jbnotifier-admin/notification-grouping-records',\r\n  // get: '/api/app/grouping-notification-push-logs',\r\n  // create: '/api/app/grouping-notification-push-logs',\r\n  // update: '/api/app/grouping-notification-push-logs',\r\n  // delete: '/api/app/grouping-notification-push-logs',\r\n};\r\n","import { DataFieldLookUpSourceMapping } from \"src/app/shared/typing\";\r\n\r\nexport const dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = [\r\n  {\r\n    dataField: 'notificationCategoryId',\r\n    path: '/api/app/notification-infos/assignable-notification-categories',\r\n    pathForSelectedDisplay: '/api/app/notification-categories'\r\n  }\r\n];\r\n","import { RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\n\r\nexport const relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = [\r\n  {\r\n    name: 'id',\r\n    mapping: ['notificationInfo', 'id'],\r\n  },\r\n  {\r\n    name: 'concurrencyStamp',\r\n    mapping: ['notificationInfo', 'concurrencyStamp'],\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    queryStringKey: 'TenantName',\r\n    mapping: ['tenant', 'name'],\r\n  },\r\n  {\r\n    name: 'type',\r\n    queryStringKey: 'Type',\r\n    mapping: ['notificationInfo', 'type'],\r\n  },\r\n  {\r\n    name: 'typeShow',\r\n    queryStringKey: 'Type',\r\n    mapping: ['notificationInfo', 'typeShow'],\r\n  },\r\n  {\r\n    name: 'notificationInfoName',\r\n    queryStringKey: 'Name',\r\n    mapping: ['notificationInfo', 'name'],\r\n  },\r\n  {\r\n    name: 'notificationProviders',\r\n    mapping: ['notificationProviders'],\r\n  },\r\n  {\r\n    name: 'notificationSchedulePlans',\r\n    mapping: ['notificationSchedulePlans'],\r\n  },\r\n  {\r\n    name: 'receiverDescription',\r\n    mapping: ['receiverDescription'],\r\n  },\r\n\r\n  // 唯獨表單\r\n  {\r\n    dataField: 'title',\r\n    mapping: ['notificationInfo', 'title'],\r\n  },\r\n  {\r\n    dataField: 'subtitle',\r\n    mapping: ['notificationInfo', 'subtitle'],\r\n  },\r\n  {\r\n    dataField: 'notificationDataFetchEndpoint',\r\n    mapping: ['notificationInfo', 'notificationDataFetchEndpoint'],\r\n  },\r\n  {\r\n    dataField: 'hookEndpoint',\r\n    mapping: ['notificationInfo', 'hookEndpoint'],\r\n  },\r\n  {\r\n    dataField: 'textContent',\r\n    mapping: ['notificationInfo', 'textContent'],\r\n  },\r\n  {\r\n    dataField: 'htmlContent',\r\n    mapping: ['notificationInfo', 'htmlContent'],\r\n  },\r\n\r\n  // 詳情\r\n  {\r\n    name: 'parseSuccessfulCount',\r\n    mapping: ['notificationInfo', 'parseSuccessfulCount']\r\n  },\r\n  {\r\n    name: 'parseFailedCount',\r\n    mapping: ['notificationInfo', 'parseFailedCount']\r\n  },\r\n  {\r\n    name: 'parseCount',\r\n    mapping: ['notificationInfo', 'parseCount']\r\n  },\r\n  {\r\n    name: 'pushSuccessfulCount',\r\n    mapping: ['notificationInfo', 'pushSuccessfulCount']\r\n  },\r\n  {\r\n    name: 'pushFailedCount',\r\n    mapping: ['notificationInfo', 'pushFailedCount']\r\n  },\r\n  {\r\n    name: 'pushCount',\r\n    mapping: ['notificationInfo', 'pushCount']\r\n  },\r\n  {\r\n    name: 'isFullyFinished',\r\n    mapping: ['notificationInfo', 'isFullyFinished']\r\n  },\r\n  {\r\n    name: 'isCompletelySuccessful',\r\n    mapping: ['notificationInfo', 'isCompletelySuccessful']\r\n  },\r\n\r\n  // \r\n  {\r\n    name: 'isRepushable',\r\n    mapping: ['isRepushable']\r\n  }\r\n];\r\n","import { Editing } from 'devextreme/ui/data_grid';\r\nimport type { Properties } from 'devextreme/ui/form';\r\nimport { htmlProperties } from 'src/app/shared/htmlProperties';\r\n\r\nconst formItems: Properties['items'] = [\r\n    {\r\n        dataField: 'title',\r\n        editorType: 'dxTextBox',\r\n        editorOptions: {\r\n            disabled: true\r\n        }\r\n    },\r\n    {\r\n        dataField: 'subtitle',\r\n        editorType: 'dxTextBox',\r\n        editorOptions: {\r\n            disabled: true\r\n        }\r\n    },\r\n    {\r\n        dataField: 'notificationDataFetchEndpoint',\r\n        editorType: 'dxTextBox',\r\n        editorOptions: {\r\n            disabled: true\r\n        }\r\n    },\r\n    {\r\n        dataField: 'hookEndpoint',\r\n        editorType: 'dxTextBox',\r\n        editorOptions: {\r\n            disabled: true\r\n        }\r\n    },\r\n    {\r\n        itemType: 'group',\r\n        name: 'CustomContentGroup',\r\n        cssClass: 'CustomContentGroup',\r\n        colSpan: 2,\r\n        colCount: 8,\r\n        items: [\r\n            {\r\n                dataField: 'textContent',\r\n                editorType: 'dxTextArea',\r\n                editorOptions: {\r\n                    height: '240px',\r\n                    disabled: true\r\n                },\r\n                colSpan: 3\r\n            },\r\n            {\r\n                dataField: 'htmlContent',\r\n                editorType: 'dxHtmlEditor',\r\n                editorOptions: {\r\n                    ...htmlProperties,\r\n                    height: '240px',\r\n                    disabled: true\r\n                },\r\n                colSpan: 5\r\n            }\r\n        ]\r\n    }\r\n]\r\n\r\nexport const editingPropertiesForUpdating: Editing = {\r\n    popup: {\r\n        title: '::',\r\n        showCloseButton: true,\r\n        wrapperAttr: { class: 'basic-popup' },\r\n        toolbarItems: [{ toolbar: 'bottom', template: 'bottom-toolbar' }],\r\n        width: '85vw',\r\n        height: '90vh'\r\n    },\r\n    form: {\r\n        colCount: 2,\r\n        items: formItems,\r\n        elementAttr: { class: 'basic-form basic-form--readonly' }\r\n    }\r\n}","import { Component, Input } from '@angular/core';\r\nimport { AppRestService } from 'src/app/shared/service/rest.service';\r\n\r\n@Component({\r\n  selector: 'app-notifications-grouping-records-master-detail',\r\n  templateUrl: './notifications-grouping-records-master-detail.component.html',\r\n  styleUrls: ['./notifications-grouping-records-master-detail.component.scss']\r\n})\r\n\r\nexport class NotificationsGroupingRecordsMasterDetailComponent {\r\n  @Input() notificationInfoId: string\r\n\r\n  notificationInfo = {\r\n    parseSuccessfulCount: null,\r\n    parseFailedCount: null,\r\n    parseCount: null,\r\n    pushSuccessfulCount: null,\r\n    pushFailedCount: null,\r\n    pushCount: null,\r\n    isFullyFinished: null,\r\n    isCompletelySuccessful: null\r\n  }\r\n\r\n  constructor(private appRestService: AppRestService) { }\r\n\r\n  ngOnChanges() {\r\n    this.getData()\r\n  }\r\n\r\n  getData() {\r\n    if (!this.notificationInfoId) {\r\n      return\r\n    }\r\n\r\n    this.appRestService.request<void, any>({\r\n      method: 'GET',\r\n      url: `/api/app/jbnotifier-admin/notification-grouping-records/${this.notificationInfoId}`\r\n    }).subscribe(res => {\r\n      this.notificationInfo.parseSuccessfulCount = res.notificationInfo.parseSuccessfulCount\r\n      this.notificationInfo.parseFailedCount = res.notificationInfo.parseFailedCount\r\n      this.notificationInfo.parseCount = res.notificationInfo.parseCount\r\n      this.notificationInfo.pushSuccessfulCount = res.notificationInfo.pushSuccessfulCount\r\n      this.notificationInfo.pushFailedCount = res.notificationInfo.pushFailedCount\r\n      this.notificationInfo.pushCount = res.notificationInfo.pushCount\r\n      this.notificationInfo.isFullyFinished = res.notificationInfo.isFullyFinished\r\n      this.notificationInfo.isCompletelySuccessful = res.notificationInfo.isCompletelySuccessful\r\n    })\r\n  }\r\n}\r\n","<div class=\"master-detail\">\r\n    <div class=\"master-detail-container\">\r\n        <div class=\"master-detail-title\">\r\n            <h3>推送記錄</h3>\r\n        </div>\r\n        <div class=\"master-detail-group\">\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">解析成功次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.parseSuccessfulCount ?? 'null'}}</span>\r\n            </div>\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">解析失敗次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.parseFailedCount ?? 'null'}}</span>\r\n            </div>\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">解析總次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.parseCount ?? 'null'}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"master-detail-group\">\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">推送成功次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.pushSuccessfulCount ?? 'null'}}</span>\r\n            </div>\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">推送失敗次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.pushFailedCount ?? 'null'}}</span>\r\n            </div>\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label\">推送總次數</label>\r\n                <span class=\"master-detail-text\">{{notificationInfo.pushCount ?? 'null'}}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"master-detail-group\">\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label master-detail-label--horizontal\">全部結束</label>\r\n                <dx-radio-group\r\n                    appRadioGroup\r\n                    layout=\"horizontal\"\r\n                    [dataSource]=\"[{id:true, name:'是'}, {id:false, name:'否'}]\"\r\n                    [value]=\"notificationInfo.isFullyFinished\"\r\n                    [disabled]=\"true\"\r\n                >\r\n                </dx-radio-group>\r\n            </div>\r\n            <div class=\"master-detail-content\">\r\n                <label class=\"master-detail-label master-detail-label--horizontal\">完全成功</label>\r\n                <dx-radio-group\r\n                    appRadioGroup\r\n                    layout=\"horizontal\"\r\n                    [dataSource]=\"[{id: true, name:'是'}, {id: false, name:'否'}, {id: null, name:'未完成'}]\"\r\n                    [value]=\"notificationInfo.isCompletelySuccessful\"\r\n                    [disabled]=\"true\"\r\n                >\r\n                </dx-radio-group>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>","import { Column } from 'devextreme/ui/data_grid';\r\nimport { formatTime } from 'src/app/shared/utils/time-format/utils';\r\n\r\nexport const columns: Column[] = [\r\n  {\r\n    name: 'notificationSchedulePlan',\r\n    caption: '時間計畫',\r\n    dataType: 'object',\r\n    calculateDisplayValue(rowData) {\r\n      // 重新發送的通知不會有notificationSchedulePlan\r\n      // 所以使用 \"重新發送\" 代替\r\n      if (!rowData.notificationSchedulePlan) {\r\n        return formatTime(rowData.notificationBackgroundJob.pushTime) + ' (重新發送)'\r\n      }\r\n\r\n      // 判斷是否為預約通知\r\n      // 如果為預約通知但還沒有pushTime，則只回傳name\r\n      // 否則回傳 pushTime + name\r\n      if (!rowData.notificationSchedulePlan.cronDescription) {\r\n        const time = rowData.notificationBackgroundJob.pushTime ? formatTime(rowData.notificationBackgroundJob.pushTime) : ''\r\n\r\n        let name = rowData.notificationSchedulePlan.name ?\r\n          rowData.notificationBackgroundJob.pushTime ?\r\n            ` (${rowData.notificationSchedulePlan.name})`\r\n            : rowData.notificationSchedulePlan.name\r\n          : ''\r\n\r\n        return time + name\r\n      }\r\n\r\n      // 如果明細為repush的重複通知，則直接回傳cronDescription\r\n      if (!rowData.notificationSchedulePlan.name) {\r\n        return rowData.notificationSchedulePlan.cronDescription\r\n      }\r\n\r\n      return rowData.notificationSchedulePlan.cronDescription + ` (${rowData.notificationSchedulePlan.name})`\r\n    }\r\n  },\r\n  {\r\n    dataField: 'isManual',\r\n    caption: '手動',\r\n    dataType: 'boolean',\r\n    calculateCellValue(rowData) {\r\n      return rowData.notificationBackgroundJob.isManual\r\n    }\r\n  },\r\n  {\r\n    name: 'expectedParseTime',\r\n    caption: '預計解析時間',\r\n    dataType: 'datetime',\r\n    calculateDisplayValue(rowData) {\r\n      return formatTime(rowData.notificationBackgroundJob.expectedParseTime)\r\n    }\r\n  },\r\n  {\r\n    dataField: 'isParseFinished',\r\n    caption: '解析結束',\r\n    dataType: 'boolean',\r\n    calculateCellValue(rowData) {\r\n      return rowData.notificationBackgroundJob.isParseFinished\r\n    }\r\n  },\r\n  {\r\n    dataField: 'isParseSuccessful',\r\n    caption: '解析成功',\r\n    dataType: 'boolean',\r\n    calculateCellValue(rowData) {\r\n      return rowData.notificationBackgroundJob.isParseSuccessful\r\n    }\r\n  },\r\n  {\r\n    name: 'pushTime',\r\n    caption: '推送時間',\r\n    dataType: 'datetime',\r\n    calculateDisplayValue(rowData) {\r\n      return formatTime(rowData.notificationBackgroundJob.pushTime)\r\n    }\r\n  },\r\n  {\r\n    dataField: 'isFullyFinished',\r\n    caption: '全部結束',\r\n    dataType: 'boolean',\r\n    calculateCellValue(rowData) {\r\n      return rowData.notificationBackgroundJob.isFullyFinished\r\n    }\r\n  },\r\n  {\r\n    dataField: 'isCompoletelySuccessful',\r\n    caption: '完全成功',\r\n    dataType: 'boolean',\r\n    calculateCellValue(rowData) {\r\n      return rowData.notificationBackgroundJob.isCompletelySuccessful\r\n    }\r\n  },\r\n  {\r\n    name: 'logMessages',\r\n    caption: 'Log 訊息',\r\n    dataType: 'string',\r\n    cellTemplate: 'logMessages',\r\n    fixed: true,\r\n    fixedPosition: 'right',\r\n    alignment: 'center',\r\n    width: 80\r\n  }\r\n];","import { DataFieldLookUpSourceMapping } from \"src/app/shared/typing\";\r\n\r\nexport const dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = [\r\n];\r\n","import { RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\n\r\nexport const relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = [\r\n  {\r\n    name: 'notificationSchedulePlan',\r\n    mapping: ['notificationSchedulePlan'],\r\n  },\r\n  {\r\n    name: 'notificationBackgroundJob',\r\n    mapping: ['notificationBackgroundJob'],\r\n  }\r\n];\r\n","import { CRUDEndpoints } from \"src/app/shared/typing\";\r\n\r\nexport const cRUDEndpoints: CRUDEndpoints = {\r\n  index: '/api/app/jbnotifier-admin/notification-grouping-records',\r\n  // get: '/api/app/grouping-notification-push-logs',\r\n  // create: '/api/app/grouping-notification-push-logs',\r\n  // update: '/api/app/grouping-notification-push-logs',\r\n  // delete: '/api/app/grouping-notification-push-logs',\r\n};\r\n","<dx-popup\r\n    [(visible)]=\"isDetailsVisible\"\r\n    [toolbarItems]=\"[{ toolbar: 'bottom', template: 'bottom-toolbar'}]\"\r\n    [wrapperAttr]=\"{class: 'basic-popup'}\"\r\n    [title]=\"'JbNotifier::NotificationRecordDetail' | abpLocalization\"\r\n    width=\"85vw\"\r\n    height=\"90vh\"\r\n>\r\n    <div *dxTemplate=\"let data of 'content'\">\r\n        <dx-data-grid\r\n            #grid\r\n            appGridFeature\r\n            [datafieldValueQueryStringKeyMapping]=\"relatedDataValueAndQueryStringKeyMapping\"\r\n            [dataFieldLookUpSourceMapping]=\"dataFieldLookupSourceMapping\"\r\n            [columns]=\"columns\"\r\n            [dataSource]=\"gridDataSource\"\r\n            [gridProperties]=\"gridProperties\"\r\n        >\r\n            <dxo-toolbar>\r\n                <dxi-item name=\"applyFilterButton\" cssClass=\"d-none\"></dxi-item>\r\n            </dxo-toolbar>\r\n\r\n            <div *dxTemplate=\"let cellInfo of 'logMessages'\" class=\"d-flex justify-content-center\">\r\n                <dx-button\r\n                    appCustomButton\r\n                    icon=\"assets/icons/buttons/eye.svg\"\r\n                    [elementAttr]=\"{class: 'custom-button-icon'}\"\r\n                    (onClick)=\"showTextContent(cellInfo.data.notificationBackgroundJob.logMessages)\"\r\n                >\r\n                </dx-button>\r\n            </div>\r\n\r\n            <div *dxTemplate=\"let cellInfo of 'JBHeaderCellTemplate'\">\r\n                {{cellInfo.column.caption}}\r\n            </div>\r\n        </dx-data-grid>\r\n\r\n        <app-notification-pager [grid]=\"grid\"></app-notification-pager>\r\n    </div>\r\n\r\n    <div *dxTemplate=\"let data of 'bottom-toolbar'\">\r\n        <dx-button \r\n            appCustomButton\r\n            text=\"關閉\"\r\n            [elementAttr]=\"{class: 'custom-button'}\"  \r\n            (onClick)=\"closePopup()\"\r\n        >\r\n        </dx-button>\r\n    </div>\r\n</dx-popup>\r\n\r\n<app-text-content-viewer\r\n    [(isTextContentVisible)]=\"isTextContentVisible\"\r\n    [textContent]=\"logMessages\"\r\n    textTitle=\"Log 訊息\"\r\n>\r\n</app-text-content-viewer>","import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';\r\nimport { Column, Properties } from 'devextreme/ui/data_grid';\r\nimport { columns } from '../../config/notifications-grouping-record-details/columns';\r\nimport { dataFieldLookupSourceMapping } from '../../config/notifications-grouping-record-details/datafield-lookup-source-mapping';\r\nimport { relatedDataValueAndQueryStringKeyMapping } from '../../config/notifications-grouping-record-details/datafield-value-query-string-key-mapping';\r\nimport { CRUDEndpoints, DataFieldLookUpSourceMapping, RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\nimport DataSource from 'devextreme/data/data_source';\r\nimport { cRUDEndpoints } from '../../config/notifications-grouping-record-details/crud-endpoints';\r\nimport { GridDataSourceService } from 'src/app/shared/service/grid-data-source.service/grid-data-source.service';\r\nimport { lastValueFrom, map } from 'rxjs';\r\nimport { AppRestService } from 'src/app/shared/service/rest.service';\r\nimport { ConfigStateService, PagedResultDto } from '@abp/ng.core';\r\nimport { DxDataGridComponent } from 'devextreme-angular';\r\n\r\n@Component({\r\n  selector: 'app-notifications-grouping-record-details',\r\n  templateUrl: './notifications-grouping-record-details.component.html',\r\n  styleUrls: ['./notifications-grouping-record-details.component.scss']\r\n})\r\nexport class NotificationsGroupingRecordDetailsComponent {\r\n  @ViewChild('grid', { static: false }) grid: DxDataGridComponent\r\n  @Input() notificationInfoId: string\r\n  @Input() isDetailsVisible: boolean\r\n  @Output() isDetailsVisibleChange = new EventEmitter<boolean>()\r\n\r\n  columns: Column[] = columns;\r\n  dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = dataFieldLookupSourceMapping;\r\n  relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = relatedDataValueAndQueryStringKeyMapping;\r\n  cRUDEndpoints: CRUDEndpoints = cRUDEndpoints;\r\n  gridDataSource: DataSource;\r\n\r\n  tenantId: string\r\n  isTextContentVisible: boolean = false\r\n  logMessages: string\r\n\r\n  gridProperties: Properties = {\r\n    editing: {\r\n      allowDeleting: false,\r\n      allowUpdating: false\r\n    },\r\n    filterRow: {\r\n      visible: false\r\n    },\r\n    toolbar: {\r\n      visible: false\r\n    },\r\n    pager: {\r\n      visible: false\r\n    },\r\n    height: '85%',\r\n    elementAttr: { class: 'schedule-plan-data-grid schedule-plan-data-grid--grouping-record w-auto' },\r\n    sorting: {\r\n      mode: 'none'\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    private gridDataSourceService: GridDataSourceService,\r\n    private appRestService: AppRestService,\r\n    private configStateService: ConfigStateService\r\n  ) {\r\n    this.configStateService.getOne$('currentTenant').subscribe(res => {\r\n      this.tenantId = res.id;\r\n    })\r\n  }\r\n\r\n  ngOnChanges() {\r\n    this.getDataSource()\r\n  }\r\n\r\n  getDataSource() {\r\n    if (!this.isDetailsVisible || !this.notificationInfoId) {\r\n      return\r\n    }\r\n\r\n    this.gridDataSource = this.gridDataSourceService.getDataSource(\r\n      cRUDEndpoints,\r\n      relatedDataValueAndQueryStringKeyMapping,\r\n      {\r\n        override: {\r\n          load: (loadOptions) => {\r\n            loadOptions.filter = this.gridDataSourceService.getFlattenedFilter(loadOptions.filter);\r\n            const sortingString = this.gridDataSourceService.getSortingString(loadOptions);\r\n            return lastValueFrom(\r\n              this.appRestService.request<void, PagedResultDto<any>>({\r\n                url: `/api/app/jbnotifier-admin/notification-grouping-records/${this.notificationInfoId}/details`,\r\n                method: 'GET',\r\n                params: {\r\n                  Sorting: sortingString,\r\n                  SpecifiedTenantId: this.tenantId,\r\n                  MaxResultCount: loadOptions.take,\r\n                  SkipCount: loadOptions.skip,\r\n                }\r\n              })\r\n                .pipe(map(res => {\r\n                  return {\r\n                    data: res.items,\r\n                    totalCount: res.totalCount\r\n                  }\r\n                }))\r\n            )\r\n          },\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  closePopup() {\r\n    this.isDetailsVisibleChange.emit(false)\r\n    this.grid.instance.pageIndex(0)\r\n  }\r\n\r\n  showTextContent(logMessages: string) {\r\n    this.isTextContentVisible = true\r\n    this.logMessages = logMessages\r\n  }\r\n}\r\n","<div class=\"custom-grid-container\">\r\n  <app-tenant-chooser></app-tenant-chooser>\r\n\r\n  <app-grid-tool-bar [grid]=\"grid\" [hideCreateBtn]=\"true\"></app-grid-tool-bar>\r\n \r\n  <dx-data-grid\r\n    #grid\r\n    appGridFeature\r\n    appGridFeatureNotification\r\n    [datafieldValueQueryStringKeyMapping]=\"relatedDataValueAndQueryStringKeyMapping\"\r\n    [dataFieldLookUpSourceMapping]=\"dataFieldLookupSourceMapping\"\r\n    [editingPropertiesForUpdating]=\"editingPropertiesForUpdating\"\r\n    [columns]=\"columns\"\r\n    [dataSource]=\"gridDataSource\"\r\n    [gridProperties]=\"gridProperties\"\r\n  >\r\n    <!-- <dxo-toolbar>\r\n      <dxi-item location=\"after\">\r\n        <app-grid-after-tool-bar\r\n          *dxTemplate\r\n          [grid]=\"grid\"\r\n        >\r\n        </app-grid-after-tool-bar>\r\n      </dxi-item>\r\n      <dxi-item name=\"applyFilterButton\" cssClass=\"d-none\"></dxi-item>\r\n    </dxo-toolbar> -->\r\n\r\n    <div *dxTemplate=\"let cellInfo of 'bottom-toolbar'\">\r\n      <dx-button\r\n        appCustomButton\r\n        text=\"確認\"\r\n        [elementAttr]=\"{class: 'custom-button custom-button--blue'}\"\r\n        (onClick)=\"grid.instance.cancelEditData()\"\r\n      >\r\n      </dx-button>\r\n    </div>\r\n    \r\n    <ng-container *ngFor=\"let template of templateStore.gridTemplates | keyvalue\">\r\n      <ng-container *dxTemplate=\"let cellInfo of template.key\">\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            templateStore.getGridTemplates(template.key);\r\n            context: { $implicit: cellInfo }\r\n          \"\r\n        >\r\n        </ng-container>\r\n      </ng-container>\r\n    </ng-container>\r\n\r\n    <app-notifications-grouping-records-master-detail\r\n      *dxTemplate=\"let cellInfo of 'notifications-grouping-records-master-detail'\"\r\n      [notificationInfoId]=\"masterDetailRowCollapseKey?.id\"\r\n    >\r\n    </app-notifications-grouping-records-master-detail>\r\n\r\n    <dx-button\r\n      *dxTemplate=\"let cellInfo of 'grid-table-list-button'\"\r\n      appCustomButton\r\n      icon=\"assets/icons/buttons/table-list.svg\"\r\n      [elementAttr]=\"{class: 'custom-button-icon'}\"\r\n      (click)=\"openDetailsTable(cellInfo.data.id)\"\r\n    >\r\n    </dx-button>\r\n\r\n    <ng-container *dxTemplate=\"let cellInfo of 'repush'\">\r\n          <app-repush-button\r\n            *ngIf=\"cellInfo.data.isRepushable\"\r\n            (buttonClick)=\"repush(cellInfo.data.id)\"\r\n          >\r\n          </app-repush-button>\r\n    </ng-container>\r\n  </dx-data-grid>\r\n\r\n  <app-notification-pager [grid]=\"grid\"></app-notification-pager>\r\n</div>\r\n\r\n<app-notifications-grouping-record-details\r\n  [(isDetailsVisible)]=\"isDetailsVisible\"\r\n  [notificationInfoId]=\"notificationInfoId\"\r\n>\r\n</app-notifications-grouping-record-details>","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NotificationGroupingRecordsComponent } from './components/notification-grouping-records.component';\r\n\r\nconst routes: Routes = [{ path: '', component: NotificationGroupingRecordsComponent }];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\n\r\nexport class NotificationGroupingRecordsRoutingModule { }","import { Component, ViewChild } from '@angular/core';\r\nimport { Column, Editing, Properties, RowExpandedEvent } from 'devextreme/ui/data_grid';\r\nimport { columns } from '../config/notifications-grouping-records/columns';\r\nimport { cRUDEndpoints } from '../config/notifications-grouping-records/crud-endpoints';\r\nimport { dataFieldLookupSourceMapping } from '../config/notifications-grouping-records/datafield-lookup-source-mapping';\r\nimport { relatedDataValueAndQueryStringKeyMapping } from '../config/notifications-grouping-records/datafield-value-query-string-key-mapping';\r\nimport DataSource from 'devextreme/data/data_source';\r\nimport { CRUDEndpoints, DataFieldLookUpSourceMapping, RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\nimport { GridDataSourceService } from 'src/app/shared/service/grid-data-source.service/grid-data-source.service';\r\nimport { TemplateStoreService } from 'src/app/shared/service/template-store.service';\r\nimport { DxDataGridComponent } from 'devextreme-angular';\r\nimport { editingPropertiesForUpdating } from '../config/notifications-grouping-records/form-properties';\r\nimport { AppRestService } from 'src/app/shared/service/rest.service';\r\nimport { TenantChooserService } from 'src/app/shared/modules/tenant-chooser/tenant-chooser.service';\r\n\r\n@Component({\r\n  selector: 'app-notification-grouping-records',\r\n  templateUrl: './notification-grouping-records.component.html',\r\n  styleUrls: ['./notification-grouping-records.component.scss']\r\n})\r\nexport class NotificationGroupingRecordsComponent {\r\n  /**\r\n   * 取得datagrid元件，將之存於變數grid。\r\n   */\r\n  @ViewChild('grid', { static: false }) grid: DxDataGridComponent;\r\n\r\n  /**\r\n   * devextreme data grid columns\r\n   * \r\n   * 用來設定grid具有那些欄位。\r\n   * \r\n   * DevExtreme官方文件: [Column]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Columns/Overview/}\r\n   */\r\n  columns: Column[] = columns;\r\n\r\n  /**\r\n   * devextreme grid datasource\r\n   * \r\n   * grid dataSource, 用來連接grid與後端data的新增、讀取、修改、刪除。\r\n   * \r\n   * 透過[getDataSource]{@link GridDataSourceService#getDataSource}使用[cRUDEndpoints]{@link NotificationGroupingRecordsComponent#cRUDEndpoints}與[relatedDataValueAndQueryStringKeyMapping]{@link NotificationGroupingRecordsComponent#relatedDataValueAndQueryStringKeyMapping}產生。\r\n   * \r\n   * DevExtreme官方文件: [DataSource]{@link https://js.devexpress.com/Angular/Documentation/23_2/ApiReference/Data_Layer/DataSource/}\r\n   */\r\n  gridDataSource: DataSource;\r\n\r\n  /**\r\n   * 設定增、刪、查、改的路徑\r\n   * \r\n   * 用於[getDataSource]{@link GridDataSourceService#getDataSource}接收然後利用產生[gridDataSource]{@link NotificationGroupingRecordsComponent#gridDataSource}。\r\n   */\r\n  cRUDEndpoints: CRUDEndpoints = cRUDEndpoints;\r\n\r\n  /**\r\n   * 選單與資料路徑對應設定檔案\r\n   * \r\n   * {@link GridFeatureDirective}接收後用來設定[DataGrid]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Getting_Started_with_DataGrid/}的新增、編輯表單裡的選單。\r\n   */\r\n  dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = dataFieldLookupSourceMapping;\r\n\r\n  /**\r\n   * 欄位、值、與回應資料結構的對應設定檔案\r\n   * \r\n   * 用於[getDataSource]{@link GridDataSourceService#getDataSource}接收然後利用產生[gridDataSource]{@link NotificationGroupingRecordsComponent#gridDataSource}。\r\n   */\r\n  relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping =\r\n    relatedDataValueAndQueryStringKeyMapping;\r\n\r\n  /**\r\n   * 編輯的表單設定\r\n   * \r\n   * DevExtreme官方文件: [Editing]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Editing/}\r\n   */\r\n  editingPropertiesForUpdating: Editing = editingPropertiesForUpdating\r\n\r\n  /**\r\n   * 啟用master detail功能\r\n   * \r\n   * DevExtreme官方文件: [Properties]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/masterDetail/}\r\n   */\r\n  gridProperties: Properties = {\r\n    editing: { allowAdding: false },\r\n    masterDetail: {\r\n      enabled: true,\r\n      template: 'notifications-grouping-records-master-detail'\r\n    }\r\n  };\r\n\r\n  /**\r\n   * 使用master detail功能時，記錄目前展開的Row\r\n   */\r\n  masterDetailRowCollapseKey: string\r\n\r\n  /**\r\n   * 是否顯示明細\r\n   */\r\n  isDetailsVisible: boolean = false\r\n\r\n  /**\r\n   * 該筆通知任務的ID\r\n   */\r\n  notificationInfoId: string\r\n\r\n\r\n  /**\r\n   * 參考{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Editing|Editing},\r\n   * [editCellTemplate]{@link https://js.devexpress.com/Angular/Documentation/23_2/ApiReference/UI_Components/dxDataGrid/Configuration/columns/\\#editCellTemplate/},\r\n   * [template]{@link js.devexpress.com/Angular/Documentation/23_2/ApiReference/UI_Components/dxForm/Item_Types/SimpleItem/#template/}\r\n   * @param gridDataSourceService dxdatagrid所使用的產生datasource相關功能\r\n   * @param templateStore 共用的dx template儲存service，用於dx-data-grid、dx-form的custom template, 參考editCellTemplate, template\r\n   */\r\n  constructor(\r\n    private gridDataSourceService: GridDataSourceService,\r\n    private appRestService: AppRestService,\r\n    protected templateStore: TemplateStoreService,\r\n    private tenantChooser: TenantChooserService\r\n  ) {\r\n    this.tenantChooser.tenantId$.subscribe(tenandId => {\r\n      this.grid?.instance?.refresh()\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 元件啟動後，透過[getDataSource]{@link GridDataSourceService#getDataSource}使用設定檔設定grid的dataSource - [gridDataSource]{@link NotificationGroupingRecordsComponent#gridDataSource}。\r\n   */\r\n  ngOnInit(): void {\r\n    this.gridDataSource = this.gridDataSourceService.getDataSource(\r\n      cRUDEndpoints,\r\n      relatedDataValueAndQueryStringKeyMapping\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 畫面渲染後，使[grid]{@link NotificationGroupingRecordsComponent#grid}元件在[rowExpanded]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Events/#rowExpanded}事件時，觸發[rowExpanded]{@link NotificationGroupingRecordsComponent#rowExpanded}\r\n   */\r\n  ngAfterViewInit() {\r\n    this.grid.instance.on('rowExpanded', this.rowExpanded)\r\n  }\r\n\r\n  /**\r\n   * 觸發[applyyNotificationMasterDetailRowCollapse]{@link NotificationGroupingRecordsComponent#applyNotificationMasterDetailRowCollapse}\r\n   */\r\n  rowExpanded = (e: RowExpandedEvent) => {\r\n    this.applyyNotificationMasterDetailRowCollapse(e)\r\n  }\r\n\r\n  /**\r\n   * 展開master detail時，添加畫面項目需要的CSS\r\n   * \r\n   * 如果[masterDetailRowCollapseKey]{@link NotificationGroupingRecordsComponent#masterDetailRowCollapseKey}與按下展開按鈕的像是\r\n   *一樣的時候，則return\r\n   * \r\n   * 記錄展開當下的[masterDetailRowCollapseKey]{@link NotificationGroupingRecordsComponent#masterDetailRowCollapseKey}，並確保\r\n   *每次只會有一個項目被展開\r\n   * \r\n   * 使用setTimeout避免NG0100{@link https://angular.dev/errors/NG0100}Error\r\n   */\r\n  applyyNotificationMasterDetailRowCollapse(e: RowExpandedEvent) {\r\n    // use setTimeout to wait HTML DOM change before get element\r\n    setTimeout(() => {\r\n      const tdElementCollapse = e.element.querySelector('[aria-label=\"Collapse\"]')\r\n      const trElementRowIndex = tdElementCollapse.parentElement.ariaRowIndex\r\n      const trElementRow = e.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex=\"${trElementRowIndex}\"]`)\r\n      trElementRow.classList.add('master-detail-row-collapse')\r\n    })\r\n\r\n    if (e.key === this.masterDetailRowCollapseKey) {\r\n      return\r\n    }\r\n\r\n    e.component.collapseRow(this.masterDetailRowCollapseKey);\r\n    this.masterDetailRowCollapseKey = e.key\r\n  }\r\n\r\n  /**\r\n   * 觸發顯示明細彈窗\r\n   */\r\n  openDetailsTable(id: string) {\r\n    this.isDetailsVisible = true\r\n    this.notificationInfoId = id\r\n  }\r\n\r\n  /**\r\n   * 重新發送訊息，並重新整理data grid\r\n   */\r\n  repush(id: string) {\r\n    this.appRestService.request<void, void>({\r\n      method: 'POST',\r\n      url: `/api/app/jbnotifier-admin/notification-grouping-records/${id}/repush`\r\n    }).subscribe(() => {\r\n      this.grid.instance.refresh()\r\n    })\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NotificationGroupingRecordsRoutingModule } from './notification-grouping-records-routing.module';\r\nimport { DXComponentsModule } from '../shared/dx-components.module';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { NotificationGroupingRecordsComponent } from './components/notification-grouping-records.component';\r\nimport { NotificationPagerComponent } from \"../shared/components/notification/notification-pager/notification-pager.component\";\r\nimport { NotificationsGroupingRecordsMasterDetailComponent } from './components/notifications-grouping-records-master-detail/notifications-grouping-records-master-detail.component';\r\nimport { NotificationsGroupingRecordDetailsComponent } from './components/notifications-grouping-record-details/notifications-grouping-record-details.component';\r\nimport { TextContentViewerComponent } from \"../shared/components/text-content-viewer/text-content-viewer.component\";\r\nimport { TenantChooserModule } from \"../shared/modules/tenant-chooser/tenant-chooser.module\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    NotificationGroupingRecordsComponent,\r\n    NotificationsGroupingRecordsMasterDetailComponent,\r\n    NotificationsGroupingRecordDetailsComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    SharedModule,\r\n    DXComponentsModule,\r\n    NotificationGroupingRecordsRoutingModule,\r\n    NotificationPagerComponent,\r\n    TextContentViewerComponent,\r\n    TenantChooserModule\r\n  ]\r\n})\r\nexport class NotificationGroupingRecordsModule { }\r\n"],"x_google_ignoreList":[]}