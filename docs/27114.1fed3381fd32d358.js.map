{"version":3,"file":"27114.1fed3381fd32d358.js","mappings":"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","names":["columns","type","fixed","buttons","name","template","disabled","options","row","data","isEditable","isDeletable","dataField","visible","caption","dataType","filterOperations","filterOperationTypes","text","validationRules","requiredValidationRule","calculateDisplayValue","rowData","notificationProviders","map","provider","displayName","join","width","allowFiltering","allowSorting","fixedPosition","editCellTemplate","cRUDEndpoints","index","get","create","update","delete","dataFieldLookupSourceMapping","path","pathForSelectedDisplay","relatedDataValueAndQueryStringKeyMapping","mapping","queryStringKey","formItems","itemType","cssClass","colCount","items","colSpan","editorType","label","editorOptions","height","htmlProperties","editingPropertiesForCreating","popup","title","wrapperAttr","class","showCloseButton","toolbarItems","toolbar","form","elementAttr","editingPropertiesForUpdating","i0","cellInfo_r5","column","NotificationSchedulePlanDetailsComponent_div_1_div_3_Template","ctx_r0","gridDataSource","gridProperties","_r8","ctx_r7","closePopup","_c1","NotificationSchedulePlanDetailsComponent","constructor","this","isDetailsVisible","isDetailsVisibleChange","EventEmitter","editing","allowDeleting","allowUpdating","filterRow","pager","ngOnChanges","getDataSource","notificationSchedulePlans","length","plan","pushTime","formatTime","isActive","isFullyFinished","emit","static","t","core","Xpm","selectors","viewQuery","rf","ctx","$event","NotificationSchedulePlanDetailsComponent_div_1_Template","NotificationSchedulePlanDetailsComponent_div_2_Template","_c3","_c2","_c4","ctx_r1","errorMessage","_r0","ReserveNotificationInfosComponent_ng_container_13_ng_container_1_ng_container_1_Template","ctx_r10","templateStore","getGridTemplates","template_r9","key","cellInfo_r11","ReserveNotificationInfosComponent_ng_container_13_ng_container_1_Template","ReserveNotificationInfosComponent_ng_container_15_ng_container_1_Conditional_1_ng_container_0_Template","ctx_r17","notificationTemplateStore","getTemplates","template_r14","cellInfo_r16","notificationTemplateId","ReserveNotificationInfosComponent_ng_container_15_ng_container_1_Conditional_2_ng_container_0_Template","ctx_r18","ReserveNotificationInfosComponent_ng_container_15_ng_container_1_Conditional_1_Template","ReserveNotificationInfosComponent_ng_container_15_ng_container_1_Conditional_2_Template","ReserveNotificationInfosComponent_ng_container_15_ng_container_1_Template","cellInfo_r26","_r28","$implicit","ctx_r27","openDetailsTable","routes","component","ReserveNotificationInfosComponent","gridDataSourceService","router","tenantChooser","masterDetail","enabled","tenantId$","subscribe","tenandId","grid","instance","refresh","columnReceiverGroupIds","find","c","columnTopicIds","receiverIds","setCustomValidationRule","optionDataTargets","filter","target","message","reevaluate","validationCallback","option","isSendToAllReceivers","value","document","querySelector","classList","remove","add","ngOnInit","onRowExpanded","e","applyNotificationMasterDetailRowCollapse","setTimeout","trElementRowIndex","element","parentElement","ariaRowIndex","masterDetailRowCollapseKey","collapseRow","onSaving","changes","receiverGroupIds","topicIds","textContentNotificationTemplateId","htmlContentNotificationTemplateId","htmlContentNotificationTemplateArgs","textContentNotificationTemplateArgs","onOptionChanged","fullName","i1","i2","i3","i4","i5","navigate","ReserveNotificationInfosComponent_ng_container_11_Template","ReserveNotificationInfosComponent_div_12_Template","ReserveNotificationInfosComponent_ng_container_13_Template","ReserveNotificationInfosComponent_ng_container_15_Template","ReserveNotificationInfosComponent_dx_button_17_Template","ReserveNotificationInfosComponent_ng_container_18_Template","gridTemplates","templates","canActivate","AuthGuard","PermissionGuard","loadChildren","Promise","all","__webpack_require__","then","bind","m","CreateNotificationInfoModule","InstantNotificationInfosRoutingModule","oAB","cJS","RouterModule","forChild","ReserveNotificationInfosModule","CommonModule","DXComponentsModule","DxHtmlEditorModule","SharedModule","GridFilterItemsComponent","TenantChooserModule"],"sourceRoot":"webpack:///","sources":["./src/app/reserve-notification-infos/config/reserve-notification-infos/columns.ts","./src/app/reserve-notification-infos/config/reserve-notification-infos/crud-endpoints.ts","./src/app/reserve-notification-infos/config/reserve-notification-infos/datafield-lookup-source-mapping.ts","./src/app/reserve-notification-infos/config/reserve-notification-infos/datafield-value-query-string-key-mapping.ts","./src/app/reserve-notification-infos/config/reserve-notification-infos/form-properties.ts","./src/app/reserve-notification-infos/config/notification-schedule-plan-details/columns.ts","./src/app/reserve-notification-infos/config/notification-schedule-plan-details/datafield-lookup-source-mapping.ts","./src/app/reserve-notification-infos/config/notification-schedule-plan-details/datafield-value-query-string-key-mapping.ts","./src/app/reserve-notification-infos/components/notification-schedule-plan-details/notification-schedule-plan-details.component.html","./src/app/reserve-notification-infos/components/notification-schedule-plan-details/notification-schedule-plan-details.component.ts","./src/app/reserve-notification-infos/components/reserve-notification-infos.component.html","./src/app/reserve-notification-infos/reserve-notification-infos-routing.module.ts","./src/app/reserve-notification-infos/components/reserve-notification-infos.component.ts","./src/app/reserve-notification-infos/reserve-notification-infos.module.ts"],"sourcesContent":["import { ValidationCallbackData } from 'devextreme/common';\r\nimport { Column } from 'devextreme/ui/data_grid';\r\nimport { filterOperationTypes } from 'src/app/shared/grid/filterOperations';\r\nimport { requiredValidationRule } from 'src/app/shared/validationRules/required';\r\n\r\nexport const columns: Column[] = [\r\n  {\r\n    type: 'buttons',\r\n    fixed: true,\r\n    buttons: [\r\n      {\r\n        name: 'schedule-plans',\r\n        template: 'gridSchedulePlanDetailsButton'\r\n      },\r\n      {\r\n        name: 'edit',\r\n        template: 'grid-edit-button',\r\n        disabled(options) {\r\n          return !options.row?.data?.isEditable;\r\n        },\r\n      },\r\n      {\r\n        name: 'delete',\r\n        template: 'grid-delete-button',\r\n        disabled(options) {\r\n          return !options.row?.data?.isDeletable;\r\n        },\r\n      }\r\n    ],\r\n  },\r\n  {\r\n    dataField: 'id',\r\n    visible: false,\r\n  },\r\n  {\r\n    dataField: 'concurrencyStamp',\r\n    visible: false,\r\n  },\r\n\r\n  // grid item\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    caption: '指定租戶',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    caption: '租戶名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text\r\n  },\r\n  {\r\n    name: 'notificationCategoryName',\r\n    caption: '分類名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text\r\n  },\r\n  {\r\n    dataField: 'name',\r\n    caption: '通知名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    name: 'notificationProviders',\r\n    caption: '通知提供者',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    calculateDisplayValue(rowData) {\r\n      return rowData.notificationProviders?.map(provider => provider.displayName).join('、')\r\n    },\r\n    width: 160,\r\n    allowFiltering: false,\r\n    allowSorting: false\r\n  },\r\n  {\r\n    name: 'receiverDescription',\r\n    caption: '接收者描述',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    allowFiltering: false,\r\n    allowSorting: false\r\n  },\r\n\r\n  // master detail\r\n  {\r\n    type: 'detailExpand',\r\n    fixed: true,\r\n    fixedPosition: 'right'\r\n  },\r\n  {\r\n    dataField: 'notificationDataFetchEndpoint',\r\n    caption: '取得通知資料 Endpoint',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'hookEndpoint',\r\n    caption: 'Hook',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    visible: false\r\n  },\r\n  {\r\n    name: 'isFullyFinished',\r\n    caption: '是否已完成',\r\n    dataType: 'boolean',\r\n    visible: false\r\n  },\r\n  {\r\n    name: 'isDeletable',\r\n    caption: '是否可刪除',\r\n    dataType: 'boolean',\r\n    visible: false\r\n  },\r\n  {\r\n    name: 'isEditable',\r\n    caption: '是否可編輯',\r\n    dataType: 'boolean',\r\n    visible: false\r\n  },\r\n\r\n  // edit form\r\n  {\r\n    dataField: 'title',\r\n    caption: '標題',\r\n    dataType: 'string',\r\n    visible: false,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'notificationProviderIds',\r\n    caption: '通知提供者id (可複選)',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'notificationProviderIds',\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'isSendToAllReceivers',\r\n    caption: '接收者',\r\n    dataType: 'boolean',\r\n    visible: false,\r\n    editCellTemplate: 'isSendToAllReceivers'\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    caption: '接收者 (可複選)',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'receiverIds',\r\n    // validationRules: [\r\n    //   {\r\n    //     type: 'custom',\r\n    //     message: '接收者、接收者群組、主題必須選擇一項',\r\n    //     validationCallback: (option: ValidationCallbackData) => {\r\n    //       if (option.data.isSendToAllReceivers ||\r\n    //         option.value.length ||\r\n    //         option.data.receiverGroupIds.length ||\r\n    //         option.data.topicIds.length) {\r\n    //         return true\r\n    //       }\r\n\r\n    //       return false\r\n    //     }\r\n    //   },\r\n    // ],\r\n    // setCellValue(newData, value, currentRowData) {\r\n    //   if (value.length && !currentRowData.receiverGroupIds.length) {\r\n    //     newData.receiverGroupIds = [...currentRowData.receiverGroupIds]\r\n    //   }\r\n\r\n    //   if (value.length && !currentRowData.topicIds.length) {\r\n    //     newData.topicIds = [...currentRowData.topicIds]\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.receiverGroupIds.length) {\r\n    //     newData.receiverGroupIds = []\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.topicIds.length) {\r\n    //     newData.topicIds = []\r\n    //   }\r\n\r\n    //   newData.receiverIds = value\r\n    // }\r\n  },\r\n  {\r\n    dataField: 'receiverGroupIds',\r\n    caption: '接收群組 (可複選)',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'receiverGroupIds',\r\n    // validationRules: [\r\n    //   {\r\n    //     type: 'custom',\r\n    //     message: '接收者、接收者群組、主題必須選擇一項',\r\n    //     validationCallback: (option: ValidationCallbackData) => {\r\n    //       if (option.data.isSendToAllReceivers ||\r\n    //         option.value.length ||\r\n    //         option.data.receiverIds.length ||\r\n    //         option.data.topicIds.length) {\r\n    //         return true\r\n    //       }\r\n\r\n    //       return false\r\n    //     }\r\n    //   }\r\n    // ],\r\n    // setCellValue(newData, value, currentRowData) {\r\n    //   if (value.length && !currentRowData.receiverIds.length) {\r\n    //     newData.receiverIds = [...currentRowData.receiverIds]\r\n    //   }\r\n\r\n    //   if (value.length && !currentRowData.topicIds.length) {\r\n    //     newData.topicIds = [...currentRowData.topicIds]\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.receiverIds.length) {\r\n    //     newData.receiverIds = []\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.topicIds.length) {\r\n    //     newData.topicIds = []\r\n    //   }\r\n\r\n    //   newData.receiverGroupIds = value\r\n    // }\r\n  },\r\n  {\r\n    dataField: 'topicIds',\r\n    caption: '主題 (可複選)',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'topicIds',\r\n    // validationRules: [\r\n    //   {\r\n    //     type: 'custom',\r\n    //     message: '接收者、接收者群組、主題必須選擇一項',\r\n    //     validationCallback: (option: ValidationCallbackData) => {\r\n    //       if (option.data.isSendToAllReceivers ||\r\n    //         option.value.length ||\r\n    //         option.data.receiverIds.length ||\r\n    //         option.data.receiverGroupIds.length) {\r\n    //         return true\r\n    //       }\r\n\r\n    //       return false\r\n    //     }\r\n    //   }\r\n    // ],\r\n    // setCellValue(newData, value, currentRowData) {\r\n    //   if (value.length && !currentRowData.receiverIds.length) {\r\n    //     newData.receiverIds = [...currentRowData.receiverIds]\r\n    //   }\r\n\r\n    //   if (value.length && !currentRowData.receiverGroupIds.length) {\r\n    //     newData.receiverGroupIds = [...currentRowData.receiverGroupIds]\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.receiverIds.length) {\r\n    //     newData.receiverIds = []\r\n    //   }\r\n\r\n    //   if (!value.length && !currentRowData.receiverGroupIds.length) {\r\n    //     newData.receiverGroupIds = []\r\n    //   }\r\n\r\n    //   newData.topicIds = [...value]\r\n    // }\r\n  },\r\n  {\r\n    dataField: 'isIndependentNotificationSettingUsing',\r\n    caption: '通知設定',\r\n    dataType: 'boolean',\r\n    visible: false,\r\n    editCellTemplate: 'isIndependentNotificationSettingUsing'\r\n  },\r\n  {\r\n    dataField: 'notificationSettings',\r\n    caption: '通知設定項目',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'notificationSettings'\r\n  },\r\n  {\r\n    dataField: 'notificationSchedulePlans',\r\n    caption: '預約時間計畫',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'reserveNotificationSchedulePlans'\r\n  },\r\n  {\r\n    dataField: 'notificationCategoryId',\r\n    caption: '通知分類 Id',\r\n    dataType: 'string',\r\n    visible: false,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'subtitle',\r\n    caption: '子標題',\r\n    dataType: 'string',\r\n    visible: false,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n\r\n  // notification content\r\n  {\r\n    dataField: 'textContent',\r\n    caption: '文字內容',\r\n    dataType: 'string',\r\n    visible: false,\r\n    // validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'htmlContent',\r\n    caption: 'Html 內容',\r\n    dataType: 'string',\r\n    visible: false,\r\n    // validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'isFetchNotificationDataByEachReceiver',\r\n    caption: '是否依各通知接收者取得資料',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'filePaths',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'hyperlink',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n\r\n  // notification template\r\n  {\r\n    dataField: 'isUsingTemplate',\r\n    caption: '模板',\r\n    dataType: 'boolean',\r\n    visible: false,\r\n    editCellTemplate: 'isUsingTemplate'\r\n  },\r\n  {\r\n    dataField: 'textContentNotificationTemplateId',\r\n    caption: '通知模板 Id',\r\n    dataType: 'string',\r\n    visible: false,\r\n    // validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    name: 'textContentNotificationTemplateName',\r\n    caption: '通知模板名稱',\r\n    dataType: 'string',\r\n    visible: false,\r\n    // validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'textContentNotificationTemplateArgs',\r\n    caption: '通知模板參數',\r\n    dataType: 'string',\r\n    visible: false,\r\n    // validationRules: [requiredValidationRule],\r\n    editCellTemplate: 'textContentNotificationTemplateArgs'\r\n  }\r\n];","import { CRUDEndpoints } from \"src/app/shared/typing\";\r\n\r\nexport const cRUDEndpoints: CRUDEndpoints = {\r\n  index: '/api/app/reserved-notifications',\r\n  get: '/api/app/reserved-notifications',\r\n  create: '/api/app/reserved-notifications',\r\n  update: '/api/app/reserved-notifications',\r\n  delete: '/api/app/reserved-notifications',\r\n};\r\n","import { DataFieldLookUpSourceMapping } from \"src/app/shared/typing\";\r\n\r\nexport const dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = [\r\n  {\r\n    dataField: 'notificationProviderIds',\r\n    path: '/api/app/reserved-notifications/notification-provider-lookup'\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    path: '/api/app/reserved-notifications/receiver-lookup'\r\n  },\r\n  {\r\n    dataField: 'topicIds',\r\n    path: '/api/app/reserved-notifications/topic-lookup'\r\n  },\r\n  {\r\n    dataField: 'receiverGroupIds',\r\n    path: '/api/app/notification-infos/receiver-group-treeview'\r\n  },\r\n  {\r\n    dataField: 'notificationCategoryId',\r\n    path: '/api/app/reserved-notifications/notification-category-lookup'\r\n  },\r\n  {\r\n    dataField: 'textContentNotificationTemplateId',\r\n    path: '/api/app/reserved-notifications/notification-template-lookup'\r\n  },\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    path: '/api/app/reserved-notifications/tenant-lookup',\r\n    pathForSelectedDisplay: '/api/app/jbnotifier-admin/customized-tenants',\r\n  }\r\n];\r\n","import { RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\n\r\nexport const relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = [\r\n  {\r\n    dataField: 'id',\r\n    mapping: ['notificationInfo', 'id'],\r\n  },\r\n  {\r\n    dataField: 'concurrencyStamp',\r\n    mapping: ['notificationInfo', 'concurrencyStamp'],\r\n  },\r\n  {\r\n    dataField: 'type',\r\n    mapping: ['notificationInfo', 'type'],\r\n  },\r\n  //\r\n  {\r\n    dataField: 'name',\r\n    queryStringKey: 'Name',\r\n    mapping: ['notificationInfo', 'name'],\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    queryStringKey: 'TenantName',\r\n    mapping: ['tenant', 'name'],\r\n  },\r\n  {\r\n    name: 'notificationCategoryName',\r\n    queryStringKey: 'NotificationCategoryName',\r\n    mapping: ['notificationCategory', 'name'],\r\n  },\r\n  {\r\n    name: 'notificationProviders',\r\n    queryStringKey: 'NotificationProviderNames',\r\n    mapping: ['notificationProviders'],\r\n  },\r\n  {\r\n    name: 'receiverDescription',\r\n    queryStringKey: 'ReceiverDescription',\r\n    mapping: ['receiverDescription'],\r\n  },\r\n\r\n  // \r\n  {\r\n    dataField: 'notificationDataFetchEndpoint',\r\n    queryStringKey: 'NotificationDataFetchEndpoint',\r\n    mapping: ['notificationInfo', 'notificationDataFetchEndpoint']\r\n  },\r\n  {\r\n    dataField: 'hookEndpoint',\r\n    queryStringKey: 'HookEndpoint',\r\n    mapping: ['notificationInfo', 'hookEndpoint'],\r\n  },\r\n  {\r\n    name: 'isFullyFinished',\r\n    queryStringKey: 'IsFullyFinished',\r\n    mapping: ['notificationInfo', 'isFullyFinished'],\r\n  },\r\n  {\r\n    name: 'isDeletable',\r\n    queryStringKey: 'IsDeletable',\r\n    mapping: ['isDeletable'],\r\n  },\r\n  {\r\n    name: 'isEditable',\r\n    queryStringKey: 'IsEditable',\r\n    mapping: ['isEditable'],\r\n  },\r\n\r\n  // \r\n  {\r\n    dataField: 'title',\r\n    queryStringKey: 'Title',\r\n    mapping: ['notificationInfo', 'title'],\r\n  },\r\n  {\r\n    dataField: 'notificationProviderIds',\r\n    mapping: ['notificationProviderIds']\r\n  },\r\n  {\r\n    dataField: 'isSendToAllReceivers',\r\n    mapping: ['notificationInfo', 'isSendToAllReceivers']\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    mapping: ['receiverIds']\r\n  },\r\n  {\r\n    dataField: 'receiverGroupIds',\r\n    mapping: ['receiverGroupIds']\r\n  },\r\n  {\r\n    dataField: 'topicIds',\r\n    mapping: ['topicIds']\r\n  },\r\n  {\r\n    dataField: 'isIndependentNotificationSettingUsing',\r\n    mapping: ['notificationInfo', 'isIndependentNotificationSettingUsing']\r\n  },\r\n  {\r\n    dataField: 'notificationSettings',\r\n    mapping: ['notificationSettings']\r\n  },\r\n  {\r\n    dataField: 'notificationSchedulePlans',\r\n    mapping: ['notificationSchedulePlans']\r\n  },\r\n  {\r\n    dataField: 'notificationCategoryId',\r\n    mapping: ['notificationCategory', 'id']\r\n  },\r\n  {\r\n    dataField: 'subtitle',\r\n    mapping: ['notificationInfo', 'subtitle']\r\n  },\r\n  {\r\n    dataField: 'textContent',\r\n    mapping: ['notificationInfo', 'textContent']\r\n  },\r\n  {\r\n    dataField: 'htmlContent',\r\n    mapping: ['notificationInfo', 'htmlContent']\r\n  },\r\n  {\r\n    dataField: 'isFetchNotificationDataByEachReceiver',\r\n    mapping: ['notificationInfo', 'isFetchNotificationDataByEachReceiver']\r\n  },\r\n  {\r\n    dataField: 'filePaths',\r\n    mapping: ['notificationInfo', 'filePaths']\r\n  },\r\n  {\r\n    dataField: 'hyperlink',\r\n    mapping: ['notificationInfo', 'hyperlink']\r\n  },\r\n\r\n  // \r\n  {\r\n    dataField: 'textContentNotificationTemplateId',\r\n    mapping: ['textContentNotificationTemplate', 'id']\r\n  },\r\n  {\r\n    name: 'textContentNotificationTemplateName',\r\n    mapping: ['textContentNotificationTemplate', 'name']\r\n  },\r\n  {\r\n    dataField: 'textContentNotificationTemplateArgs',\r\n    mapping: ['notificationInfo', 'textContentNotificationTemplateArgs']\r\n  },\r\n\r\n  // \r\n  {\r\n    dataField: 'receivers',\r\n    mapping: ['receivers']\r\n  },\r\n  {\r\n    dataField: 'receiverGroups',\r\n    mapping: ['receiverGroups']\r\n  },\r\n  {\r\n    dataField: 'topics',\r\n    mapping: ['topics']\r\n  },\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    mapping: ['tenant', 'id'],\r\n  }\r\n];","import { Editing } from 'devextreme/ui/data_grid';\r\nimport type { Properties } from 'devextreme/ui/form';\r\nimport { htmlProperties } from 'src/app/shared/htmlProperties';\r\n\r\nconst formItems: Properties['items'] = [\r\n    {\r\n        itemType: 'group',\r\n        name: 'TopGroup',\r\n        cssClass: 'TopGroup',\r\n        colCount: 8,\r\n        items: [\r\n            {\r\n                itemType: 'group',\r\n                name: 'BasicGroup',\r\n                cssClass: 'BasicGroup',\r\n                caption: '基本',\r\n                colSpan: 5,\r\n                items: [\r\n                    {\r\n                        dataField: 'SpecifiedTenantId',\r\n                        editorType: 'dxSelectBox',\r\n                        visible: false\r\n                    },\r\n                    {\r\n                        dataField: 'name',\r\n                        editorType: 'dxTextBox',\r\n                        label: {\r\n                            text: '通知名稱'\r\n                        }\r\n                    },\r\n                    {\r\n                        dataField: 'notificationProviderIds',\r\n                        label: {\r\n                            visible: false\r\n                        }\r\n                    },\r\n                    {\r\n                        dataField: 'isSendToAllReceivers',\r\n                        cssClass: 'isSendToAllReceivers'\r\n                    },\r\n                    {\r\n                        itemType: 'group',\r\n                        name: \"custom-validation-group\",\r\n                        cssClass: \"custom-validation-group reserve-notification-custom-validation-group\",\r\n                        items: [\r\n                            {\r\n                                itemType: 'group',\r\n                                name: 'custom-validation-group-inputs',\r\n                                cssClass: 'custom-validation-group-inputs',\r\n                                items: [\r\n                                    {\r\n                                        dataField: 'receiverIds',\r\n                                        label: {\r\n                                            visible: false\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        dataField: 'receiverGroupIds',\r\n                                        label: {\r\n                                            visible: false\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        dataField: 'topicIds',\r\n                                        label: {\r\n                                            visible: false\r\n                                        }\r\n                                    },\r\n                                ]\r\n                            },\r\n                            {\r\n                                name: 'error',\r\n                                cssClass: 'custom-validation-group-error-message',\r\n                                template: 'error'\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                itemType: 'group',\r\n                name: 'SettingGroup',\r\n                cssClass: 'SettingGroup',\r\n                caption: '設定',\r\n                colSpan: 3,\r\n                items: [\r\n                    {\r\n                        dataField: 'isIndependentNotificationSettingUsing'\r\n                    },\r\n                    {\r\n                        dataField: 'notificationSettings',\r\n                        label: {\r\n                            visible: false\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        itemType: 'group',\r\n        name: 'SchedulePlanGroup',\r\n        cssClass: 'SchedulePlanGroup',\r\n        caption: '預約時間計劃',\r\n        items: [\r\n            {\r\n                dataField: 'notificationSchedulePlans',\r\n                label: {\r\n                    visible: false\r\n                }\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        itemType: 'group',\r\n        name: 'NotificationContentGroup',\r\n        cssClass: 'NotificationContentGroup',\r\n        caption: '通知內容',\r\n        colCount: 2,\r\n        items: [\r\n            {\r\n                dataField: 'isUsingTemplate',\r\n                cssClass: 'isUsingTemplate',\r\n                label: {\r\n                    visible: false\r\n                }\r\n            },\r\n            {\r\n                itemType: 'empty'\r\n            },\r\n            {\r\n                dataField: 'notificationCategoryId',\r\n                editorType: 'dxSelectBox'\r\n            },\r\n            {\r\n                itemType: 'empty'\r\n            },\r\n            {\r\n                dataField: 'title',\r\n                editorType: 'dxTextBox'\r\n            },\r\n            {\r\n                dataField: 'subtitle',\r\n                editorType: 'dxTextBox'\r\n            },\r\n            {\r\n                itemType: 'group',\r\n                name: 'CustomContentGroup',\r\n                cssClass: 'CustomContentGroup',\r\n                colSpan: 2,\r\n                colCount: 8,\r\n                items: [\r\n                    {\r\n                        dataField: 'textContent',\r\n                        editorType: 'dxTextArea',\r\n                        editorOptions: {\r\n                            height: '240px'\r\n                        },\r\n                        colSpan: 3\r\n                    },\r\n                    {\r\n                        dataField: 'htmlContent',\r\n                        editorType: 'dxHtmlEditor',\r\n                        editorOptions: {\r\n                            ...htmlProperties,\r\n                            height: '240px'\r\n                        },\r\n                        colSpan: 5\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                itemType: 'group',\r\n                name: 'NotificationTemplateGroup',\r\n                cssClass: 'NotificationTemplateGroup NotificationTemplateGroup--inactive',\r\n                colSpan: 2,\r\n                colCount: 2,\r\n                items: [\r\n                    {\r\n                        dataField: 'textContentNotificationTemplateId',\r\n                        editorType: 'dxSelectBox',\r\n                        cssClass: 'textContentNotificationTemplateId'\r\n                    },\r\n                    {\r\n                        itemType: 'empty'\r\n                    },\r\n                    {\r\n                        dataField: 'textContentNotificationTemplateArgs',\r\n                        label: {\r\n                            visible: false\r\n                        },\r\n                        colSpan: 2,\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                itemType: 'group',\r\n                name: 'EndpointGroup',\r\n                cssClass: 'EndpointGroup',\r\n                colSpan: 2,\r\n                colCount: 3,\r\n                items: [\r\n                    {\r\n                        dataField: 'notificationDataFetchEndpoint',\r\n                        editorType: 'dxTextBox'\r\n                    },\r\n                    {\r\n                        dataField: 'hookEndpoint',\r\n                        editorType: 'dxTextBox'\r\n                    },\r\n                    {\r\n                        dataField: 'isFetchNotificationDataByEachReceiver',\r\n                        editorType: 'dxCheckBox',\r\n                        cssClass: 'basic-form-checkbox'\r\n                    }\r\n                ]\r\n            },\r\n        ]\r\n    }\r\n]\r\n\r\nexport const formProperties: Properties = {\r\n    colCount: 1,\r\n    items: formItems,\r\n};\r\n\r\nexport const editingPropertiesForCreating: Editing = {\r\n    popup: {\r\n        title: '::編輯',\r\n        wrapperAttr: { class: 'basic-popup' },\r\n        showCloseButton: true,\r\n        toolbarItems: [\r\n            {\r\n                toolbar: 'bottom',\r\n                template: 'bottom-toolbar'\r\n            }\r\n        ],\r\n        width: '85vw',\r\n        height: '90vh'\r\n    },\r\n    form: {\r\n        colCount: 1,\r\n        items: formItems,\r\n        elementAttr: { class: 'custom-form custom-form--edit custom-form--edit-notification' }\r\n    }\r\n}\r\n\r\nexport const editingPropertiesForUpdating: Editing = {\r\n    popup: {\r\n        // container: 'app-instant-notification',\r\n        title: 'JbNotifier::Permission:Notifications',\r\n        wrapperAttr: { class: 'basic-popup' },\r\n        showCloseButton: true,\r\n        toolbarItems: [\r\n            {\r\n                toolbar: 'bottom',\r\n                template: 'bottom-toolbar'\r\n            }\r\n        ],\r\n        width: '85vw',\r\n        height: '90vh'\r\n    },\r\n    form: {\r\n        colCount: 1,\r\n        items: formItems,\r\n        elementAttr: { class: 'custom-form custom-form--edit custom-form--edit-notification' }\r\n    }\r\n}","import { Column } from 'devextreme/ui/data_grid';\r\n\r\nexport const columns: Column[] = [\r\n  {\r\n    dataField: 'name',\r\n    caption: '時間計畫名稱',\r\n    dataType: 'string'\r\n  },\r\n  {\r\n    dataField: 'pushTime',\r\n    caption: '預計推送時間',\r\n    dataType: 'datetime'\r\n  },\r\n  {\r\n    dataField: 'isActive',\r\n    caption: '是否已啟用',\r\n    dataType: 'boolean'\r\n  },\r\n  {\r\n    dataField: 'isFullyFinished',\r\n    caption: '是否已完成',\r\n    dataType: 'boolean'\r\n  }\r\n];","import { DataFieldLookUpSourceMapping } from \"src/app/shared/typing\";\r\n\r\nexport const dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = [\r\n];\r\n","import { RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\n\r\nexport const relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = [\r\n  {\r\n    dataField: 'name',\r\n    mapping: ['name'],\r\n  },\r\n  {\r\n    dataField: 'pushTime',\r\n    mapping: ['pushTime'],\r\n  },\r\n  {\r\n    dataField: 'isActive',\r\n    mapping: ['isActive'],\r\n  },\r\n  {\r\n    dataField: 'isFullyFinished',\r\n    mapping: ['isFullyFinished'],\r\n  },\r\n];\r\n","<dx-popup\r\n    [(visible)]=\"isDetailsVisible\"\r\n    [toolbarItems]=\"[{ toolbar: 'bottom', template: 'bottom-toolbar'}]\"\r\n    [wrapperAttr]=\"{class: 'basic-popup'}\"\r\n    title=\"時間計畫細節\"\r\n    width=\"85vw\"\r\n    height=\"90vh\"\r\n>\r\n    <div *dxTemplate=\"let data of 'content'\">\r\n        <dx-data-grid\r\n            #grid\r\n            appGridFeature\r\n            [datafieldValueQueryStringKeyMapping]=\"relatedDataValueAndQueryStringKeyMapping\"\r\n            [dataFieldLookUpSourceMapping]=\"dataFieldLookupSourceMapping\"\r\n            [columns]=\"columns\"\r\n            [dataSource]=\"gridDataSource\"\r\n            [gridProperties]=\"gridProperties\"\r\n        >\r\n            <div *dxTemplate=\"let cellInfo of 'JBHeaderCellTemplate'\">\r\n                {{cellInfo.column.caption}}\r\n            </div>\r\n        </dx-data-grid>\r\n    </div>\r\n\r\n    <div *dxTemplate=\"let data of 'bottom-toolbar'\">\r\n        <dx-button \r\n            appCustomButton\r\n            text=\"關閉\"\r\n            [elementAttr]=\"{class: 'custom-button'}\"  \r\n            (onClick)=\"closePopup()\"\r\n        >\r\n        </dx-button>\r\n    </div>\r\n</dx-popup>","import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';\r\nimport { DxDataGridComponent } from 'devextreme-angular';\r\nimport { Column, Properties } from 'devextreme/ui/data_grid';\r\nimport { columns } from '../../config/notification-schedule-plan-details/columns';\r\nimport { dataFieldLookupSourceMapping } from '../../config/notification-schedule-plan-details/datafield-lookup-source-mapping';\r\nimport { relatedDataValueAndQueryStringKeyMapping } from '../../config/notification-schedule-plan-details/datafield-value-query-string-key-mapping';\r\nimport { DataFieldLookUpSourceMapping, RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\nimport { NotificationSchedulePlan } from '../../config/notification-schedule-plan-details/typing';\r\nimport { formatTime } from '../../../shared/utils/time-format/utils';\r\n\r\n@Component({\r\n  selector: 'app-notification-schedule-plan-details',\r\n  templateUrl: './notification-schedule-plan-details.component.html'\r\n})\r\nexport class NotificationSchedulePlanDetailsComponent {\r\n  /**\r\n   * 取得datagrid元件，將之存於變數grid。\r\n   */\r\n  @ViewChild('grid', { static: false }) grid: DxDataGridComponent;\r\n\r\n  /**\r\n   * 顯示時間計畫細節data grid的資料，需要從主畫面，\r\n   * [notificationSchedulePlans]{@link ReserveNotificationInfosComponent#notificationSchedulePlans}引入\r\n   */\r\n  @Input() notificationSchedulePlans: NotificationSchedulePlan[]\r\n\r\n  /**\r\n   * 雙向綁定是否顯示時間計畫細節的popup，需要從主畫面[isDetailsVisible]{@link ReserveNotificationInfosComponent#isDetailsVisible}引入\r\n   */\r\n  @Input() isDetailsVisible: boolean = false\r\n\r\n  /**\r\n   * 雙向綁定，當關閉popup，把[isDetailsVisible]{@link NotificationSchedulePlanDetailsComponent#isDetailsVisible}設為false時，\r\n   * 也需要將主畫面[isDetailsVisible]{@link ReserveNotificationInfosComponent#isDetailsVisible}也設為false\r\n   */\r\n  @Output() isDetailsVisibleChange = new EventEmitter()\r\n\r\n  /**\r\n   * devextreme data grid columns\r\n   * \r\n   * 用來設定grid具有那些欄位。\r\n   * \r\n   * DevExtreme官方文件: [Column]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Columns/Overview/}\r\n   */\r\n  columns: Column[] = columns;\r\n\r\n  /**\r\n   * 選單與資料路徑對應設定檔案\r\n   * \r\n   * {@link GridFeatureDirective}接收後用來設定[DataGrid]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Getting_Started_with_DataGrid/}的新增、編輯表單裡的選單。\r\n   */\r\n  dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = dataFieldLookupSourceMapping;\r\n\r\n  /**\r\n   * 欄位、值、與回應資料結構的對應設定檔案\r\n   * \r\n   * 此頁面不會用到，但需要給予空陣列，避免報錯\r\n   */\r\n  relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = relatedDataValueAndQueryStringKeyMapping;\r\n\r\n  /**\r\n   * [grid]{@link NotificationSchedulePlanDetailsComponent#grid}的設定\r\n   * \r\n   * 關閉刪除、更新功能，引王filter row、toolbar與頁碼部分\r\n   */\r\n  gridProperties: Properties = {\r\n    editing: {\r\n      allowDeleting: false,\r\n      allowUpdating: false\r\n    },\r\n    filterRow: {\r\n      visible: false\r\n    },\r\n    toolbar: {\r\n      visible: false\r\n    },\r\n    pager: {\r\n      visible: false\r\n    },\r\n    height: '85%',\r\n    elementAttr: { class: 'schedule-plan-data-grid' }\r\n  }\r\n\r\n  /**\r\n   * devextreme grid datasource\r\n   * \r\n   * 此頁只用來顯示data grid資料\r\n   * \r\n   * DevExtreme官方文件: [DataSource]{@link https://js.devexpress.com/Angular/Documentation/23_2/ApiReference/Data_Layer/DataSource/}\r\n   */\r\n  gridDataSource: NotificationSchedulePlan[]\r\n\r\n  /**\r\n   * 當[isDetailsVisible]{@link NotificationSchedulePlanDetailsComponent#isDetailsVisible}改變時，\r\n   * 呼叫[getDataSource]{@link NotificationSchedulePlanDetailsComponent#getDataSource}\r\n   */\r\n  ngOnChanges() {\r\n    this.getDataSource()\r\n  }\r\n\r\n  /**\r\n   * 將[notificationSchedulePlans]{@link NotificationSchedulePlanDetailsComponent#notificationSchedulePlans}的資料，\r\n   * 整理需要的欄位後給予[gridDataSource]{@link NotificationSchedulePlanDetailsComponent#gridDataSource}\r\n   * \r\n   * 如果[notificationSchedulePlans]{@link NotificationSchedulePlanDetailsComponent#notificationSchedulePlans}為空，\r\n   * 則顯示無資料\r\n   */\r\n  getDataSource() {\r\n    if (!this.notificationSchedulePlans?.length) {\r\n      return\r\n    }\r\n\r\n    this.gridDataSource = this.notificationSchedulePlans.map(plan => ({\r\n      name: plan.name,\r\n      pushTime: formatTime(plan.pushTime),\r\n      isActive: plan.isActive,\r\n      isFullyFinished: plan.isFullyFinished\r\n    }))\r\n  }\r\n\r\n  /**\r\n   * 由於[isDetailsVisible]{@link NotificationSchedulePlanDetailsComponent#isDetailsVisible}使用雙向綁定，\r\n   * 所以在關閉popup時，呼叫[isDetailsVisibleChange]{@link NotificationSchedulePlanDetailsComponent#isDetailsVisibleChange}，\r\n   * 將[ReserveNotificationInfosComponent#isDetailsVisible]{@link ReserveNotificationInfosComponent#isDetailsVisible}也關閉\r\n   */\r\n  closePopup() {\r\n    this.isDetailsVisibleChange.emit(false)\r\n  }\r\n}","<div class=\"custom-grid-container\">\r\n  <app-tenant-chooser></app-tenant-chooser>\r\n\r\n  <div class=\"grid-tool-bar\">\r\n      <div>\r\n        <app-grid-filter-items\r\n          [grid]=\"grid\"\r\n        ></app-grid-filter-items>\r\n      </div>\r\n      <div class=\"d-flex justify-content-between\">\r\n        <div>\r\n          <dx-button\r\n            appGridAddButton\r\n            (onClick)=\"router.navigate(['./reserve-notification-infos/create-notification-info'])\"\r\n          >\r\n          </dx-button>\r\n        </div>\r\n        <app-grid-after-tool-bar\r\n          [grid]=\"grid\"\r\n        >\r\n        </app-grid-after-tool-bar>\r\n      </div>\r\n  </div>\r\n\r\n  <dx-data-grid\r\n    #grid\r\n    appGridFeature\r\n    appGridFeatureNotification\r\n    [datafieldValueQueryStringKeyMapping]=\"relatedDataValueAndQueryStringKeyMapping\"\r\n    [dataFieldLookUpSourceMapping]=\"dataFieldLookupSourceMapping\"\r\n    [editingPropertiesForCreating]=\"editingPropertiesForCreating\"\r\n    [editingPropertiesForUpdating]=\"editingPropertiesForUpdating\"\r\n    [columns]=\"columns\"\r\n    [dataSource]=\"gridDataSource\"\r\n    [isEditingDataAsync]=\"true\"\r\n    [gridProperties]=\"gridProperties\"\r\n    [(notificationTemplateId)]=\"notificationTemplateId\"\r\n    (onRowExpanded)=\"onRowExpanded($event)\"\r\n    (onOptionChanged)=\"onOptionChanged($event)\"\r\n    (onSaving)=\"onSaving($event)\"\r\n  >\r\n    <ng-container\r\n      *dxTemplate=\"let cellInfo of 'error'\"\r\n    >\r\n      <div>\r\n        {{errorMessage}}\r\n      </div>\r\n    </ng-container>\r\n\r\n    <div *dxTemplate=\"let cellInfo of 'bottom-toolbar'\">\r\n      <app-bottom-toolbar-btns [grid]=\"grid\"></app-bottom-toolbar-btns>\r\n    </div>\r\n\r\n    <ng-container *ngFor=\"let template of templateStore.gridTemplates | keyvalue\">\r\n      <ng-container *dxTemplate=\"let cellInfo of template.key\">\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            templateStore.getGridTemplates(template.key);\r\n            context: { $implicit: cellInfo }\r\n          \"\r\n        >\r\n        </ng-container>\r\n      </ng-container>\r\n    </ng-container>\r\n\r\n    <ng-container *ngFor=\"let template of notificationTemplateStore.templates | keyvalue\">\r\n      <ng-container *dxTemplate=\"let cellInfo of template.key\">\r\n        @if (template.key === 'textContentNotificationTemplateArgs') {\r\n          <ng-container\r\n            *ngTemplateOutlet=\"\r\n            notificationTemplateStore.getTemplates(template.key);\r\n            context: {$implicit: cellInfo, templateKey: template.key, notificationTemplateId: notificationTemplateId}\r\n            \"\r\n          >\r\n          </ng-container>\r\n        }\r\n        @else {\r\n          <ng-container\r\n            *ngTemplateOutlet=\"\r\n            notificationTemplateStore.getTemplates(template.key);\r\n            context: {$implicit: cellInfo, templateKey: template.key}\r\n            \"\r\n          >\r\n          </ng-container>\r\n        }\r\n      </ng-container>\r\n    </ng-container>\r\n\r\n    <dx-button\r\n      *dxTemplate=\"let cellInfo of 'gridSchedulePlanDetailsButton'\"\r\n      appGridViewButton\r\n      (click)=\"openDetailsTable(cellInfo.data.notificationSchedulePlans)\"\r\n    >\r\n    </dx-button>\r\n  </dx-data-grid>\r\n\r\n  <ng-container\r\n    *ngTemplateOutlet=\"\r\n      notificationTemplateStore.getTemplates('notificationPager');\r\n      context: { $implicit: grid }\r\n    \"\r\n  >\r\n  </ng-container>\r\n</div>\r\n\r\n<app-notification-schedule-plan-details\r\n  [(isDetailsVisible)]=\"isDetailsVisible\"\r\n  [notificationSchedulePlans]=\"notificationSchedulePlans\"\r\n>\r\n</app-notification-schedule-plan-details>","import { AuthGuard, PermissionGuard } from '@abp/ng.core';\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ReserveNotificationInfosComponent } from './components/reserve-notification-infos.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ReserveNotificationInfosComponent,\r\n    canActivate: [AuthGuard, PermissionGuard],\r\n  },\r\n  {\r\n    path: 'create-notification-info',\r\n    loadChildren: () => import('../create-notification-info/create-notification-info.module').then(m => m.CreateNotificationInfoModule)\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class InstantNotificationInfosRoutingModule { }\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport type { Editing, OptionChangedEvent, Properties, RowExpandedEvent, RowValidatingEvent, SavingEvent } from 'devextreme/ui/data_grid';\r\nimport { DxDataGridComponent } from 'devextreme-angular';\r\nimport { Column } from 'devextreme/ui/data_grid';\r\nimport { columns } from '../config/reserve-notification-infos/columns';\r\nimport { cRUDEndpoints } from '../config/reserve-notification-infos/crud-endpoints';\r\nimport { dataFieldLookupSourceMapping } from '../config/reserve-notification-infos/datafield-lookup-source-mapping';\r\nimport { relatedDataValueAndQueryStringKeyMapping } from '../config/reserve-notification-infos/datafield-value-query-string-key-mapping';\r\nimport {\r\n  editingPropertiesForCreating,\r\n  editingPropertiesForUpdating,\r\n} from '../config/reserve-notification-infos/form-properties';\r\nimport DataSource from 'devextreme/data/data_source';\r\nimport { CRUDEndpoints, DataFieldLookUpSourceMapping, RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\nimport { GridDataSourceService } from 'src/app/shared/service/grid-data-source.service/grid-data-source.service';\r\nimport { TemplateStoreService } from 'src/app/shared/service/template-store.service';\r\nimport { NotificationTemplateStoreService } from 'src/app/shared/service/notification-template-store/notification-template-store.service';\r\nimport { Router } from '@angular/router';\r\nimport { NotificationSchedulePlan } from '../config/notification-schedule-plan-details/typing';\r\nimport { TenantChooserService } from 'src/app/shared/modules/tenant-chooser/tenant-chooser.service';\r\nimport { CustomRule, ValidationCallbackData } from 'devextreme/common';\r\n\r\n@Component({\r\n  selector: 'app-instant-notification',\r\n  templateUrl: './reserve-notification-infos.component.html',\r\n  styleUrls: ['reserve-notification-infos.component.scss'],\r\n})\r\n\r\nexport class ReserveNotificationInfosComponent implements OnInit {\r\n  /**\r\n   * 取得datagrid元件，將之存於變數grid。\r\n   */\r\n  @ViewChild('grid', { static: false }) grid: DxDataGridComponent;\r\n\r\n  /**\r\n   * devextreme data grid columns\r\n   * \r\n   * 用來設定grid具有那些欄位。\r\n   * \r\n   * DevExtreme官方文件: [Column]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Columns/Overview/}\r\n   */\r\n  columns: Column[] = columns;\r\n\r\n  /**\r\n   * devextreme grid datasource\r\n   * \r\n   * grid dataSource, 用來連接grid與後端data的新增、讀取、修改、刪除。\r\n   * \r\n   * 透過[getDataSource]{@link GridDataSourceService#getDataSource}使用[cRUDEndpoints]{@link ReserveNotificationInfosComponent#cRUDEndpoints}與[relatedDataValueAndQueryStringKeyMapping]{@link ReserveNotificationInfosComponent#relatedDataValueAndQueryStringKeyMapping}產生。\r\n   * \r\n   * DevExtreme官方文件: [DataSource]{@link https://js.devexpress.com/Angular/Documentation/23_2/ApiReference/Data_Layer/DataSource/}\r\n   */\r\n  gridDataSource: DataSource;\r\n\r\n  /**\r\n   * 設定增、刪、查、改的路徑\r\n   * \r\n   * 用於[getDataSource]{@link GridDataSourceService#getDataSource}接收然後利用產生[gridDataSource]{@link ReserveNotificationInfosComponent#gridDataSource}。\r\n   */\r\n  cRUDEndpoints: CRUDEndpoints = cRUDEndpoints;\r\n\r\n  /**\r\n   * 選單與資料路徑對應設定檔案\r\n   * \r\n   * {@link GridFeatureDirective}接收後用來設定[DataGrid]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Getting_Started_with_DataGrid/}的新增、編輯表單裡的選單。\r\n   */\r\n  dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = dataFieldLookupSourceMapping;\r\n\r\n  /**\r\n   * 欄位、值、與回應資料結構的對應設定檔案\r\n   * \r\n   * 用於[getDataSource]{@link GridDataSourceService#getDataSource}接收然後利用產生[gridDataSource]{@link ReserveNotificationInfosComponent#gridDataSource}。\r\n   */\r\n  relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = relatedDataValueAndQueryStringKeyMapping;\r\n\r\n  /**\r\n   * 新增的表單設定\r\n   * \r\n   * DevExtreme官方文件: [Editing]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Editing/}\r\n   */\r\n  editingPropertiesForCreating: Editing = editingPropertiesForCreating;\r\n\r\n  /**\r\n   * 編輯的表單設定\r\n   * \r\n   * DevExtreme官方文件: [Editing]{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Editing/}\r\n   */\r\n  editingPropertiesForUpdating: Editing = editingPropertiesForUpdating;\r\n\r\n  /**\r\n   * 通知模板ID\r\n   * \r\n   * 選擇通知模板後，藉由ID取得該模板的內容與參數\r\n   */\r\n  notificationTemplateId: string\r\n\r\n  /**\r\n   * 時間計畫細節的popup是否可見\r\n   */\r\n  isDetailsVisible: boolean = false\r\n\r\n  /**\r\n   * 存取用於時間計畫細節的資料\r\n   */\r\n  notificationSchedulePlans: NotificationSchedulePlan[] = []\r\n\r\n  /**\r\n   * 使用master detail功能時，記錄目前展開的Row，以在展開新的Row時，可以關閉上一個開啟的Row，確保只會有一個Row是展開的\r\n   */\r\n  masterDetailRowCollapseKey: string\r\n\r\n  errorMessage = \"\"\r\n\r\n\r\n  /**\r\n   * 啟用master detail功能，並給予[template]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/Common/Object_Structures/template/}\r\n   * \r\n   * 設定高度\r\n   * \r\n   * DevExtreme官方文件: [Properties]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/masterDetail/}\r\n   */\r\n  gridProperties: Properties = {\r\n    masterDetail: {\r\n      enabled: true,\r\n      template: 'basic-master-detail-row-template'\r\n    },\r\n    height: '85%'\r\n  }\r\n\r\n  /**\r\n   * 參考{@link https://js.devexpress.com/Angular/Documentation/23_2/Guide/UI_Components/DataGrid/Editing|Editing},\r\n   * [editCellTemplate]{@link https://js.devexpress.com/Angular/Documentation/23_2/ApiReference/UI_Components/dxDataGrid/Configuration/columns/\\#editCellTemplate/},\r\n   * [template]{@link js.devexpress.com/Angular/Documentation/23_2/ApiReference/UI_Components/dxForm/Item_Types/SimpleItem/#template/}\r\n   * \r\n   * 使用[tenantChooser]{@link TenantChooserService}，當HOST指定租戶時，改變Grid中的對應的資料\r\n   * \r\n   * 配置receiverIds、receiverGroupIds、topicIds的驗證規則\r\n   * \r\n   * @param gridDataSourceService dxdatagrid所使用的產生datasource相關功能\r\n   * @param templateStore 共用的dx template儲存service，用於dx-data-grid、dx-form的custom template, 參考editCellTemplate, template\r\n   * @param notificationTemplateStore 共用的dx template儲存service，用於dx-data-grid、dx-form的custom template, 參考editCellTemplate, template,\r\n   * 但只用於新增通知項目時使用\r\n   * @param router 用於新增時，將頁面導向共用的新增頁面\r\n   * @param notificationTagBoxService \r\n   */\r\n  constructor(\r\n    private gridDataSourceService: GridDataSourceService,\r\n    protected templateStore: TemplateStoreService,\r\n    protected notificationTemplateStore: NotificationTemplateStoreService,\r\n    protected router: Router,\r\n    private tenantChooser: TenantChooserService\r\n  ) {\r\n    this.tenantChooser.tenantId$.subscribe(tenandId => {\r\n      this.grid?.instance?.refresh()\r\n    });\r\n\r\n\r\n    const columnReceiverGroupIds = columns.find(c => c.dataField === 'receiverGroupIds');\r\n    const columnTopicIds = columns.find(c => c.dataField === 'topicIds');\r\n    const receiverIds = columns.find(c => c.dataField === 'receiverIds');\r\n    columnReceiverGroupIds.validationRules = [this.setCustomValidationRule('receiverGroupIds')]\r\n    columnTopicIds.validationRules = [this.setCustomValidationRule('topicIds')]\r\n    receiverIds.validationRules = [this.setCustomValidationRule('receiverIds')]\r\n  }\r\n\r\n  /**\r\n   * receiverIds、receiverGroupIds、topicIds驗證規則，當isSendToAllReceivers === true、\r\n   * 該欄位的陣列長度至少為1、其他兩項欄位的陣列長度至少為1，其中一項符合時，驗證通過\r\n   * \r\n   * 使用[reevaluate]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxValidator/Validation_Rules/CustomRule/#reevaluate}，\r\n   * \r\n   * @param name 需要設置驗證規則的欄位名稱\r\n   */\r\n  setCustomValidationRule(name: string) {\r\n    const optionDataTargets = ['receiverIds', 'receiverGroupIds', 'topicIds'].filter(target => target !== name)\r\n\r\n    const customValidationRule: CustomRule = {\r\n      type: 'custom',\r\n      message: '接收者、接收者群組、主題必須選擇一項',\r\n      reevaluate: true,\r\n      validationCallback: (option: ValidationCallbackData) => {\r\n        if (\r\n          option.data.isSendToAllReceivers ||\r\n          option.value.length ||\r\n          option.data[optionDataTargets[0]].length ||\r\n          option.data[optionDataTargets[1]].length\r\n        ) {\r\n          // grid的option方法會導致重繪，暫用此法。\r\n          // 如果不使用json控制form格式，而是寫在html的template也許有機會可以做動態控制。\r\n          document.querySelector('.reserve-notification-custom-validation-group').classList.remove('error')\r\n          this.errorMessage = ''\r\n          return true\r\n        }\r\n        // grid的option方法會導致重繪，暫用此法。\r\n        // 如果不使用json控制form格式，而是寫在html的template也許有機會可以做動態控制。\r\n        document.querySelector('.reserve-notification-custom-validation-group').classList.add('error')\r\n        this.errorMessage = '接收者、接收者群組、主題必須選擇一項'\r\n        return false\r\n      }\r\n    }\r\n\r\n    return customValidationRule\r\n  }\r\n\r\n  /**\r\n   * 元件啟動後，透過[getDataSource]{@link GridDataSourceService#getDataSource}使用設定檔設定grid的dataSource - [gridDataSource]{@link ReserveNotificationInfosComponent#gridDataSource}。\r\n   */\r\n  ngOnInit(): void {\r\n    this.gridDataSource = this.gridDataSourceService.getDataSource(\r\n      cRUDEndpoints,\r\n      relatedDataValueAndQueryStringKeyMapping\r\n    );\r\n  }\r\n\r\n  /**\r\n   * [rowExpanded]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Events/#rowExpanded}事件觸發時，呼叫[applyyNotificationMasterDetailRowCollapse]{@link InstantNotificationInfosComponent#applyNotificationMasterDetailRowCollapse}\r\n   * \r\n   * @param e 參考RowExpandedEvent\r\n   */\r\n  onRowExpanded(e: RowExpandedEvent) {\r\n    this.applyNotificationMasterDetailRowCollapse(e)\r\n  }\r\n\r\n  /**\r\n   * 展開master detail時，添加畫面項目需要的CSS\r\n   * \r\n   * 如果[masterDetailRowCollapseKey]{@link ReserveNotificationInfosComponent#masterDetailRowCollapseKey}與按下展開按鈕的Row是一樣的時，則[masterDetailRowCollapseKey]{@link ReserveNotificationInfosComponent#masterDetailRowCollapseKey}不變\r\n   * \r\n   * 記錄展開當下的[masterDetailRowCollapseKey]{@link ReserveNotificationInfosComponent#masterDetailRowCollapseKey}，並確保每次只會有一個Row被展開\r\n   * \r\n   * 使用setTimeout避免NG0100{@link https://angular.dev/errors/NG0100}Error\r\n   */\r\n  applyNotificationMasterDetailRowCollapse(e: RowExpandedEvent) {\r\n    setTimeout(() => {\r\n      const tdElementCollapse = e.element.querySelector('[aria-label=\"Collapse\"]')\r\n      const trElementRowIndex = tdElementCollapse.parentElement.ariaRowIndex\r\n      const trElementRow = e.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex=\"${trElementRowIndex}\"]`)\r\n      trElementRow.classList.add('master-detail-row-collapse')\r\n    })\r\n\r\n    if (e.key === this.masterDetailRowCollapseKey) {\r\n      return\r\n    }\r\n\r\n    e.component.collapseRow(this.masterDetailRowCollapseKey);\r\n    this.masterDetailRowCollapseKey = e.key\r\n  }\r\n\r\n  /**\r\n   * 將該筆資料的時間計畫細節popup開啟，以及取得時間計畫細節的資料，最後再將該資料傳入時間計畫細節的data grid中\r\n   * \r\n   * @param notificationSchedulePlans 利用[cellInfo]{@link https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/columns/#cellTemplate}取得欄位資料\r\n   */\r\n  openDetailsTable(notificationSchedulePlans: NotificationSchedulePlan[]) {\r\n    this.isDetailsVisible = true\r\n    this.notificationSchedulePlans = notificationSchedulePlans\r\n  }\r\n\r\n  /**\r\n   * 當切換 \"所有人(isSendToAllReceivers === true)\" ，必須在資料送出前，將receiverIds、receiverGroupIds、topicIds設為空陣列\r\n   * \r\n   * 新增或編輯時，將htmlContentNotificationTemplateArgs與htmlContentNotificationTemplateId的值設為與textContentNotificationTemplateArgs、textContentNotificationTemplateId一樣\r\n   * \r\n   * 參考[SavingEvent]{@link  https://js.devexpress.com/Angular/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/#onSaving}\r\n   * \r\n   * @param e SavingEvent\r\n   */\r\n  onSaving(e: SavingEvent) {\r\n    if (e.changes[0]?.type === 'update' && e.changes[0].data?.isSendToAllReceivers) {\r\n      e.changes[0].data.receiverIds = []\r\n      e.changes[0].data.receiverGroupIds = []\r\n      e.changes[0].data.topicIds = []\r\n    }\r\n\r\n    if (e.changes[0]?.type === 'update' && e.changes[0].data?.textContentNotificationTemplateId) {\r\n      e.changes[0].data.htmlContentNotificationTemplateId = e.changes[0].data?.textContentNotificationTemplateId\r\n      e.changes[0].data.htmlContentNotificationTemplateArgs = e.changes[0].data?.textContentNotificationTemplateArgs || ''\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 取得[notificationTemplateId]{@link ReserveNotificationInfosComponent#notificationTemplateId}\r\n   * \r\n   * @param e OptionChangedEvent\r\n   */\r\n  onOptionChanged(e: OptionChangedEvent) {\r\n    if (\r\n      e.fullName !== 'editing.changes' ||\r\n      !e.value ||\r\n      !e.value[0]?.data ||\r\n      !('textContentNotificationTemplateId' in e.value[0].data)\r\n    ) {\r\n      return\r\n    }\r\n\r\n    this.notificationTemplateId = e.value[0].data.textContentNotificationTemplateId\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { ReserveNotificationInfosComponent } from './components/reserve-notification-infos.component';\r\nimport { InstantNotificationInfosRoutingModule } from './reserve-notification-infos-routing.module';\r\nimport { DXComponentsModule } from '../shared/dx-components.module';\r\nimport { DxHtmlEditorModule } from 'devextreme-angular';\r\nimport { NotificationSchedulePlanDetailsComponent } from './components/notification-schedule-plan-details/notification-schedule-plan-details.component';\r\nimport { GridFilterItemsComponent } from \"../shared/components/grid/grid-filter-items/grid-filter-items.component\";\r\nimport { TenantChooserModule } from \"../shared/modules/tenant-chooser/tenant-chooser.module\";\r\n\r\n@NgModule({\r\n  declarations: [ReserveNotificationInfosComponent, NotificationSchedulePlanDetailsComponent],\r\n  imports: [\r\n    CommonModule,\r\n    InstantNotificationInfosRoutingModule,\r\n    DXComponentsModule,\r\n    DxHtmlEditorModule,\r\n    SharedModule,\r\n    GridFilterItemsComponent,\r\n    TenantChooserModule\r\n  ],\r\n})\r\nexport class ReserveNotificationInfosModule { }\r\n"],"x_google_ignoreList":[]}