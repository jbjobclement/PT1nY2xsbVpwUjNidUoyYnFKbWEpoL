{"version":3,"file":"19818.260ecae16e424ba5.js","mappings":"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","names":["columns","type","fixed","buttons","name","template","dataField","visible","caption","dataType","filterOperations","filterOperationTypes","text","validationRules","requiredValidationRule","editCellTemplate","calculateCellValue","rowData","receiverIds","map","r","id","cRUDEndpoints","index","get","create","update","delete","dataFieldLookupSourceMapping","path","pathForSelectedDisplay","relatedDataValueAndQueryStringKeyMapping","mapping","queryStringKey","editingPropertiesForCreating","popup","title","wrapperAttr","class","showCloseButton","toolbarItems","toolbar","width","form","colCount","items","editorType","label","elementAttr","editingPropertiesForUpdating","editorOptions","disabled","i0","TopicsComponent_ng_container_5_ng_container_1_ng_container_1_Template","ctx_r5","templateStore","getGridTemplates","template_r4","key","_c1","cellInfo_r6","TopicsComponent_ng_container_5_ng_container_1_Template","_r0","$event","cellInfo_r10","_r12","$implicit","setValue","column","dataSource","data","receivers","routes","component","TopicsComponent","constructor","gridDataSourceService","configStateService","tenantChooser","this","getOne$","subscribe","currentUser","tenantId","tenantId$","tenandId","grid","instance","refresh","ngOnInit","gridDataSource","getDataSource","onInitNewRow","e","static","t","i1","i2","i3","i4","core","Xpm","selectors","viewQuery","rf","ctx","TopicsComponent_ng_container_5_Template","TopicsComponent_div_7_Template","TopicsComponent_app_notification_tag_box_8_Template","gridTemplates","canActivate","AuthGuard","PermissionGuard","TopicsRoutingModule","oAB","cJS","RouterModule","forChild","TopicsModule","CommonModule","SharedModule","DXComponentsModule","NotificationPagerComponent","NotificationTagBoxComponent","TenantChooserModule"],"sourceRoot":"webpack:///","sources":["./src/app/topics/config/columns.ts","./src/app/topics/config/crud-endpoints.ts","./src/app/topics/config/datafield-lookup-source-mapping.ts","./src/app/topics/config/datafield-value-query-string-key-mapping.ts","./src/app/topics/config/form-properties.ts","./src/app/topics/components/topics.component.html","./src/app/topics/topics-routing.module.ts","./src/app/topics/components/topics.component.ts","./src/app/topics/topics.module.ts"],"sourcesContent":["import { Column } from 'devextreme/ui/data_grid';\r\nimport { filterOperationTypes } from 'src/app/shared/grid/filterOperations';\r\nimport { requiredValidationRule } from 'src/app/shared/validationRules/required';\r\n\r\n\r\nexport const columns: Column[] = [\r\n  {\r\n    type: 'buttons',\r\n    fixed: true,\r\n    buttons: [\r\n      {\r\n        name: 'save',\r\n        template: 'grid-save-button',\r\n      },\r\n      {\r\n        name: 'edit',\r\n        template: 'grid-edit-button',\r\n      },\r\n      {\r\n        name: 'delete',\r\n        template: 'grid-delete-button',\r\n      },\r\n      {\r\n        name: 'cancel',\r\n        template: 'grid-cancel-button',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    dataField: 'id',\r\n    visible: false,\r\n  },\r\n  {\r\n    dataField: 'concurrencyStamp',\r\n    visible: false,\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    caption: '租戶',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text\r\n  },\r\n  {\r\n    dataField: 'idCode',\r\n    caption: 'idCode',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'name',\r\n    caption: '主題名稱',\r\n    dataType: 'string',\r\n    filterOperations: filterOperationTypes.text,\r\n    validationRules: [requiredValidationRule]\r\n  },\r\n  {\r\n    dataField: 'sortingNumber',\r\n    caption: '排序',\r\n    dataType: 'number',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    caption: '接收者 (可複選)',\r\n    dataType: 'object',\r\n    visible: false,\r\n    editCellTemplate: 'receiverIds',\r\n    calculateCellValue(rowData) {\r\n      const value = rowData['receiverIds'].map(r => {\r\n        return r.id;\r\n      })\r\n      return value;\r\n    },\r\n  },\r\n  {\r\n    name: 'receivers',\r\n    dataType: 'object',\r\n    visible: false\r\n  },\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    caption: '指定租戶',\r\n    dataType: 'string',\r\n    visible: false\r\n  },\r\n  {\r\n    name: 'SpecifiedTenantName',\r\n    caption: '指定租戶',\r\n    dataType: 'string',\r\n    visible: false\r\n  }\r\n];\r\n","import { CRUDEndpoints } from \"src/app/shared/typing\";\r\nexport const cRUDEndpoints: CRUDEndpoints = {\r\n  index: '/api/app/jbnotifier-admin/topics',\r\n  get: '/api/app/jbnotifier-admin/topics',\r\n  create: '/api/app/jbnotifier-admin/topics',\r\n  update: '/api/app/jbnotifier-admin/topics',\r\n  delete: '/api/app/jbnotifier-admin/topics',\r\n};","import { DataFieldLookUpSourceMapping } from \"src/app/shared/typing\";\r\nexport const dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = [\r\n    {\r\n        dataField: 'receiverIds',\r\n        path: '/api/app/topics/receiver-lookup'\r\n    },\r\n    {\r\n        dataField: 'SpecifiedTenantId',\r\n        path: '/api/app/jbnotifier-admin/customized-users/tenant-lookup',\r\n        pathForSelectedDisplay: '/api/app/jbnotifier-admin/customized-tenants',\r\n    }\r\n];","import { RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\n\r\nexport const relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping = [\r\n  {\r\n    dataField: 'id',\r\n    mapping: ['topic', 'id'],\r\n  },\r\n  {\r\n    dataField: 'concurrencyStamp',\r\n    mapping: ['topic', 'concurrencyStamp'],\r\n  },\r\n  {\r\n    dataField: 'idCode',\r\n    queryStringKey: 'IdCode',\r\n    mapping: ['topic', 'idCode'],\r\n  },\r\n  {\r\n    dataField: 'name',\r\n    queryStringKey: 'Name',\r\n    mapping: ['topic', 'name'],\r\n  },\r\n  {\r\n    dataField: 'sortingNumber',\r\n    queryStringKey: 'SortingNumber',\r\n    mapping: ['topic', 'sortingNumber'],\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    queryStringKey: 'ReceiverIds',\r\n    mapping: ['receivers'],\r\n  },\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    queryStringKey: 'TenantId',\r\n    mapping: ['tenant', 'id'],\r\n  },\r\n  {\r\n    name: 'tenantName',\r\n    queryStringKey: 'TenantName',\r\n    mapping: ['tenant', 'name']\r\n  },\r\n  {\r\n    name: 'receivers',\r\n    mapping: ['receivers']\r\n  },\r\n  {\r\n    name: \"SpecifiedTenantName\",\r\n    mapping: [\"tenant\", \"name\"]\r\n  }\r\n];","import { Editing } from 'devextreme/ui/data_grid';\r\n\r\nconst createformItems: Editing['form']['items'] = [\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    editorType: 'dxSelectBox'\r\n  },\r\n  {\r\n    dataField: 'idCode',\r\n    editorType: 'dxTextBox',\r\n  },\r\n  {\r\n    dataField: 'name',\r\n    editorType: 'dxTextBox',\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    label: {\r\n      visible: false\r\n    }\r\n  },\r\n  {\r\n    dataField: 'sortingNumber',\r\n    editorType: 'dxTextBox',\r\n  }\r\n];\r\n\r\nconst updateformItems: Editing['form']['items'] = [\r\n  {\r\n    dataField: 'SpecifiedTenantId',\r\n    editorType: 'dxSelectBox',\r\n    editorOptions: {\r\n      disabled: true\r\n    }\r\n  },\r\n  {\r\n    dataField: 'idCode',\r\n    editorType: 'dxTextBox',\r\n    editorOptions: {\r\n      disabled: true\r\n    }\r\n  },\r\n  {\r\n    dataField: 'name',\r\n    editorType: 'dxTextBox',\r\n  },\r\n  {\r\n    dataField: 'receiverIds',\r\n    label: {\r\n      visible: false\r\n    },\r\n  },\r\n  {\r\n    dataField: 'sortingNumber',\r\n    editorType: 'dxTextBox',\r\n  }\r\n];\r\n/**\r\n * Properties for creating popup form.\r\n */\r\nexport const editingPropertiesForCreating: Editing = {\r\n  popup: {\r\n    title: 'JbNotifier::Permission:Topics',\r\n    wrapperAttr: { class: 'basic-popup' },\r\n    showCloseButton: true,\r\n    toolbarItems: [\r\n      {\r\n        toolbar: 'bottom',\r\n        template: 'bottom-toolbar'\r\n      }\r\n    ],\r\n    width: 500,\r\n  },\r\n  form: {\r\n    colCount: 1,\r\n    items: createformItems,\r\n    elementAttr: { class: 'custom-form custom-form--edit' }\r\n  },\r\n};\r\n\r\n/**\r\n * Properties for updating popup form.\r\n */\r\n\r\nexport const editingPropertiesForUpdating: Editing = {\r\n  popup: {\r\n    title: 'JbNotifier::Permission:Topics',\r\n    wrapperAttr: { class: 'basic-popup' },\r\n    showCloseButton: true,\r\n    toolbarItems: [\r\n      {\r\n        toolbar: 'bottom',\r\n        template: 'bottom-toolbar'\r\n      }\r\n    ],\r\n    width: 500,\r\n  },\r\n  form: {\r\n    colCount: 1,\r\n    items: updateformItems,\r\n    elementAttr: { class: 'custom-form custom-form--edit' }\r\n  },\r\n};","<div class=\"custom-grid-container\">\r\n  <app-tenant-chooser></app-tenant-chooser>\r\n\r\n  <app-grid-tool-bar [grid]=\"grid\"></app-grid-tool-bar>\r\n\r\n  <dx-data-grid\r\n    #grid\r\n    appGridFeature\r\n    appGridFeatureNotification\r\n    [datafieldValueQueryStringKeyMapping]=\"relatedDataValueAndQueryStringKeyMapping\"\r\n    [dataFieldLookUpSourceMapping]=\"dataFieldLookupSourceMapping\"\r\n    [editingPropertiesForCreating]=\"editingPropertiesForCreating\"\r\n    [editingPropertiesForUpdating]=\"editingPropertiesForUpdating\"\r\n    [columns]=\"columns\"\r\n    [dataSource]=\"gridDataSource\"\r\n    [isEditingDataAsync]=\"true\"\r\n    (onInitNewRow)=\"onInitNewRow($event)\"\r\n  >\r\n    <ng-container *ngFor=\"let template of templateStore.gridTemplates | keyvalue\">\r\n      <ng-container *dxTemplate=\"let cellInfo of template.key\">\r\n        <ng-container\r\n          *ngTemplateOutlet=\"\r\n            templateStore.getGridTemplates(template.key);\r\n            context: { $implicit: cellInfo }\r\n          \"\r\n        >\r\n        </ng-container>\r\n      </ng-container>\r\n    </ng-container>\r\n\r\n    <div *dxTemplate=\"let cellInfo of 'bottom-toolbar'\">\r\n      <app-bottom-toolbar-btns [grid]=\"grid\"></app-bottom-toolbar-btns>\r\n    </div>\r\n\r\n    <app-notification-tag-box\r\n      *dxTemplate=\"let cellInfo of 'receiverIds'\"\r\n      [dataSource]=\"cellInfo.column.editorOptions.dataSource\"\r\n      [rowData]=\"cellInfo.data['receivers']\"\r\n      [label]=\"cellInfo.column.caption\"\r\n      [isRequired]=\"cellInfo.column.validationRules && cellInfo.column.validationRules[0].type === 'required'\"\r\n      [value]=\"cellInfo.data.receiverIds\"\r\n      (valueChange)=\"cellInfo.setValue($event)\"\r\n    >\r\n  </app-notification-tag-box>\r\n</dx-data-grid>\r\n\r\n  <app-notification-pager [grid]=\"grid\"></app-notification-pager>\r\n</div>","import { AuthGuard, PermissionGuard } from '@abp/ng.core';\r\nimport { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { TopicsComponent } from './components/topics.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: TopicsComponent,\r\n    canActivate: [AuthGuard, PermissionGuard],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class TopicsRoutingModule {}\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport type { Editing, InitNewRowEvent } from 'devextreme/ui/data_grid';\r\nimport { DxDataGridComponent } from 'devextreme-angular';\r\nimport { Column } from 'devextreme/ui/data_grid';\r\nimport { columns } from '../config/columns';\r\nimport { cRUDEndpoints } from '../config/crud-endpoints';\r\nimport { dataFieldLookupSourceMapping } from '../config/datafield-lookup-source-mapping';\r\nimport { relatedDataValueAndQueryStringKeyMapping } from '../config/datafield-value-query-string-key-mapping';\r\nimport {\r\n  editingPropertiesForCreating,\r\n  editingPropertiesForUpdating,\r\n} from '../config/form-properties';\r\nimport DataSource from 'devextreme/data/data_source';\r\nimport { CRUDEndpoints, DataFieldLookUpSourceMapping, RelatedDataValueAndQueryStringKeyMapping } from 'src/app/shared/typing';\r\nimport { GridDataSourceService } from 'src/app/shared/service/grid-data-source.service/grid-data-source.service';\r\nimport { TemplateStoreService } from 'src/app/shared/service/template-store.service';\r\nimport { TenantChooserService } from 'src/app/shared/modules/tenant-chooser/tenant-chooser.service';\r\nimport { ConfigStateService } from '@abp/ng.core';\r\n/**\r\n * 主題說明待補\r\n */\r\n@Component({\r\n  selector: 'app-topics',\r\n  templateUrl: 'topics.component.html',\r\n  styleUrls: [],\r\n})\r\nexport class TopicsComponent implements OnInit {\r\n  /**\r\n   * @property {Editing} editingPropertiesForCreating Setting for create.\r\n   * @property {Editing} editingPropertiesForUpdating Setting for upate.\r\n   * @property {Array} probationaryCalculations Probationary related calculations.\r\n   */\r\n  @ViewChild('grid', { static: false }) grid: DxDataGridComponent;\r\n  // grid related properties\r\n  columns: Column[] = columns;\r\n  gridDataSource: DataSource;\r\n  cRUDEndpoints: CRUDEndpoints = cRUDEndpoints;\r\n  dataFieldLookupSourceMapping: DataFieldLookUpSourceMapping = dataFieldLookupSourceMapping;\r\n  // formItemTranslationMapping: any[] = formItemTranslationMapping;\r\n  // dataFieldTranslationKeysMapping: DataFieldTranslationKeysMapping = dataFieldTranslationKeysMapping;\r\n  relatedDataValueAndQueryStringKeyMapping: RelatedDataValueAndQueryStringKeyMapping =\r\n    relatedDataValueAndQueryStringKeyMapping;\r\n  editingPropertiesForCreating: Editing = editingPropertiesForCreating;\r\n  editingPropertiesForUpdating: Editing = editingPropertiesForUpdating;\r\n\r\n  constructor(\r\n    private gridDataSourceService: GridDataSourceService,\r\n    protected templateStore: TemplateStoreService,\r\n    private configStateService: ConfigStateService,\r\n    private tenantChooser: TenantChooserService\r\n  ) {\r\n    this.configStateService.getOne$(\"currentUser\").subscribe(currentUser => {\r\n      if (currentUser.tenantId) {\r\n        this.columns[3].visible = false;\r\n        this.editingPropertiesForCreating.form.items[0].visible = false\r\n        this.editingPropertiesForUpdating.form.items[0].visible = false\r\n      }\r\n    })\r\n\r\n    this.tenantChooser.tenantId$.subscribe(tenandId => {\r\n      this.grid?.instance?.refresh()\r\n    })\r\n  }\r\n  ngOnInit(): void {\r\n    this.gridDataSource = this.gridDataSourceService.getDataSource(\r\n      cRUDEndpoints,\r\n      relatedDataValueAndQueryStringKeyMapping\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 新增時，receiverIds預設為空陣列，因為後端不接受undefined，\r\n   */\r\n  onInitNewRow(e: InitNewRowEvent) {\r\n    e.data['receiverIds'] = []\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { TopicsComponent } from './components/topics.component';\r\nimport { TopicsRoutingModule } from './topics-routing.module';\r\nimport { DXComponentsModule } from '../shared/dx-components.module';\r\nimport { NotificationPagerComponent } from '../shared/components/notification/notification-pager/notification-pager.component';\r\nimport { NotificationTagBoxComponent } from \"../shared/components/notification/notification-tag-box/notification-tag-box.component\";\r\nimport { TenantChooserModule } from \"../shared/modules/tenant-chooser/tenant-chooser.module\";\r\n@NgModule({\r\n  declarations: [TopicsComponent],\r\n  imports: [\r\n    CommonModule,\r\n    TopicsRoutingModule,\r\n    SharedModule,\r\n    DXComponentsModule,\r\n    NotificationPagerComponent,\r\n    NotificationTagBoxComponent,\r\n    TenantChooserModule\r\n  ],\r\n})\r\nexport class TopicsModule { }\r\n"],"x_google_ignoreList":[]}