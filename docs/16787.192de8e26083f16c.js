"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[16787],{16787:(tt,m,i)=>{i.r(m),i.d(m,{PendingNotificationsModule:()=>X});var p=i(96814),T=i(31610),c=i(88762),g=i(23758),s=i(35461);const b=[{type:"buttons",fixed:!0,buttons:[{name:"edit",template:"grid-edit-button"}],width:50,minWidth:50},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:s.I$.text},{dataField:"expectedPushTime",caption:"\u9810\u8a08\u63a8\u9001\u6642\u9593",dataType:"datetime",filterOperations:s.I$.date},{name:"receiverName",caption:"\u63a5\u6536\u8005\u540d\u7a31",dataType:"string",filterOperations:s.I$.text},{name:"category",caption:"\u5206\u985e",dataType:"string",filterOperations:s.I$.text},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:s.I$.text},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",filterOperations:s.I$.text},{dataField:"textContent",dataType:"string",visible:!1},{dataField:"htmlContent",dataType:"string",visible:!1},{type:"detailExpand",fixed:!0,fixedPosition:"right"}],u={index:"/api/app/jbnotifier-admin/pending-notifications",get:"/api/app/jbnotifier-admin/pending-notifications",create:"/api/app/jbnotifier-admin/pending-notifications",update:"/api/app/jbnotifier-admin/pending-notifications",delete:"/api/app/jbnotifier-admin/pending-notifications"},P=[],f=[{dataField:"id",mapping:["pendingNotification","id"]},{dataField:"concurrencyStamp",mapping:["pendingNotification","concurrencyStamp"]},{name:"tenantName",mapping:["tenant","name"],queryStringKey:"TenantName"},{dataField:"isModifiedWhenPending",mapping:["pendingNotification","isModifiedWhenPending"],queryStringKey:"IsModifiedWhenPending"},{dataField:"expectedPushTime",mapping:["notificationSchedulePlan","nextExpectedPushTime"],queryStringKey:"ExpectedPushTime"},{name:"receiverName",mapping:["receiver","name"],queryStringKey:"ReceiverName"},{name:"category",queryStringKey:"NotificationCategoryName",mapping:["notificationCategory","name"]},{dataField:"title",queryStringKey:"Title",mapping:["pendingNotification","title"]},{dataField:"subtitle",queryStringKey:"Subtitle",mapping:["pendingNotification","subtitle"]},{dataField:"textContent",queryStringKey:"TextContent",mapping:["pendingNotification","textContent"]},{dataField:"htmlContent",queryStringKey:"HtmlContent",mapping:["pendingNotification","htmlContent"]},{dataField:"concurrencyStamp",queryStringKey:"ConcurrencyStamp",mapping:["pendingNotification","concurrencyStamp"]},{name:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{name:"filePaths",queryStringKey:"FilePaths",mapping:["pendingNotification","filePaths"]},{name:"hyperlink",queryStringKey:"Hyperlink",mapping:["pendingNotification","hyperlink"]}],h=[{dataField:"title",editorType:"dxTextBox",colSpan:1},{dataField:"subtitle",editorType:"dxTextBox",colSpan:1},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...i(35130).W,height:"240px"},colSpan:5}]}],M={popup:{title:"",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:"85vw",height:"90vh"},form:{colCount:2,items:h}},F={popup:{title:"JbNotifier::Permission:Notifications",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:"85vw",height:"90vh"},form:{colCount:2,items:h,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}};var t=i(19212),N=i(67),O=i(72783),A=i(59444),Z=i(13443),D=i(65343),I=i(92931),w=i(25659),Q=i(20843),E=i(25012),C=i(12305),J=i(21194),V=i(27310),K=i(11028),_=i(16358),B=i(21137),x=i(89267),y=i(33630);const v=()=>({class:"custom-button custom-button--blue"});let U=(()=>{class e{constructor(){this.isHTMLContentVisible=!1,this.isTextContentVisible=!1}static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-pending-notifications-master-detail"]],inputs:{cellInfo:"cellInfo"},decls:25,vars:11,consts:[[1,"master-detail"],[1,"master-detail-container"],[1,"master-detail-title"],[1,"master-detail-content"],[1,"master-detail-item"],[1,"master-detail-label"],["appCustomButton","","text","\u67e5\u770b",3,"elementAttr","onClick"],[1,"master-detail-text"],["appCheckBox","",3,"disabled","value"],[3,"isHTMLContentVisible","htmlContent","isHTMLContentVisibleChange"],[3,"isTextContentVisible","textContent","isTextContentVisibleChange"]],template:function(a,n){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"\u8a73\u7d30\u63cf\u8ff0"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"label",5),t._uU(8,"\u7d14\u6587\u5b57\u5167\u5bb9"),t.qZA(),t.TgZ(9,"dx-button",6),t.NdJ("onClick",function(){return n.isTextContentVisible=!0}),t.qZA()(),t.TgZ(10,"div",4)(11,"label",5),t._uU(12,"HTML\u5167\u5bb9"),t.qZA(),t.TgZ(13,"dx-button",6),t.NdJ("onClick",function(){return n.isHTMLContentVisible=!0}),t.qZA()(),t.TgZ(14,"div",4)(15,"label",5),t._uU(16,"Hook Endpoint"),t.qZA(),t.TgZ(17,"span",7),t._uU(18),t.qZA()(),t.TgZ(19,"div",4)(20,"label",5),t._uU(21,"\u7b49\u5019\u4e2d\u4fee\u6539(\u662f/\u5426)"),t.qZA(),t._UZ(22,"dx-check-box",8),t.qZA()()()(),t.TgZ(23,"app-html-content-viewer",9),t.NdJ("isHTMLContentVisibleChange",function(d){return n.isHTMLContentVisible=d}),t.qZA(),t.TgZ(24,"app-text-content-viewer",10),t.NdJ("isTextContentVisibleChange",function(d){return n.isTextContentVisible=d}),t.qZA()),2&a&&(t.xp6(9),t.Q6J("elementAttr",t.DdM(9,v)),t.xp6(4),t.Q6J("elementAttr",t.DdM(10,v)),t.xp6(5),t.Oqu(n.cellInfo.data.hookEndpoint),t.xp6(4),t.Q6J("disabled",!0)("value",n.cellInfo.data.isModifiedWhenPending),t.xp6(),t.Q6J("isHTMLContentVisible",n.isHTMLContentVisible)("htmlContent",n.cellInfo.data.htmlContent),t.xp6(),t.Q6J("isTextContentVisible",n.isTextContentVisible)("textContent",n.cellInfo.data.textContent))},dependencies:[V.A,K.w,_.K,B.v,x.Q,y.$],styles:[".master-detail[_ngcontent-%COMP%]{background-color:var(--dx-master-detail-row-background);padding:3px 20px 16px}.master-detail-container[_ngcontent-%COMP%]{padding:0 24px;background-color:var(--white-1);border:1px solid var(--gray-2);border-radius:5px}.master-detail-title[_ngcontent-%COMP%]{padding:8px 0;border-bottom:1px solid var(--gray-3)}.master-detail-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:600;letter-spacing:var(--letter-2);color:var(--blue-1);margin-bottom:0}.master-detail-content[_ngcontent-%COMP%]{padding:16px 0;display:flex;flex-wrap:wrap;row-gap:16px}.master-detail-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:50%}.master-detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}.master-detail-item[_ngcontent-%COMP%]:nth-child(odd){padding-right:8px}.master-detail-item[_ngcontent-%COMP%]:nth-child(2n){padding-left:8px}.master-detail-label[_ngcontent-%COMP%]{color:var(--gray-2);margin-bottom:8px}.master-detail-text[_ngcontent-%COMP%]{display:block;color:var(--black-1);white-space:normal;word-wrap:break-word}"]})}return e})();const L=["grid"];function H(e,l){1&e&&t._UZ(0,"app-pending-notifications-master-detail",8),2&e&&t.Q6J("cellInfo",l.$implicit)}function R(e,l){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",7),t.qZA()),2&e){t.oxw();const o=t.MAs(4);t.xp6(),t.Q6J("grid",o)}}function $(e,l){1&e&&t.GkF(0)}const k=e=>({$implicit:e});function G(e,l){if(1&e&&(t.ynx(0),t.YNc(1,$,1,0,"ng-container",9),t.BQk()),2&e){const o=l.$implicit,a=t.oxw().$implicit,n=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",t.VKq(2,k,o))}}function j(e,l){if(1&e&&(t.ynx(0),t.YNc(1,G,2,4,"ng-container",5),t.BQk()),2&e){const o=l.$implicit;t.xp6(),t.Q6J("dxTemplateOf",o.key)}}const Y=[{path:"",component:(()=>{class e{constructor(o,a,n,r){this.gridDataSourceService=o,this.templateStore=a,this.tenantChooser=n,this.configStateService=r,this.gridProperties={editing:{allowAdding:!1},masterDetail:{enabled:!0,template:"pending-notifications-master-detail"}},this.columns=b,this.cRUDEndpoints=u,this.dataFieldLookupSourceMapping=P,this.relatedDataValueAndQueryStringKeyMapping=f,this.editingPropertiesForCreating=M,this.editingPropertiesForUpdating=F,this.rowExpanded=d=>{this.applyyNotificationMasterDetailRowCollapse(d)},this.configStateService.getOne$("currentUser").subscribe(d=>{d.tenantId&&(this.columns[3].visible=!1)}),this.tenantChooser.tenantId$.subscribe(d=>{this.grid?.instance?.refresh()})}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(u,f)}ngAfterViewInit(){this.grid.instance.on("rowExpanded",this.rowExpanded)}applyyNotificationMasterDetailRowCollapse(o){setTimeout(()=>{const n=o.element.querySelector('[aria-label="Collapse"]').parentElement.ariaRowIndex;o.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex="${n}"]`).classList.add("master-detail-row-collapse")}),o.key!==this.masterDetailRowCollapseKey&&(o.component.collapseRow(this.masterDetailRowCollapseKey),this.masterDetailRowCollapseKey=o.key)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(N.I),t.Y36(O.z),t.Y36(A.L),t.Y36(c.XJE))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-pending-notifications"]],viewQuery:function(a,n){if(1&a&&t.Gf(L,5),2&a){let r;t.iGM(r=t.CRH())&&(n.grid=r.first)}},decls:10,vars:15,consts:[[1,"custom-grid-container"],[3,"grid","hideCreateBtn"],["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","gridProperties"],["grid",""],[3,"cellInfo",4,"dxTemplate","dxTemplateOf"],[4,"dxTemplate","dxTemplateOf"],[4,"ngFor","ngForOf"],[3,"grid"],[3,"cellInfo"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(a,n){if(1&a&&(t.TgZ(0,"div",0),t._UZ(1,"app-tenant-chooser")(2,"app-grid-tool-bar",1),t.TgZ(3,"dx-data-grid",2,3),t.YNc(5,H,1,1,"app-pending-notifications-master-detail",4)(6,R,2,1,"div",5)(7,j,2,1,"ng-container",6),t.ALo(8,"keyvalue"),t.qZA(),t._UZ(9,"app-notification-pager",7),t.qZA()),2&a){const r=t.MAs(4);t.xp6(2),t.Q6J("grid",r)("hideCreateBtn",!0),t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForCreating",n.editingPropertiesForCreating)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("gridProperties",n.gridProperties),t.xp6(2),t.Q6J("dxTemplateOf","pending-notifications-master-detail"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("ngForOf",t.lcZ(8,13,n.templateStore.gridTemplates)),t.xp6(2),t.Q6J("grid",r)}},dependencies:[p.sg,p.tP,Z._,D.f,I.R,w.l,Q.p6,E.e,C.D,J.D,U,p.Nd],encapsulation:2})}return e})(),canActivate:[c.a1M,c.nG9]}];let W=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(Y),g.Bz]})}return e})();var z=i(5533),q=i(41992);let X=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[p.ez,W,T.m,z.P,x.Q,y.$,C.D,q.e]})}return e})()}}]);