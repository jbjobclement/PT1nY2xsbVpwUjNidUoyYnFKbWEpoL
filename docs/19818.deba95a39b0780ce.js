"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[19818],{19818:(H,m,a)=>{a.r(m),a.d(m,{TopicsModule:()=>E});var s=a(96814),b=a(31610),c=a(88762),u=a(23758),l=a(35461),g=a(85054);const x=[{type:"buttons",fixed:!0,buttons:[{name:"save",template:"grid-save-button"},{name:"edit",template:"grid-edit-button"},{name:"delete",template:"grid-delete-button"},{name:"cancel",template:"grid-cancel-button"}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{name:"tenantName",caption:"\u79df\u6236",dataType:"string",filterOperations:l.I$.text},{dataField:"idCode",caption:"idCode",dataType:"string",filterOperations:l.I$.text,validationRules:[g.L]},{dataField:"name",caption:"\u4e3b\u984c\u540d\u7a31",dataType:"string",filterOperations:l.I$.text,validationRules:[g.L]},{dataField:"sortingNumber",caption:"\u6392\u5e8f",dataType:"number",visible:!1},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds",calculateCellValue:e=>e.receiverIds.map(i=>i.id)},{name:"receivers",dataType:"object",visible:!1},{dataField:"SpecifiedTenantId",caption:"\u6307\u5b9a\u79df\u6236",dataType:"string",visible:!1},{name:"SpecifiedTenantName",caption:"\u6307\u5b9a\u79df\u6236",dataType:"string",visible:!1}],f={index:"/api/app/jbnotifier-admin/topics",get:"/api/app/jbnotifier-admin/topics",create:"/api/app/jbnotifier-admin/topics",update:"/api/app/jbnotifier-admin/topics",delete:"/api/app/jbnotifier-admin/topics"},F=[{dataField:"receiverIds",path:"/api/app/topics/receiver-lookup"},{dataField:"SpecifiedTenantId",path:"/api/app/jbnotifier-admin/customized-users/tenant-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/customized-tenants"}],v=[{dataField:"id",mapping:["topic","id"]},{dataField:"concurrencyStamp",mapping:["topic","concurrencyStamp"]},{dataField:"idCode",queryStringKey:"IdCode",mapping:["topic","idCode"]},{dataField:"name",queryStringKey:"Name",mapping:["topic","name"]},{dataField:"sortingNumber",queryStringKey:"SortingNumber",mapping:["topic","sortingNumber"]},{dataField:"receiverIds",queryStringKey:"ReceiverIds",mapping:["receivers"]},{dataField:"SpecifiedTenantId",queryStringKey:"TenantId",mapping:["tenant","id"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"receivers",mapping:["receivers"]},{name:"SpecifiedTenantName",mapping:["tenant","name"]}],C={popup:{title:"JbNotifier::Permission:Topics",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:500},form:{colCount:1,items:[{dataField:"SpecifiedTenantId",editorType:"dxSelectBox"},{dataField:"idCode",editorType:"dxTextBox"},{dataField:"name",editorType:"dxTextBox"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"sortingNumber",editorType:"dxTextBox"}],elementAttr:{class:"custom-form custom-form--edit"}}},I={popup:{title:"JbNotifier::Permission:Topics",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}],width:500},form:{colCount:1,items:[{dataField:"SpecifiedTenantId",editorType:"dxSelectBox",editorOptions:{disabled:!0}},{dataField:"idCode",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"name",editorType:"dxTextBox"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"sortingNumber",editorType:"dxTextBox"}],elementAttr:{class:"custom-form custom-form--edit"}}};var t=a(19212),N=a(67),O=a(72783),A=a(59444),D=a(13443),J=a(65343),Q=a(92931),M=a(25659),R=a(20843),B=a(25012),T=a(12305),y=a(51189),P=a(21194);const U=["grid"];function K(e,d){1&e&&t.GkF(0)}const Z=e=>({$implicit:e});function j(e,d){if(1&e&&(t.ynx(0),t.YNc(1,K,1,0,"ng-container",7),t.BQk()),2&e){const i=d.$implicit,o=t.oxw().$implicit,n=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(o.key))("ngTemplateOutletContext",t.VKq(2,Z,i))}}function $(e,d){if(1&e&&(t.ynx(0),t.YNc(1,j,2,4,"ng-container",5),t.BQk()),2&e){const i=d.$implicit;t.xp6(),t.Q6J("dxTemplateOf",i.key)}}function L(e,d){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",1),t.qZA()),2&e){t.oxw();const i=t.MAs(4);t.xp6(),t.Q6J("grid",i)}}function G(e,d){if(1&e){const i=t.EpF();t.TgZ(0,"app-notification-tag-box",8),t.NdJ("valueChange",function(n){const p=t.CHM(i).$implicit;return t.KtG(p.setValue(n))}),t.qZA()}if(2&e){const i=d.$implicit;t.Q6J("dataSource",i.column.editorOptions.dataSource)("rowData",i.data.receivers)("label",i.column.caption)("isRequired",i.column.validationRules&&"required"===i.column.validationRules[0].type)("value",i.data.receiverIds)}}const V=[{path:"",component:(()=>{class e{constructor(i,o,n,r){this.gridDataSourceService=i,this.templateStore=o,this.configStateService=n,this.tenantChooser=r,this.columns=x,this.cRUDEndpoints=f,this.dataFieldLookupSourceMapping=F,this.relatedDataValueAndQueryStringKeyMapping=v,this.editingPropertiesForCreating=C,this.editingPropertiesForUpdating=I,this.configStateService.getOne$("currentUser").subscribe(p=>{p.tenantId&&(this.columns[3].visible=!1,this.editingPropertiesForCreating.form.items[0].visible=!1,this.editingPropertiesForUpdating.form.items[0].visible=!1)}),this.tenantChooser.tenantId$.subscribe(p=>{this.grid?.instance?.refresh()})}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(f,v)}onInitNewRow(i){i.data.receiverIds=[]}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(N.I),t.Y36(O.z),t.Y36(c.XJE),t.Y36(A.L))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-topics"]],viewQuery:function(o,n){if(1&o&&t.Gf(U,5),2&o){let r;t.iGM(r=t.CRH())&&(n.grid=r.first)}},decls:10,vars:14,consts:[[1,"custom-grid-container"],[3,"grid"],["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","onInitNewRow"],["grid",""],[4,"ngFor","ngForOf"],[4,"dxTemplate","dxTemplateOf"],[3,"dataSource","rowData","label","isRequired","value","valueChange",4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"dataSource","rowData","label","isRequired","value","valueChange"]],template:function(o,n){if(1&o&&(t.TgZ(0,"div",0),t._UZ(1,"app-tenant-chooser")(2,"app-grid-tool-bar",1),t.TgZ(3,"dx-data-grid",2,3),t.NdJ("onInitNewRow",function(p){return n.onInitNewRow(p)}),t.YNc(5,$,2,1,"ng-container",4),t.ALo(6,"keyvalue"),t.YNc(7,L,2,1,"div",5)(8,G,1,5,"app-notification-tag-box",6),t.qZA(),t._UZ(9,"app-notification-pager",1),t.qZA()),2&o){const r=t.MAs(4);t.xp6(2),t.Q6J("grid",r),t.xp6(),t.Q6J("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForCreating",n.editingPropertiesForCreating)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("isEditingDataAsync",!0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(6,12,n.templateStore.gridTemplates)),t.xp6(2),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("dxTemplateOf","receiverIds"),t.xp6(),t.Q6J("grid",r)}},dependencies:[s.sg,s.tP,D._,J.f,Q.R,M.l,R.p6,B.e,T.D,y.h,P.D,s.Nd],encapsulation:2})}return e})(),canActivate:[c.a1M,c.nG9]}];let Y=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(V),u.Bz]})}return e})();var w=a(5533),z=a(41992);let E=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[s.ez,Y,b.m,w.P,T.D,y.h,z.e]})}return e})()}}]);