"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[88049],{88049:(Ue,b,o)=>{o.r(b),o.d(b,{ReserveNotificationInfosModule:()=>Oe});var r=o(96814),O=o(66648),m=o(88762),x=o(23758),p=o(35461),d=o(85054),g=o(93116);const U=[{type:"buttons",fixed:!0,buttons:[{name:"details",template:"grid-details-button"},{name:"edit",template:"grid-edit-button",disabled:t=>!t.row?.data?.isEditable},{name:"delete",template:"grid-delete-button",disabled:t=>!t.row?.data?.isDeletable}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:p.I.text,validationRules:[d.L]},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:p.I.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:p.I.text},{name:"notificationProviderNames",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:p.I.text},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:p.I.text},{name:"pushTimes",caption:"\u63a8\u9001\u6642\u9593 (\u591a\u7b46)",dataType:"string",filterOperations:p.I.text,calculateDisplayValue:t=>t.pushTimes?t.pushTimes.split("\u3001").map(i=>(0,g.m)(new Date(i+" GMT+0000").toISOString())).join("\u3001"):"",visible:!1},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:p.I.text,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:p.I.text,visible:!1},{name:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean",visible:!1},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"notificationProviderDefinitionIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviders",validationRules:[d.L]},{dataField:"isForAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isForAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"isUsingSpecificNotificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettingItems"},{dataField:"notificationSchedulePlans",caption:"\u9810\u7d04\u6642\u9593\u8a08\u756b",dataType:"object",visible:!1,editCellTemplate:"notificationSchedulePlans"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[d.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[d.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"notificationTemplateId",caption:"\u901a\u77e5\u6a21\u677f Id",dataType:"string",visible:!1},{dataField:"notificationTemplateArgs",caption:"\u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"notificationTemplateArgs"}],C={index:"/api/app/reserve-notification-infos",get:"/api/app/reserve-notification-infos",create:"/api/app/reserve-notification-infos",update:"/api/app/reserve-notification-infos",delete:"/api/app/reserve-notification-infos"},w=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"},{dataField:"notificationTemplateId",path:"/api/app/notification-infos/assignable-notification-templates",pathForSelectedDisplay:"/api/app/notification-templates"}],y=[{dataField:"id",mapping:["id"]},{dataField:"concurrencyStamp",mapping:["concurrencyStamp"]},{dataField:"title",queryStringKey:"Title",mapping:["title"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenantName"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategoryName"]},{name:"notificationProviderNames",queryStringKey:"NotificationProviderNames",mapping:["notificationProviderNames"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{name:"pushTimes",queryStringKey:"PushTimes",mapping:["pushTimes"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["hookEndpoint"]},{name:"isFinished",queryStringKey:"IsFinished",mapping:["isFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderDefinitionIds",mapping:["notificationProviderDefinitionIds"]},{dataField:"isForAllReceivers",mapping:["isForAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"isUsingSpecificNotificationSettings",mapping:["isUsingSpecificNotificationSettings"]},{dataField:"notificationSettingItems",mapping:["notificationSettingItems"]},{dataField:"notificationSchedulePlans",mapping:["notificationSchedulePlans"]},{dataField:"notificationCategoryId",mapping:["notificationCategoryId"]},{dataField:"subtitle",mapping:["subtitle"]},{dataField:"textContent",mapping:["textContent"]},{dataField:"htmlContent",mapping:["htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["isFetchNotificationDataByEachReceiver"]},{dataField:"notificationTemplateId",mapping:["notificationTemplateId"]},{dataField:"notificationTemplateArgs",mapping:["notificationTemplateArgs"]}],h=[{itemType:"group",name:"TopGroup",colCount:8,cssClass:"basic-edit-form-top-group",items:[{itemType:"group",name:"TopLeftGroup",caption:"\u57fa\u672c",colSpan:5,cssClass:"top-left-group",items:[{dataField:"notificationProviderDefinitionIds",label:{visible:!1}},{dataField:"isForAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]},{itemType:"group",name:"TopRightGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",label:{visible:!1}}]}]},{itemType:"group",name:"MidGroup",caption:"\u91cd\u8907\u6642\u9593\u8a08\u5283",items:[{dataField:"notificationSchedulePlans",label:{visible:!1}}]},{itemType:"group",name:"BottomGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{focusStateEnabled:!1,activeStateEnabled:!1,tableResizing:{enabled:!0},imageUpload:{fileUploadMode:"both",tabs:["url","file"]},toolbar:{items:[{name:"undo"},{name:"redo"},{name:"separator"},{name:"size",acceptedValues:["8pt","10pt","12pt","14pt","18pt","24pt","36pt"]},{name:"font",acceptedValues:["Arial","Georgia","Tahoma","Times New Roman","Verdana"]},{name:"separator"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"underline"},{name:"separator"},{name:"alignLeft"},{name:"alignCenter"},{name:"alignRight"},{name:"alignJustify"},{name:"separator"},{name:"orderedList"},{name:"bulletList"},{name:"separator"},{name:"header",acceptedValues:[!1,1,2,3,4,5]},{name:"separator"},{name:"color"},{name:"background"}]},height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"notificationTemplateId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"notificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"NotificationEndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"}]}]}],Z={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"}},form:{colCount:1,items:h,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}},J={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"}},form:{colCount:1,items:h,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}};var e=o(19212),M=o(67),S=o(72783),f=o(16358),_=o(20843),u=o(2173),I=o(25012),Q=o(69420),N=o(20481),G=o(65343),E=o(49291),F=o(44932),P=o(90962),R=o(98991),D=o(68833),A=o(68545),T=o(6990),B=o(11430),K=o(87899),V=o(98179),k=o(66782);const L=["popup"];function H(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"div",4)(1,"div")(2,"label",5)(3,"span",6)(4,"span",7),e._uU(5," \u9810\u7d04\u6642\u9593 "),e.qZA()()(),e.TgZ(6,"dx-date-box",8,9),e.NdJ("valueChange",function(a){e.CHM(i);const l=e.oxw();return e.KtG(l.pushTime=a)}),e.qZA()()()}if(2&t){const i=e.oxw();e.xp6(6),e.Q6J("value",i.pushTime)}}function $(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"dx-button",12),e.NdJ("onClick",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.confirm())}),e.qZA()(),e.TgZ(3,"dx-button",13),e.NdJ("onClick",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.cancel())}),e.qZA()()}}const Y=()=>({toolbar:"bottom",template:"bottom-toolbar",location:"after"}),j=t=>[t];let q=(()=>{class t{constructor(){this.isCreatePushTimeVisible=!1,this.isCreatePushTimeVisibleChange=new e.vpe,this.selectPushTime=new e.vpe}onHidden(){this.isCreatePushTimeVisibleChange.emit(!1)}confirm(){this.selectPushTime.emit(this.pushTime),this.popup.instance.toggle(!1)}cancel(){this.popup.instance.toggle(!1)}static#e=this.\u0275fac=function(n){return new(n||t)};static#i=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-notification-schedule-plan-create-push-time"]],viewQuery:function(n,a){if(1&n&&e.Gf(L,5),2&n){let l;e.iGM(l=e.CRH())&&(a.popup=l.first)}},inputs:{pushTime:"pushTime",isCreatePushTimeVisible:"isCreatePushTimeVisible"},outputs:{isCreatePushTimeVisibleChange:"isCreatePushTimeVisibleChange",selectPushTime:"selectPushTime"},decls:4,vars:7,consts:[["title","\u9810\u7d04\u6642\u9593\u8a08\u756b","width","450","height","300","contentTemplate","content",3,"visible","toolbarItems","visibleChange","onHidden"],["popup",""],["class","d-flex",4,"dxTemplate","dxTemplateOf"],["class","d-flex align-items-center",4,"dxTemplate","dxTemplateOf"],[1,"d-flex"],[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],["type","datetime","dateSerializationFormat","yyyy-MM-ddTHH:mm:ss.SSS+08:00",3,"value","valueChange"],["dateBox",""],[1,"d-flex","align-items-center"],[1,"me-2"],["type","primary","text","\u78ba\u5b9a",3,"onClick"],["type","primary","text","\u53d6\u6d88",3,"onClick"]],template:function(n,a){1&n&&(e.TgZ(0,"dx-popup",0,1),e.NdJ("visibleChange",function(c){return a.isCreatePushTimeVisible=c})("onHidden",function(){return a.onHidden()}),e.YNc(2,H,8,1,"div",2)(3,$,4,0,"div",3),e.qZA()),2&n&&(e.Q6J("visible",a.isCreatePushTimeVisible)("toolbarItems",e.VKq(5,j,e.DdM(4,Y))),e.xp6(2),e.Q6J("dxTemplateOf","content"),e.xp6(),e.Q6J("dxTemplateOf","bottom-toolbar"))},dependencies:[f.K,_.p6,V.x,k.M],encapsulation:2})}return t})();function z(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"dx-button",10),e.NdJ("onClick",function(){e.CHM(i);const a=e.oxw(),l=a.index,c=a.$implicit,v=e.oxw();return e.KtG(v.edit(l,c))}),e.qZA()}}function X(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"dx-button",11),e.NdJ("onClick",function(){e.CHM(i);const a=e.oxw(),l=a.index,c=a.$implicit,v=e.oxw();return e.KtG(v.remove(l,c))}),e.qZA()}}function W(t,s){if(1&t&&(e.TgZ(0,"div",6)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",7),e.YNc(4,z,1,0,"dx-button",8)(5,X,1,0,"dx-button",9),e.qZA()()),2&t){const i=s.$implicit,n=e.oxw();e.xp6(2),e.hij(" ",n.formatExpectedEndTime(i.pushTime)," "),e.xp6(2),e.Q6J("ngIf",!i.id),e.xp6(),e.Q6J("ngIf",!1!==i.isDeletable)}}const ie=()=>({class:"basic-data-grid-button basic-data-grid-button--add"});let te=(()=>{class t{constructor(){this.isCreatePushTimeVisible=!1,this.notificationSchedulePlans=[],this.currentSelectedPlanIndex=null,this.pushTime=(new Date).toISOString(),this.formatExpectedEndTime=g.m}ngOnInit(){this.notificationSchedulePlans=(0,T.cloneDeep)(this.cellInfo.value||[])}createPushTime(){this.isCreatePushTimeVisible=!0}selectPushTime(i){null!==this.currentSelectedPlanIndex?this.notificationSchedulePlans[this.currentSelectedPlanIndex].pushTime=i:this.notificationSchedulePlans.push({pushTime:i}),this.cellInfo.setValue((0,T.cloneDeep)(this.notificationSchedulePlans)),this.pushTime=(new Date).toISOString(),this.currentSelectedPlanIndex=null}edit(i,n){this.isCreatePushTimeVisible=!0,this.currentSelectedPlanIndex=i,this.pushTime=n.pushTime}remove(i){this.notificationSchedulePlans.splice(i,1),this.cellInfo.setValue((0,T.cloneDeep)(this.notificationSchedulePlans))}trackBy(i){return i}static#e=this.\u0275fac=function(n){return new(n||t)};static#i=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-notification-schedule-plans"]],inputs:{cellInfo:"cellInfo"},decls:10,vars:8,consts:[[1,"cron"],["type","normal","stylingMode","outlined",3,"focusStateEnabled","activeStateEnabled","elementAttr","onClick"],[1,"cron__list"],[1,"cron__listRow","cron__listRow--caption"],["class","cron__listRow cron__listRow--item",4,"ngFor","ngForOf","ngForTrackBy"],[3,"isCreatePushTimeVisible","pushTime","isCreatePushTimeVisibleChange","selectPushTime"],[1,"cron__listRow","cron__listRow--item"],[1,"cron__listRow__buttons"],["appGridEditButton","",3,"onClick",4,"ngIf"],["appGridDeleteButton","",3,"onClick",4,"ngIf"],["appGridEditButton","",3,"onClick"],["appGridDeleteButton","",3,"onClick"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0)(1,"div")(2,"dx-button",1),e.NdJ("onClick",function(){return a.createPushTime()}),e.qZA()(),e.TgZ(3,"div",2)(4,"div",3)(5,"div"),e._uU(6,"\u9810\u8a08\u63a8\u9001\u6642\u9593"),e.qZA(),e._UZ(7,"div"),e.qZA(),e.YNc(8,W,6,3,"div",4),e.qZA()(),e.TgZ(9,"app-notification-schedule-plan-create-push-time",5),e.NdJ("isCreatePushTimeVisibleChange",function(c){return a.isCreatePushTimeVisible=c})("selectPushTime",function(c){return a.selectPushTime(c)}),e.qZA()),2&n&&(e.xp6(2),e.Q6J("focusStateEnabled",!1)("activeStateEnabled",!1)("elementAttr",e.DdM(7,ie)),e.xp6(6),e.Q6J("ngForOf",a.notificationSchedulePlans)("ngForTrackBy",a.trackBy),e.xp6(),e.Q6J("isCreatePushTimeVisible",a.isCreatePushTimeVisible)("pushTime",a.pushTime))},dependencies:[r.sg,r.O5,f.K,B.R,K.o,q],styles:[".cron[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.cron__listRow[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.cron__listRow--caption[_ngcontent-%COMP%]{margin-bottom:16px}.cron__listRow--caption[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{color:var(--gray-2);flex:1}.cron__listRow--item[_ngcontent-%COMP%]{padding:10px 0 6px;border-bottom:1px solid var(--gray-3)}.cron__listRow--item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1}.cron__listRow__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:2px}"]})}return t})();const ne=[{type:"buttons",fixed:!0},{name:"pushTime",caption:"\u9810\u8a08\u63a8\u9001\u6642\u9593",dataType:"string",filterOperations:p.I.text,validationRules:[d.L]},{dataField:"isParsed",caption:"\u662f\u5426\u5df2\u89e3\u6790",dataType:"boolean"},{dataField:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean"}],ae=[],oe=[{name:"pushTime",mapping:["pushTime"]},{dataField:"isParsed",mapping:["isParsed"]},{dataField:"isFinished",mapping:["isFinished"]}];var se=o(53009);const le=["grid"];function ce(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"div")(1,"dx-button",5),e.NdJ("onClick",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.closePopup())}),e.qZA()()}}const pe=()=>({toolbar:"bottom",template:"bottom-toolbar",location:"after"}),re=t=>[t];let de=(()=>{class t{constructor(i,n){this.templateStore=i,this.appRestService=n,this.notificationId="",this.isDetailsTableVisible=!1,this.isDetailsTableVisibleChange=new e.vpe,this.columns=ne,this.dataFieldLookupSourceMapping=ae,this.relatedDataValueAndQueryStringKeyMapping=oe,this.gridProperties={editing:{allowDeleting:!1,allowUpdating:!1},pager:{visible:!1},filterRow:{visible:!1}},this.gridDataSource=[]}ngOnChanges(){this.loadPlanDetails()}loadPlanDetails(){this.isDetailsTableVisible&&this.notificationId&&this.appRestService.request({method:"GET",url:`/api/app/reserve-notification-infos/notification-schedule-plans/${this.notificationId}`}).subscribe(i=>{this.gridDataSource=[...i],this.gridDataSource.forEach(n=>n.pushTime=(0,g.m)(n.pushTime))})}closePopup(){this.isDetailsTableVisibleChange.emit(!1)}static#e=this.\u0275fac=function(n){return new(n||t)(e.Y36(S.z),e.Y36(se.$))};static#i=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-notification-schedule-plan-details"]],viewQuery:function(n,a){if(1&n&&e.Gf(le,5),2&n){let l;e.iGM(l=e.CRH())&&(a.grid=l.first)}},inputs:{notificationId:"notificationId",isDetailsTableVisible:"isDetailsTableVisible"},outputs:{isDetailsTableVisibleChange:"isDetailsTableVisibleChange"},features:[e.TTD],decls:6,vars:11,consts:[["title","\u6642\u9593\u8a08\u756b\u7d30\u7bc0",3,"visible","toolbarItems","visibleChange"],["appGridFeature","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","columns","dataSource","gridProperties"],["grid",""],["name","applyFilterButton","cssClass","d-none"],[4,"dxTemplate","dxTemplateOf"],["type","primary","text","\u95dc\u9589",3,"onClick"]],template:function(n,a){1&n&&(e.TgZ(0,"dx-popup",0),e.NdJ("visibleChange",function(c){return a.isDetailsTableVisible=c}),e.TgZ(1,"dx-data-grid",1,2)(3,"dxo-toolbar"),e._UZ(4,"dxi-item",3),e.qZA()(),e.YNc(5,ce,2,0,"div",4),e.qZA()),2&n&&(e.Q6J("visible",a.isDetailsTableVisible)("toolbarItems",e.VKq(9,re,e.DdM(8,pe))),e.xp6(),e.Q6J("datafieldValueQueryStringKeyMapping",a.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",a.dataFieldLookupSourceMapping)("columns",a.columns)("dataSource",a.gridDataSource)("gridProperties",a.gridProperties),e.xp6(4),e.Q6J("dxTemplateOf","bottom-toolbar"))},dependencies:[f.K,_.p6,u.ZT3,V.x,I.e,u.y1f,N._],encapsulation:2})}return t})();const fe=["grid"];function ue(t,s){if(1&t&&e._UZ(0,"app-grid-after-tool-bar",13),2&t){e.oxw();const i=e.MAs(1);e.Q6J("grid",i)}}function me(t,s){1&t&&e.GkF(0)}const ge=t=>({$implicit:t});function he(t,s){if(1&t&&(e.ynx(0),e.YNc(1,me,1,0,"ng-container",15),e.BQk()),2&t){const i=s.$implicit,n=e.oxw().$implicit,a=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",a.templateStore.getGridTemplates(n.key))("ngTemplateOutletContext",e.VKq(2,ge,i))}}function _e(t,s){if(1&t&&(e.ynx(0),e.YNc(1,he,2,4,"ng-container",14),e.BQk()),2&t){const i=s.$implicit;e.xp6(),e.Q6J("dxTemplateOf",i.key)}}function Te(t,s){1&t&&e._UZ(0,"app-notification-tag-box",16),2&t&&e.Q6J("cellInfo",s.$implicit)}function ve(t,s){1&t&&e._UZ(0,"app-notification-radio-button",16),2&t&&e.Q6J("cellInfo",s.$implicit)}function be(t,s){if(1&t&&e._UZ(0,"app-notification-tag-box",17),2&t){const i=s.$implicit,n=e.oxw();e.Q6J("cellInfo",i)("hidden",n.isForAllReceivers)}}function xe(t,s){if(1&t&&e._UZ(0,"app-receiver-group-tree-view",18),2&t){const i=s.$implicit,n=e.oxw();e.Q6J("cellInfo",i)("tenantId",n.tenantId)("hidden",n.isForAllReceivers)}}function Ce(t,s){1&t&&e._UZ(0,"app-notification-radio-button",16),2&t&&e.Q6J("cellInfo",s.$implicit)}function ye(t,s){if(1&t&&e._UZ(0,"app-notification-setting-items",17),2&t){const i=s.$implicit,n=e.oxw();e.Q6J("cellInfo",i)("hidden",!n.isUsingSpecificNotificationSettings)}}function Se(t,s){1&t&&e._UZ(0,"app-notification-schedule-plans",16),2&t&&e.Q6J("cellInfo",s.$implicit)}function Ie(t,s){1&t&&e._UZ(0,"app-notification-radio-button",16),2&t&&e.Q6J("cellInfo",s.$implicit)}function Ne(t,s){if(1&t&&e._UZ(0,"app-notification-template-args",19),2&t){const i=s.$implicit,n=e.oxw();e.Q6J("cellInfo",i)("notificationTemplateId",n.notificationTemplateId)}}function Fe(t,s){if(1&t){const i=e.EpF();e.TgZ(0,"dx-button",20),e.NdJ("click",function(){const l=e.CHM(i).$implicit,c=e.oxw();return e.KtG(c.openDetailsTable(l.data.id))}),e.qZA()}}const Pe=()=>({type:"default",stylingMode:"contained"}),Re=[{path:"",component:(()=>{class t{constructor(i,n,a){this.gridDataSourceService=i,this.templateStore=n,this.configStateService=a,this.columns=U,this.cRUDEndpoints=C,this.dataFieldLookupSourceMapping=w,this.relatedDataValueAndQueryStringKeyMapping=y,this.editingPropertiesForCreating=Z,this.editingPropertiesForUpdating=J,this.isForAllReceivers=!0,this.isUsingSpecificNotificationSettings=!1,this.isUsingTemplate=!1,this.tenantId="",this.notificationTemplateId="",this.isDetailsTableVisible=!1,this.notificationId=""}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(C,y),this.configStateService.getOne$("currentUser").subscribe(i=>{this.tenantId=i.tenantId})}onInitNewRow(i){i.data.tenantId=this.tenantId,i.data.isForAllReceivers=!0,i.data.isUsingSpecificNotificationSettings=!1,i.data.isFetchNotificationDataByEachReceiver=!1,i.data.receiverIds=[],i.data.receiverGroupIds=[]}onRowValidating(i){this.validateIsForAllReceivers(i)}onOptionChanged(i){"editing.changes"!==i.fullName&&"editing.editRowKey"!==i.fullName||"object"!=typeof i.value||!i.value||Array.isArray(i.value)&&0===i.value.length||(this.checkIsForAllReceivers(i),this.checkIsUsingSpecificNotificationSettings(i),this.checkIsUsingTemplate(i),this.checkNotificationTemplateId(i))}checkIsForAllReceivers(i){"editing.changes"===i.fullName&&!("isForAllReceivers"in i.value[0].data)||"editing.editRowKey"===i.fullName&&!("isForAllReceivers"in i.value)||"editing.changes"===i.fullName&&this.isForAllReceivers===i.value[0].data.isForAllReceivers||"editing.editRowKey"===i.fullName&&this.isForAllReceivers===i.value.isForAllReceivers||(this.isForAllReceivers="editing.changes"===i.fullName?i.value[0].data.isForAllReceivers:i.value.isForAllReceivers)}checkIsUsingSpecificNotificationSettings(i){"editing.changes"===i.fullName&&!("isUsingSpecificNotificationSettings"in i.value[0].data)||"editing.editRowKey"===i.fullName&&!("isUsingSpecificNotificationSettings"in i.value)||"editing.changes"===i.fullName&&this.isUsingSpecificNotificationSettings===i.value[0].data.isUsingSpecificNotificationSettings||"editing.editRowKey"===i.fullName&&this.isUsingSpecificNotificationSettings===i.value.isUsingSpecificNotificationSettings||(this.isUsingSpecificNotificationSettings="editing.changes"===i.fullName?i.value[0].data.isUsingSpecificNotificationSettings:i.value.isUsingSpecificNotificationSettings)}checkIsUsingTemplate(i){"editing.changes"===i.fullName&&!("isUsingTemplate"in i.value[0].data)||"editing.editRowKey"===i.fullName&&!("isUsingTemplate"in i.value)||(this.isUsingTemplate="editing.changes"===i.fullName?i.value[0].data.isUsingTemplate:i.value.isUsingTemplate,setTimeout(()=>{this.isUsingTemplate?(document.querySelector(".NotificationTemplateGroup").classList.remove("NotificationTemplateGroup--inactive"),document.querySelector(".NotificationContentGroup").classList.add("NotificationContentGroup--inactive")):(document.querySelector(".NotificationTemplateGroup").classList.add("NotificationTemplateGroup--inactive"),document.querySelector(".NotificationContentGroup").classList.remove("NotificationContentGroup--inactive"))}))}checkNotificationTemplateId(i){"editing.changes"===i.fullName&&!("notificationTemplateId"in i.value[0].data)||"editing.editRowKey"===i.fullName&&!("notificationTemplateId"in i.value)||"editing.changes"===i.fullName&&this.notificationTemplateId===i.value[0].data.notificationTemplateId||"editing.editRowKey"===i.fullName&&this.notificationTemplateId===i.value.notificationTemplateId||(this.notificationTemplateId="editing.changes"===i.fullName?i.value[0].data.notificationTemplateId:i.value.notificationTemplateId)}validateIsForAllReceivers(i){!i.newData.isForAllReceivers||(i.newData.receiverIds=[],i.newData.receiverGroupIds=[],!i.brokenRules.find(a=>"custom"===a.type&&"receiverTagBoxValidationCallback"===a.validationCallback.name)||1!==i.brokenRules.length)||(i.isValid=!0)}resetOption(){this.isForAllReceivers=!0,this.isUsingSpecificNotificationSettings=!1}openDetailsTable(i){this.isDetailsTableVisible=!0,this.notificationId=i}static#e=this.\u0275fac=function(n){return new(n||t)(e.Y36(M.I),e.Y36(S.z),e.Y36(m.XJE))};static#i=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-instant-notification"]],viewQuery:function(n,a){if(1&n&&e.Gf(fe,5),2&n){let l;e.iGM(l=e.CRH())&&(a.grid=l.first)}},decls:20,vars:24,consts:[["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","onEditCanceled","onRowInserted","onInitNewRow","onOptionChanged","onRowValidating"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hidden",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","tenantId","hidden",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","notificationTemplateId",4,"dxTemplate","dxTemplateOf"],["appGridViewButton","",3,"click",4,"dxTemplate","dxTemplateOf"],[3,"isDetailsTableVisible","notificationId","isDetailsTableVisibleChange"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"cellInfo"],[3,"cellInfo","hidden"],[3,"cellInfo","tenantId","hidden"],[3,"cellInfo","notificationTemplateId"],["appGridViewButton","",3,"click"]],template:function(n,a){1&n&&(e.TgZ(0,"dx-data-grid",0,1),e.NdJ("onEditCanceled",function(){return a.resetOption()})("onRowInserted",function(){return a.resetOption()})("onInitNewRow",function(c){return a.onInitNewRow(c)})("onOptionChanged",function(c){return a.onOptionChanged(c)})("onRowValidating",function(c){return a.onRowValidating(c)}),e.TgZ(2,"dxo-toolbar"),e._UZ(3,"dxi-item",2),e.TgZ(4,"dxi-item",3),e.YNc(5,ue,1,1,"app-grid-after-tool-bar",4),e.qZA(),e._UZ(6,"dxi-item",5),e.qZA(),e.YNc(7,_e,2,1,"ng-container",6),e.ALo(8,"keyvalue"),e.YNc(9,Te,1,1,"app-notification-tag-box",7)(10,ve,1,1,"app-notification-radio-button",7)(11,be,1,2,"app-notification-tag-box",8)(12,xe,1,3,"app-receiver-group-tree-view",9)(13,Ce,1,1,"app-notification-radio-button",7)(14,ye,1,2,"app-notification-setting-items",8)(15,Se,1,1,"app-notification-schedule-plans",7)(16,Ie,1,1,"app-notification-radio-button",7)(17,Ne,1,2,"app-notification-template-args",10)(18,Fe,1,0,"dx-button",11),e.qZA(),e.TgZ(19,"app-notification-schedule-plan-details",12),e.NdJ("isDetailsTableVisibleChange",function(c){return a.isDetailsTableVisible=c}),e.qZA()),2&n&&(e.Q6J("datafieldValueQueryStringKeyMapping",a.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",a.dataFieldLookupSourceMapping)("editingPropertiesForCreating",a.editingPropertiesForCreating)("editingPropertiesForUpdating",a.editingPropertiesForUpdating)("columns",a.columns)("dataSource",a.gridDataSource)("isEditingDataAsync",!0),e.xp6(3),e.Q6J("options",e.DdM(23,Pe)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(8,21,a.templateStore.gridTemplates)),e.xp6(2),e.Q6J("dxTemplateOf","notificationProviders"),e.xp6(),e.Q6J("dxTemplateOf","isForAllReceivers"),e.xp6(),e.Q6J("dxTemplateOf","receiverIds"),e.xp6(),e.Q6J("dxTemplateOf","receiverGroupIds"),e.xp6(),e.Q6J("dxTemplateOf","isUsingSpecificNotificationSettings"),e.xp6(),e.Q6J("dxTemplateOf","notificationSettingItems"),e.xp6(),e.Q6J("dxTemplateOf","notificationSchedulePlans"),e.xp6(),e.Q6J("dxTemplateOf","isUsingTemplate"),e.xp6(),e.Q6J("dxTemplateOf","notificationTemplateArgs"),e.xp6(),e.Q6J("dxTemplateOf","grid-details-button"),e.xp6(),e.Q6J("isDetailsTableVisible",a.isDetailsTableVisible)("notificationId",a.notificationId))},dependencies:[r.sg,r.tP,f.K,_.p6,u.ZT3,I.e,u.y1f,Q.p,N._,G.f,E.V,F.h,P.b,R.D,D.d,A.E,te,de,r.Nd],encapsulation:2})}return t})(),canActivate:[m.a1M,m.nG9]}];let De=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#i=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[x.Bz.forChild(Re),x.Bz]})}return t})();var Ae=o(5533),Ve=o(68862);let Oe=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#i=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[r.ez,De,Ae.P,Ve.O,O.m,F.h,P.b,R.D,D.d,A.E]})}return t})()}}]);