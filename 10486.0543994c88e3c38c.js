"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[10486],{10486:(E,y,n)=>{n.r(y),n.d(y,{InstantNotificationInfosModule:()=>it});var u=n(96814),m=n(66648),T=n(88762),v=n(23758),t=n(35461),x=n(85054);const I=[{type:"buttons",fixed:!0,buttons:[{name:"edit",template:"grid-view-button"},{name:"delete",template:"grid-delete-button"}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:t.I.text,validationRules:[x.L]},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:t.I.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:t.I.text},{name:"notificationProviderNames",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:t.I.text},{dataField:"pushTime",caption:"\u63a8\u9001\u6642\u9593",dataType:"datetime",filterOperations:t.I.date,format:"yyyy/MM/dd HH:mm:ss"},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:t.I.text},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:t.I.text},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:t.I.text},{dataField:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean"},{dataField:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean"},{dataField:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean"},{dataField:"notificationProviderDefinitionIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u591a\u7b46)",dataType:"object",visible:!1,editCellTemplate:"notification-provider-definition"},{dataField:"isForAllReceivers",caption:"\u662f\u5426\u50b3\u9001\u7d66\u6240\u6709\u63a5\u6536\u8005",dataType:"boolean",visible:!1},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u591a\u7b46)",dataType:"object",visible:!1,editCellTemplate:"receivers-tag-box"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u591a\u7b46)",dataType:"object",visible:!1,editCellTemplate:"receiver-groups-tag-box"},{dataField:"notificationSettingRadioGroup",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"object",visible:!1,editCellTemplate:"notification-setting-radio-group"},{dataField:"notificationSettingItems",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notification-setting-items"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[x.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1}],h={index:"/api/app/instant-notification-infos",get:"/api/app/instant-notification-infos",create:"/api/app/instant-notification-infos",update:"/api/app/instant-notification-infos",delete:"/api/app/instant-notification-infos"},C=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"}],g=[{dataField:"id",mapping:["id"]},{dataField:"concurrencyStamp",mapping:["concurrencyStamp"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenantName"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategoryName"]},{name:"notificationProviderNames",queryStringKey:"NotificationProviderNames",mapping:["notificationProviderNames"]},{name:"pushTime",queryStringKey:"PushTime",mapping:["pushTime"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{name:"isFinished",queryStringKey:"IsFinished",mapping:["isFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"tenantId",mapping:["tenantId"]},{dataField:"notificationProviderDefinitionIds",mapping:["notificationProviderDefinitionIds"]},{dataField:"isForAllReceivers",mapping:["isForAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"notificationSettingItems",mapping:["notificationSettingItems"]},{dataField:"notificationCategoryId",mapping:["notificationCategoryId"]},{dataField:"title",queryStringKey:"Title",mapping:["title"]},{dataField:"subtitle",mapping:["subtitle"]},{dataField:"textContent",mapping:["textContent"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationDataFetchEndpoint"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["isFetchNotificationDataByEachReceiver"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["hookEndpoint"]},{dataField:"htmlContent",mapping:["htmlContent"]},{dataField:"notificationSchedulePlans",mapping:["notificationSchedulePlans"]}],p={imageUpload:{fileUploadMode:"both",tabs:["url","file"]},toolbar:{items:[{name:"undo"},{name:"redo"},{name:"separator"},{name:"size",acceptedValues:["8pt","10pt","12pt","14pt","18pt","24pt","36pt"]},{name:"font",acceptedValues:["Arial","Georgia","Tahoma","Times New Roman","Verdana"]},{name:"separator"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"underline"},{name:"separator"},{name:"alignLeft"},{name:"alignCenter"},{name:"alignRight"},{name:"alignJustify"},{name:"separator"},{name:"orderedList"},{name:"bulletList"},{name:"separator"},{name:"header",acceptedValues:[!1,1,2,3,4,5]},{name:"separator"},{name:"color"},{name:"background"},{name:"separator"},{name:"link"},{name:"image"},{name:"separator"},{name:"clear"},{name:"codeBlock"},{name:"blockquote"},{name:"separator"},{name:"insertTable"},{name:"deleteTable"},{name:"insertRowAbove"},{name:"insertRowBelow"},{name:"deleteRow"},{name:"insertColumnLeft"},{name:"insertColumnRight"},{name:"deleteColumn"},{name:"cellProperties"},{name:"tableProperties"}]}},r=[{itemType:"group",name:"basicGroup",caption:"\u57fa\u672c",colCount:2,items:[{dataField:"notificationProviderDefinitionIds"},{itemType:"group",name:"receiverGroup",colCount:2,items:[{dataField:"isForAllReceivers",editorType:"dxCheckBox"},{itemType:"empty"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]}]},{itemType:"group",name:"notificationSettingGroup",caption:"\u8a2d\u5b9a",colCount:2,items:[{dataField:"notificationSettingRadioGroup",label:{visible:!1}},{dataField:"notificationSettingItems",label:{visible:!1}}]},{itemType:"group",name:"notificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{dataField:"title",editorType:"dxTextBox"},{itemType:"group",name:"textboxGroup",items:[{dataField:"subtitle",editorType:"dxTextBox"},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"}]},{itemType:"group",name:"textareaGroup",items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"100px"}},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox"}]},{dataField:"htmlContent",colSpan:2,editorType:"dxHtmlEditor",editorOptions:{...p,height:"250px"}}]}],o=[{itemType:"group",name:"basicGroup",caption:"\u57fa\u672c",colCount:2,items:[{dataField:"notificationProviderDefinitionIds"},{itemType:"group",name:"receiverGroup",colCount:2,items:[{dataField:"isForAllReceivers",editorType:"dxCheckBox",editorOptions:{disabled:!0}},{itemType:"empty"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]}]},{itemType:"group",name:"notificationSettingGroup",caption:"\u8a2d\u5b9a",colCount:2,items:[{dataField:"notificationSettingRadioGroup",label:{visible:!1}},{dataField:"notificationSettingItems",label:{visible:!1}}]},{itemType:"group",name:"notificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"notificationCategoryId",editorType:"dxSelectBox",editorOptions:{disabled:!0}},{dataField:"title",editorType:"dxTextBox",editorOptions:{disabled:!0}},{itemType:"group",name:"textboxGroup",items:[{dataField:"subtitle",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}},{dataField:"hookEndpoint",editorType:"dxTextBox",editorOptions:{disabled:!0}}]},{itemType:"group",name:"textareaGroup",items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"100px",disabled:!0}},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",editorOptions:{disabled:!0}}]},{dataField:"htmlContent",colSpan:2,editorType:"dxHtmlEditor",editorOptions:{...p,height:"250px",disabled:!0}}]}],l={form:{colCount:1,items:r}},c={form:{colCount:1,items:o},popup:{wrapperAttr:{class:"instant-notification-infos-view"},toolbarItems:[]}};var i=n(19212),F=n(67),b=n(72783),V=n(53009),A=n(20843),R=n(2173),w=n(25012),B=n(43821),U=n(10313),N=n(46203),M=n(38653),P=n(36744),O=n(90962);const G=["grid"];function K(a,_){if(1&a&&i._UZ(0,"app-grid-general-filter",10),2&a){i.oxw();const e=i.MAs(1);i.Q6J("grid",e)}}function J(a,_){1&a&&i.GkF(0)}const Z=a=>({$implicit:a});function L(a,_){if(1&a&&(i.ynx(0),i.YNc(1,J,1,0,"ng-container",12),i.BQk()),2&a){const e=_.$implicit,s=i.oxw().$implicit,d=i.oxw();i.xp6(),i.Q6J("ngTemplateOutlet",d.templateStore.getGridTemplates(s.key))("ngTemplateOutletContext",i.VKq(2,Z,e))}}function Q(a,_){if(1&a&&(i.ynx(0),i.YNc(1,L,2,4,"ng-container",11),i.BQk()),2&a){const e=_.$implicit;i.xp6(),i.Q6J("dxTemplateOf",e.key)}}function k(a,_){if(1&a&&i._UZ(0,"app-notification-provider-definitions",13),2&a){const e=_.$implicit,s=i.oxw();i.Q6J("cellInfo",e)("isViewMode",s.isViewMode)}}function $(a,_){if(1&a&&i._UZ(0,"app-receiver-tag-box",14),2&a){const e=_.$implicit,s=i.oxw();i.Q6J("isForAllReceivers",s.isForAllReceivers)("cellInfo",e)("isViewMode",s.isViewMode)}}function W(a,_){if(1&a&&i._UZ(0,"app-receiver-tag-box",14),2&a){const e=_.$implicit,s=i.oxw();i.Q6J("isForAllReceivers",s.isForAllReceivers)("cellInfo",e)("isViewMode",s.isViewMode)}}function j(a,_){if(1&a&&i._UZ(0,"app-notification-setting-items-radio-group",13),2&a){const e=_.$implicit,s=i.oxw();i.Q6J("cellInfo",e)("isViewMode",s.isViewMode)}}function Y(a,_){if(1&a&&i._UZ(0,"app-notification-setting-items",15),2&a){const e=_.$implicit,s=i.oxw();i.Q6J("isUseCustomSetting",s.isUseCustomSetting)("cellInfo",e)("isViewMode",s.isViewMode)}}const H=()=>({type:"default",stylingMode:"contained"}),z=[{path:"",component:(()=>{class a{constructor(e,s,d,S){this.gridDataSourceService=e,this.templateStore=s,this.configStateService=d,this.appRestService=S,this.columns=I,this.cRUDEndpoints=h,this.dataFieldLookupSourceMapping=C,this.relatedDataValueAndQueryStringKeyMapping=g,this.editingPropertiesForCreating=l,this.editingPropertiesForUpdating=c,this.isViewMode=!1,this.isForAllReceivers=!1,this.isUseCustomSetting=!1,this.tenantId="",this.editingPropertiesForUpdating.popup.toolbarItems=[{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:"\u78ba\u8a8d",onClick:()=>{this.grid.instance.cancelEditData()}}}]}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(h,g),this.configStateService.getOne$("currentUser").subscribe(e=>{this.tenantId=e.tenantId})}onInitNewRow(e){e.component.instance().resetOption("editing.popup"),e.data.tenantId=this.tenantId,e.data.isFetchNotificationDataByEachReceiver=!1,e.data.isForAllReceivers=!1}onEditingStart(e){this.isViewMode=!0,this.appRestService.request({method:"GET",url:`/api/app/instant-notification-infos/${e.data.id}`}).subscribe(s=>{const d=e.component.instance().getRowIndexByKey(e.key);e.component.instance().cellValue(d,"notificationProviderDefinitionIds",s.notificationProviderDefinitionIds),e.component.instance().cellValue(d,"isForAllReceivers",s.isForAllReceivers),e.component.instance().cellValue(d,"receiverIds",s.receiverIds),e.component.instance().cellValue(d,"notificationCategoryId",s.notificationCategoryId),e.component.instance().cellValue(d,"subtitle",s.subtitle),e.component.instance().cellValue(d,"textContent",s.textContent),e.component.instance().cellValue(d,"isFetchNotificationDataByEachReceiver",s.isFetchNotificationDataByEachReceiver),e.component.instance().cellValue(d,"htmlContent",s.htmlContent),e.component.instance().cellValue(d,"hookEndpoint",s.hookEndpoint),e.component.instance().cellValue(d,"notificationDataFetchEndpoint",s.notificationDataFetchEndpoint),s.notificationSettingItems?.length>0&&(this.isUseCustomSetting=!0,e.component.instance().cellValue(d,"notificationSettingItems",s.notificationSettingItems))})}onOptionChanged(e){"editing.changes"!==e.fullName||!e.value[0]||!e.value[0].data||(this.checkIsForAllReceivers(e),this.checkIsUseCustomSetting(e))}onRowValidating(e){this.validateIsForAllReceivers(e)}checkIsForAllReceivers(e){"isForAllReceivers"in e.value[0].data&&this.isForAllReceivers!==e.value[0].data.isForAllReceivers&&(this.isForAllReceivers=e.value[0].data.isForAllReceivers)}checkIsUseCustomSetting(e){e.value[0].data.notificationSettingRadioGroup&&(this.isUseCustomSetting&&"custom"===e.value[0].data.notificationSettingRadioGroup||(this.isUseCustomSetting="custom"===e.value[0].data.notificationSettingRadioGroup))}validateIsForAllReceivers(e){e.newData.isForAllReceivers&&(e.isValid=!0,e.newData.receiverIds=[],e.newData.receiverGroupIds=[])}resetOption(){this.isForAllReceivers=!1,this.isUseCustomSetting=!1,this.isViewMode=!1}static#t=this.\u0275fac=function(s){return new(s||a)(i.Y36(F.I),i.Y36(b.z),i.Y36(T.XJE),i.Y36(V.$))};static#i=this.\u0275cmp=i.Xpm({type:a,selectors:[["app-instant-notification"]],viewQuery:function(s,d){if(1&s&&i.Gf(G,5),2&s){let S;i.iGM(S=i.CRH())&&(d.grid=S.first)}},decls:14,vars:16,consts:[["appGridFeature","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","onEditCanceled","onRowInserted","onInitNewRow","onEditingStart","onOptionChanged","onRowValidating"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo","isViewMode",4,"dxTemplate","dxTemplateOf"],[3,"isForAllReceivers","cellInfo","isViewMode",4,"dxTemplate","dxTemplateOf"],[3,"isUseCustomSetting","cellInfo","isViewMode",4,"dxTemplate","dxTemplateOf"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"cellInfo","isViewMode"],[3,"isForAllReceivers","cellInfo","isViewMode"],[3,"isUseCustomSetting","cellInfo","isViewMode"]],template:function(s,d){1&s&&(i.TgZ(0,"dx-data-grid",0,1),i.NdJ("onEditCanceled",function(){return d.resetOption()})("onRowInserted",function(){return d.resetOption()})("onInitNewRow",function(D){return d.onInitNewRow(D)})("onEditingStart",function(D){return d.onEditingStart(D)})("onOptionChanged",function(D){return d.onOptionChanged(D)})("onRowValidating",function(D){return d.onRowValidating(D)}),i.TgZ(2,"dxo-toolbar"),i._UZ(3,"dxi-item",2),i.TgZ(4,"dxi-item",3),i.YNc(5,K,1,1,"app-grid-general-filter",4),i.qZA(),i._UZ(6,"dxi-item",5),i.qZA(),i.YNc(7,Q,2,1,"ng-container",6),i.ALo(8,"keyvalue"),i.YNc(9,k,1,2,"app-notification-provider-definitions",7)(10,$,1,3,"app-receiver-tag-box",8)(11,W,1,3,"app-receiver-tag-box",8)(12,j,1,2,"app-notification-setting-items-radio-group",7)(13,Y,1,3,"app-notification-setting-items",9),i.qZA()),2&s&&(i.Q6J("datafieldValueQueryStringKeyMapping",d.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",d.dataFieldLookupSourceMapping)("editingPropertiesForCreating",d.editingPropertiesForCreating)("editingPropertiesForUpdating",d.editingPropertiesForUpdating)("columns",d.columns)("dataSource",d.gridDataSource),i.xp6(3),i.Q6J("options",i.DdM(15,H)),i.xp6(4),i.Q6J("ngForOf",i.lcZ(8,13,d.templateStore.gridTemplates)),i.xp6(2),i.Q6J("dxTemplateOf","notification-provider-definition"),i.xp6(),i.Q6J("dxTemplateOf","receivers-tag-box"),i.xp6(),i.Q6J("dxTemplateOf","receiver-groups-tag-box"),i.xp6(),i.Q6J("dxTemplateOf","notification-setting-radio-group"),i.xp6(),i.Q6J("dxTemplateOf","notification-setting-items"))},dependencies:[u.sg,u.tP,A.p6,R.ZT3,w.e,R.y1f,B._,U.w,N.J,M.k,P.b,O.b,u.Nd],styles:[".instant-notification-infos-view .dx-state-disabled.dx-widget{opacity:1}  .instant-notification-infos-view .dx-checkbox.dx-checkbox-checked.dx-state-disabled .dx-checkbox-icon{background-color:#03a9f4}  .instant-notification-infos-view .dx-state-readonly .dx-item-selected .dx-radiobutton-icon{border-color:#03a9f4}  .instant-notification-infos-view .dx-state-readonly .dx-item-selected .dx-radiobutton-icon-dot{background-color:#03a9f4}  .instant-notification-infos-view .dx-radiobutton.dx-state-active .dx-radiobutton-icon-checked:after,   .instant-notification-infos-view .dx-radiobutton.dx-state-focused .dx-radiobutton-icon-checked:after{background-color:initial;transform:scale(0)}  .instant-notification-infos-view .dx-radiobutton.dx-state-hover{cursor:default}  .instant-notification-infos-view .dx-texteditor.dx-editor-filled.dx-state-disabled .dx-texteditor-input{color:inherit}"]})}return a})(),canActivate:[T.a1M,T.nG9]}];let X=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#i=this.\u0275mod=i.oAB({type:a});static#e=this.\u0275inj=i.cJS({imports:[v.Bz.forChild(z),v.Bz]})}return a})();var q=n(77490),tt=n(68862);let it=(()=>{class a{static#t=this.\u0275fac=function(s){return new(s||a)};static#i=this.\u0275mod=i.oAB({type:a});static#e=this.\u0275inj=i.cJS({imports:[u.ez,X,q.P,tt.O,m.m,N.J,M.k,P.b,O.b]})}return a})()},46203:(E,y,n)=>{n.d(y,{J:()=>C});var u=n(21137),m=n(6990),v=n(88762),t=n(19212),x=n(53009);const I=(g,p)=>p.id;function h(g,p){if(1&g){const r=t.EpF();t.TgZ(0,"div",1)(1,"dx-check-box",2),t.NdJ("click",function(f){const c=t.CHM(r).$implicit,i=t.oxw();return t.KtG(i.checkIsOnlyOneNotificationProviderDefinitionIdSelected(f,c.id))})("onValueChanged",function(f){const c=t.CHM(r).$implicit,i=t.oxw();return t.KtG(i.onValueChanged(f,c.id))}),t.qZA()()}if(2&g){const r=p.$implicit,o=t.oxw();t.xp6(),t.Q6J("text",r.name)("value",o.checkIsNotificationProviderDefinitionIdSelected(r.id))("disabled",o.isViewMode)}}let C=(()=>{class g{constructor(r){this.appRestService=r,this.isViewMode=!1,this.notificationProviderDefinitions=[],this.notificationProviderDefinitionIds=[]}ngOnInit(){this.fetchNotificationProviderDefinitions()}onValueChanged(r,o){this.updateNotificationProviderDefinitionIds(r.value,o)}fetchNotificationProviderDefinitions(){this.appRestService.request({method:"GET",url:"/api/app/notification-infos/assignable-notification-provider-definitions"}).subscribe(r=>{r.items.forEach(o=>{this.notificationProviderDefinitions.push((0,m.cloneDeep)(o))}),this.fillUpNotificationProviderDefinitionIds()})}fillUpNotificationProviderDefinitionIds(){this.cellInfo.value&&0!==this.cellInfo.value.length?this.notificationProviderDefinitionIds=[...this.cellInfo.value]:this.initNotificationProviderDefinitionIds(),this.cellInfo.setValue((0,m.cloneDeep)(this.notificationProviderDefinitionIds))}initNotificationProviderDefinitionIds(){this.notificationProviderDefinitionIds.push(this.notificationProviderDefinitions[0].id)}checkIsNotificationProviderDefinitionIdSelected(r){return this.notificationProviderDefinitionIds.includes(r)}checkIsOnlyOneNotificationProviderDefinitionIdSelected(r,o){1===this.notificationProviderDefinitionIds.length&&this.checkIsNotificationProviderDefinitionIdSelected(o)&&r.stopImmediatePropagation()}updateNotificationProviderDefinitionIds(r,o){const f=this.notificationProviderDefinitionIds.indexOf(o);r&&-1===f?this.notificationProviderDefinitionIds.push(o):!r&&-1!==f&&this.notificationProviderDefinitionIds.splice(f,1),this.cellInfo.setValue((0,m.cloneDeep)(this.notificationProviderDefinitionIds))}static#t=this.\u0275fac=function(o){return new(o||g)(t.Y36(x.$))};static#i=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-notification-provider-definitions"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[t.jDz],decls:3,vars:0,consts:[[1,"row"],[1,"col-4"],[3,"text","value","disabled","click","onValueChanged"],["class","col-4"]],template:function(o,f){1&o&&(t.TgZ(0,"div",0),t.SjG(1,h,2,3,"div",3,I),t.qZA()),2&o&&(t.xp6(),t.wJu(f.notificationProviderDefinitions))},dependencies:[u.W,u.v,v.vaR]})}return g})()},36744:(E,y,n)=>{n.d(y,{b:()=>T});var u=n(86359),m=n(19212);let T=(()=>{class v{constructor(){this.isViewMode=!1,this.notificationSettingRadioGroupDataSource=[],this.notificationSettingRadioGroupValue=null}ngOnInit(){this.notificationSettingRadioGroupDataSource=[{type:"share",text:"\u5957\u7528\u5171\u7528\u8a2d\u5b9a"},{type:"custom",text:"\u53e6\u884c\u8a2d\u5b9a"}],this.notificationSettingRadioGroupValue=this.notificationSettingRadioGroupDataSource[0]}onNotificationSettingRadioGroupChanged(x){this.cellInfo.setValue("share"===x.value.type?"share":"custom")}static#t=this.\u0275fac=function(I){return new(I||v)};static#i=this.\u0275cmp=m.Xpm({type:v,selectors:[["app-notification-setting-items-radio-group"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[m.jDz],decls:2,vars:3,consts:[["displayExpr","text","layout","horizontal",3,"dataSource","value","readOnly","valueChange","onValueChanged"],["radioGroup",""]],template:function(I,h){1&I&&(m.TgZ(0,"dx-radio-group",0,1),m.NdJ("valueChange",function(g){return h.notificationSettingRadioGroupValue=g})("onValueChanged",function(g){return h.onNotificationSettingRadioGroupChanged(g)}),m.qZA()),2&I&&m.Q6J("dataSource",h.notificationSettingRadioGroupDataSource)("value",h.notificationSettingRadioGroupValue)("readOnly",h.isViewMode)},dependencies:[u._,u.I]})}return v})()},90962:(E,y,n)=>{n.d(y,{b:()=>r});var u=n(6990),T=n(74291),v=n(10518),t=n(19212),x=n(53009);const I=(o,f)=>f.notificationSettingDefinitionId;function h(o,f){if(1&o){const l=t.EpF();t.TgZ(0,"dx-select-box",6),t.NdJ("valueChange",function(i){t.CHM(l);const F=t.oxw().$implicit;return t.KtG(F.value=i)})("onValueChanged",function(i){t.CHM(l);const F=t.oxw().$index,b=t.oxw(2);return t.KtG(b.onSettingValueChanged(i,F))}),t.qZA()}if(2&o){const l=t.oxw().$implicit,c=t.oxw(2);t.Q6J("dataSource",c.selectBoxDataSource)("value",l.value)}}function C(o,f){if(1&o){const l=t.EpF();t.TgZ(0,"dx-text-box",7),t.NdJ("valueChange",function(i){t.CHM(l);const F=t.oxw().$implicit;return t.KtG(F.value=i)})("onValueChanged",function(i){t.CHM(l);const F=t.oxw().$index,b=t.oxw(2);return t.KtG(b.onSettingValueChanged(i,F))}),t.qZA()}if(2&o){const l=t.oxw().$implicit;t.Q6J("value",l.value)}}function g(o,f){if(1&o&&(t.TgZ(0,"div",3)(1,"div",2),t._uU(2),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,h,1,2,"dx-select-box",5)(5,C,1,1),t.qZA()()),2&o){const l=f.$implicit,c=f.$index,i=t.oxw(2);t.xp6(2),t.hij(" ",i.displayNames[c]," "),t.xp6(2),t.um2(4,"b6b5fb16-6f45-f7ad-85e3-3a1229a3ead0"===l.notificationSettingDefinitionId?4:5)}}function p(o,f){if(1&o&&(t.TgZ(0,"label",0)(1,"span",1)(2,"span",2),t._uU(3,"\u901a\u77e5\u8a2d\u5b9a"),t.qZA()()(),t.SjG(4,g,6,2,"div",8,I)),2&o){const l=t.oxw();t.xp6(4),t.wJu(l.notificationSetting)}}let r=(()=>{class o{constructor(l){this.appRestService=l,this.isUseCustomSetting=!1,this.isViewMode=!1,this.notificationSetting=[],this.displayNames=[],this.selectBoxDataSource=["A","M"]}ngOnChanges(){this.applyNotificationSettingItems(),this.fetchCustomNotificationSettingItems(),this.clearCustomNotificationSettingItems()}applyNotificationSettingItems(){if(0===this.notificationSetting.length)return;const l=(0,u.cloneDeep)(this.notificationSetting);this.cellInfo.setValue(l)}fetchCustomNotificationSettingItems(){!this.isUseCustomSetting||this.notificationSetting.length>0||this.appRestService.request({method:"GET",url:"/api/app/notification-settings/current-tenant"}).subscribe(l=>{l.forEach(c=>{this.notificationSetting.push((0,u.cloneDeep)({notificationSettingDefinitionId:c.notificationSettingDefinition.id,value:c.notificationSetting.value||c.notificationSettingDefinition.defaultValue,isInherited:c.notificationSetting.isInherited})),this.displayNames.push(c.notificationSettingDefinition.displayName)}),this.applyNotificationSettingItems()})}clearCustomNotificationSettingItems(){this.isUseCustomSetting||0===this.notificationSetting.length||this.cellInfo.setValue(null)}onSettingValueChanged(l,c){this.notificationSetting[c].value=l.value,this.applyNotificationSettingItems()}static#t=this.\u0275fac=function(c){return new(c||o)(t.Y36(x.$))};static#i=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-notification-setting-items"]],inputs:{isUseCustomSetting:"isUseCustomSetting",cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[t.TTD,t.jDz],decls:1,vars:1,consts:[[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],[1,"d-flex","align-items-center","mb-3"],[1,"ps-3","pe-3"],["valueChangeEvent","keyup",3,"dataSource","value"],["valueChangeEvent","keyup",3,"dataSource","value","valueChange","onValueChanged"],["valueChangeEvent","keyup",3,"value","valueChange","onValueChanged"],["class","d-flex align-items-center mb-3"]],template:function(c,i){1&c&&t.YNc(0,p,6,0),2&c&&t.um2(0,i.isUseCustomSetting?0:-1)},dependencies:[T.a,T.I,v.D,v._]})}return o})()},38653:(E,y,n)=>{n.d(y,{k:()=>h});var u=n(96814),m=n(61157),T=n(37398),v=n(66648),t=n(19212),x=n(88762),I=n(24106);let h=(()=>{class C{constructor(p,r){this.restService=p,this.localizationService=r,this.isViewMode=!1,this.hideReceiverTagBox=!1,this.receiversDataSource$=null,this.currentDataField=""}ngOnInit(){this.currentDataField=this.cellInfo.column.dataField,this.cellInfo.column.validationRules=[{type:"custom",message:this.localizationService.instant("AbpValidation::ThisFieldIsRequired."),validationCallback:this.receiverTagBoxValidationCallback}],this.receiversDataSource$=this.restService.request({method:"GET",url:"/api/app/notification-infos/assignable-receivers"}).pipe((0,T.U)(p=>p.items))}receiverTagBoxValidationCallback(p){return console.log(p),!!(p.data.isForAllReceivers||p.data[p.column.dataField]&&0!==p.data[p.column.dataField].length)}static#t=this.\u0275fac=function(r){return new(r||C)(t.Y36(x.vgb),t.Y36(x.oQ8))};static#i=this.\u0275cmp=t.Xpm({type:C,selectors:[["app-receiver-tag-box"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode",hideReceiverTagBox:"hideReceiverTagBox"},standalone:!0,features:[t.jDz],decls:7,vars:6,consts:[[3,"hidden"],[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],["appTagBox","","receiverTagBox","","displayExpr","name","valueExpr","id","validationMessageMode","always",3,"dataSource","value","disabled","onValueChanged"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"label",1)(2,"span",2)(3,"span",3),t._uU(4," \u63a5\u6536\u8005 (\u591a\u7b46) "),t.qZA()()(),t.TgZ(5,"dx-tag-box",4),t.NdJ("onValueChanged",function(l){return o.cellInfo.setValue(l.value)}),t.ALo(6,"async"),t.qZA()()),2&r&&(t.Q6J("hidden",o.hideReceiverTagBox),t.xp6(5),t.Q6J("dataSource",t.lcZ(6,4,o.receiversDataSource$))("value",o.cellInfo.value)("disabled",o.isViewMode))},dependencies:[m._,m.U,u.ez,u.Ov,v.m,I.x],styles:["dx-tag-box[apptagbox][receiverTagBox] .dx-overlay-wrapper.dx-invalid-message.dx-invalid-message-always{width:100%!important}"]})}return C})()}}]);