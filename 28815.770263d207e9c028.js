"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[28815],{28815:(V,u,r)=>{r.r(u),r.d(u,{ReceiverGroupsModule:()=>L});var s=r(96814),T=r(31610),c=r(88762),m=r(23758),g=r(35461),v=r(85054);const x=[{type:"buttons",fixed:!0,buttons:[{name:"save",template:"grid-save-button"},{name:"detail",template:"detail-button"},{name:"edit",template:"grid-edit-button"},{name:"delete",template:"grid-delete-button"},{name:"cancel",template:"grid-cancel-button"}]},{dataField:"id",dataType:"string",visible:!1},{dataField:"idCode",dataType:"string",validationRules:[v.L],filterOperations:g.I.text},{dataField:"name",caption:"Name",dataType:"string",validationRules:[v.L]},{dataField:"sortingNumber",dataType:"number",visible:!1},{dataField:"id",visible:!1},{dataField:"tenantId",caption:"",dataType:"string",visible:!1},{dataField:"subTenantId",caption:"",dataType:"string",visible:!1},{name:"subTenantName",caption:"",dataType:"string"},{name:"SubTenantName",caption:"",dataType:"string",filterOperations:g.I.text},{dataField:"receiverIds",dataType:"string",visible:!1,calculateCellValue:t=>t.receiverIds.map(i=>({id:i.id,displayName:i.name}))},{dataField:"parentReceiverGroupId",caption:"",dataType:"string",visible:!1},{dataField:"concurrencyStamp",visible:!1}],y={index:"/api/app/receiver-groups",get:"/api/app/receiver-groups",create:"/api/app/receiver-groups",update:"/api/app/receiver-groups",delete:"/api/app/receiver-groups"},F=[{dataField:"subTenantId",path:"/api/app/receiver-groups/sub-tenant-lookup"},{dataField:"receiverIds",path:"/api/app/receiver-groups/receiver-lookup"}],C=[{dataField:"tenantId",translateKeys:["TenantId"]},{name:"tenantCode",translateKeys:["TenantId"]},{name:"tenantName",translateKeys:["TenantId"]},{dataField:"parentReceiverGroupId",translateKeys:["ParentReceiverGroupId"]},{name:"parentReceiverGroupCode",translateKeys:["ParentReceiverGroupId"]},{name:"parentReceiverGroupName",translateKeys:["ParentReceiverGroupId"]},{dataField:"name",translateKeys:["Name"]}],f=[{dataField:"id",mapping:["receiverGroup","id"]},{dataField:"concurrencyStamp",mapping:["receiverGroup","concurrencyStamp"]},{dataField:"receiverIds",queryStringKey:"receivers",mapping:["receivers"]},{dataField:"name",queryStringKey:"Name",mapping:["receiverGroup","name"]},{dataField:"idCode",queryStringKey:"IdCode",mapping:["receiverGroup","idCode"]},{dataField:"sortingNumber",queryStringKey:"SortingNumber",mapping:["receiverGroup","sortingNumber"]},{dataField:"subTenantId",queryStringKey:"SubTenantId",mapping:["subTenant","id"]},{dataField:"subTenantName",queryStringKey:"SubTenantName",mapping:["subTenant","name"]}],I={popup:{title:"::\u65b0\u589e"},form:{colCount:2,items:[{dataField:"idCode",editorType:"dxTextBox",colSpan:1},{dataField:"name",editorType:"dxTextBox",colSpan:1},{dataField:"sortingNumber",editorType:"dxNumberBox",colSpan:1},{dataField:"subTenantId",editorType:"dxSelectBox",colSpan:1,editorOptions:{displayExpr:"displayName"}},{dataField:"receiverIds",editorType:"dxTagBox",editorOptions:{displayExpr:"displayName"},colSpan:1}]}},G={popup:{title:"::\u7de8\u8f2f"},form:{colCount:2,items:[{dataField:"name",editorType:"dxTextBox",colSpan:1},{dataField:"sortingNumber",editorType:"dxNumberBox",colSpan:1},{dataField:"receiverIds",editorType:"dxTagBox",editorOptions:{displayExpr:"displayName"},colSpan:1}]}};var e=r(19212),R=r(67),N=r(72783),_=r(44347),D=r(16358),K=r(20843),b=r(2173),M=r(25012);const B=["grid"];function O(t,d){if(1&t&&(e.TgZ(0,"a"),e._uU(1),e.qZA()),2&t){const i=e.oxw().$implicit;e.xp6(),e.hij(" ",i.name," ")}}function P(t,d){if(1&t){const i=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(n){e.CHM(i);const p=e.oxw().$implicit,o=e.oxw();return e.KtG(o.breadCrumbClick(n,p.id))}),e._uU(1),e.qZA()}if(2&t){const i=e.oxw().$implicit;e.xp6(),e.hij(" ",i.name," ")}}function Q(t,d){if(1&t&&(e.TgZ(0,"li",11),e.YNc(1,O,2,1,"a",12)(2,P,2,1,"a",13),e.qZA()),2&t){const i=d.index,a=e.oxw();e.ekj("active",i===a.breadCrumbData.length-1),e.xp6(),e.Q6J("ngIf",i===a.breadCrumbData.length-1),e.xp6(),e.Q6J("ngIf",i!==a.breadCrumbData.length-1)}}function J(t,d){if(1&t){const i=e.EpF();e.TgZ(0,"dx-button",15),e.NdJ("onClick",function(){const p=e.CHM(i).$implicit,o=e.oxw();return e.KtG(o.onDetailButtonClick(p))}),e.qZA()}}function Z(t,d){1&t&&e.GkF(0)}const A=t=>({$implicit:t});function k(t,d){if(1&t&&(e.ynx(0),e.YNc(1,Z,1,0,"ng-container",17),e.BQk()),2&t){const i=d.$implicit,a=e.oxw().$implicit,n=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",n.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",e.VKq(2,A,i))}}function U(t,d){if(1&t&&(e.ynx(0),e.YNc(1,k,2,4,"ng-container",16),e.BQk()),2&t){const i=d.$implicit;e.xp6(),e.Q6J("dxTemplateOf",i.key)}}const w=()=>({type:"default",stylingMode:"contained"}),E=[{path:"",component:(()=>{class t{constructor(i,a,n,p){this.gridDataSourceService=i,this.templateStore=a,this.appRestService=n,this.configStateService=p,this.columns=x,this.cRUDEndpoints=y,this.dataFieldLookupSourceMapping=F,this.dataFieldTranslationKeysMapping=C,this.relatedDataValueAndQueryStringKeyMapping=f,this.editingPropertiesForCreating=I,this.editingPropertiesForUpdating=G,this.gridProperties={filterRow:{visible:!1}},this.breadCrumbData=[],this.getBreadCrumbData=o=>{this.appRestService.request({method:"GET",url:"/api/app/jbnotifier-admin/receiver-groups/breadcrumbs",params:{parentReceiverGroupId:o}}).subscribe(l=>{this.parentReceiverGroupId=l.items[l.items.length-1]?.id,this.breadCrumbData=l.items})},this.setGridDataSource=o=>{this.gridDataSource=this.gridDataSourceService.getDataSource(y,f),this.gridDataSource.filter([["SpecifiedTenantId","=",this.SpecifiedTenantId],["ParentReceiverGroupId","=",o]])},this.configStateService.getOne$("currentTenant").subscribe(o=>{this.SpecifiedTenantId=o.id})}ngOnInit(){this.setGridDataSource(),this.getBreadCrumbData()}onInitNewRow(i){const a=this.configStateService.getOne("currentUser");i.data.parentReceiverGroupId=this.parentReceiverGroupId,i.data.tenantId=a.tenantId,i.data.receiverIds=[]}onDetailButtonClick(i){const a=i.data.id;this.setGridDataSource(a),this.getBreadCrumbData(a)}breadCrumbClick(i,a){i.preventDefault();const n=a;this.setGridDataSource(n),this.getBreadCrumbData(n)}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(R.I),e.Y36(N.z),e.Y36(c.vgb),e.Y36(c.XJE))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-receiver-groups"]],viewQuery:function(a,n){if(1&a&&e.Gf(B,5),2&a){let p;e.iGM(p=e.CRH())&&(n.grid=p.first)}},decls:14,vars:16,consts:[[1,"h-100","d-flex","flex-column"],["aria-label","breadcrumb"],[1,"breadcrumb","ps-3","p-2","mb-2"],["class","breadcrumb-item",3,"active",4,"ngFor","ngForOf"],[1,"flex-grow-1","overflow-hidden"],["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","gridProperties","isEditingDataAsync","onInitNewRow"],["grid",""],["icon","eyeopen","stylingMode","contained",3,"onClick",4,"dxTemplate","dxTemplateOf"],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[1,"breadcrumb-item"],[4,"ngIf"],["href","#",3,"click",4,"ngIf"],["href","#",3,"click"],["icon","eyeopen","stylingMode","contained",3,"onClick"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(a,n){1&a&&(e.TgZ(0,"div",0)(1,"div")(2,"nav",1)(3,"ol",2),e.YNc(4,Q,3,4,"li",3),e.qZA()()(),e.TgZ(5,"div",4)(6,"dx-data-grid",5,6),e.NdJ("onInitNewRow",function(o){return n.onInitNewRow(o)}),e.YNc(8,J,1,0,"dx-button",7),e.TgZ(9,"dxo-toolbar"),e._UZ(10,"dxi-item",8)(11,"dxi-item",9),e.qZA(),e.YNc(12,U,2,1,"ng-container",10),e.ALo(13,"keyvalue"),e.qZA()()()),2&a&&(e.xp6(4),e.Q6J("ngForOf",n.breadCrumbData),e.xp6(2),e.Q6J("dataFieldTranslationKeysMapping",n.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",n.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",n.dataFieldLookupSourceMapping)("editingPropertiesForCreating",n.editingPropertiesForCreating)("editingPropertiesForUpdating",n.editingPropertiesForUpdating)("columns",n.columns)("dataSource",n.gridDataSource)("gridProperties",n.gridProperties)("isEditingDataAsync",!0),e.xp6(2),e.Q6J("dxTemplateOf","detail-button"),e.xp6(2),e.Q6J("options",e.DdM(15,w)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(13,13,n.templateStore.gridTemplates)))},dependencies:[s.sg,s.O5,s.tP,_._,D.K,K.p6,b.ZT3,M.e,b.y1f,s.Nd],styles:[".breadcrumb[_ngcontent-%COMP%]{border-radius:3px;border:0}"]})}return t})(),canActivate:[c.a1M,c.nG9]}];let Y=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(E),m.Bz]})}return t})();var $=r(5533);let L=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#i=this.\u0275inj=e.cJS({imports:[s.ez,Y,T.m,$.P]})}return t})()}}]);