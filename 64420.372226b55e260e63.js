"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[64420],{64420:(G,c,o)=>{o.r(c),o.d(c,{ApiKeysModule:()=>z});var s=o(96814),l=o(88762),u=o(23758),d=o(35461);const T=[{type:"buttons",fixed:!0,caption:"\u64cd\u4f5c",buttons:[{name:"edit",template:"grid-edit-button"},{name:"delete",template:"grid-delete-button"},{name:"copy-token-value",template:"copy-token-value"},{name:"regenerate-token-button",template:"regenerate-token-button"}]},{dataField:"id",visible:!1},{dataField:"tenantId",caption:"\u79df\u6236",dataType:"string",visible:!1},{name:"tenantName",caption:"\u79df\u6236",dataType:"string",filterOperations:d.I.text},{name:"tokenValue",caption:"TokenValue",width:200},{dataField:"startDate",caption:"\u8d77\u65e5",dataType:"date",filterOperations:d.I.date},{dataField:"endDate",caption:"\u8fc4\u65e5",dataType:"date",filterOperations:d.I.date},{name:"status",caption:"\u72c0\u614b",dataType:"string"},{dataField:"concurrencyStamp",dataType:"string",visible:!1}],g={index:"/api/app/api-keys",get:"/api/app/api-keys",create:"/api/app/api-keys",update:"/api/app/api-keys",delete:"/api/app/api-keys"},S=[{dataField:"tenantId",path:"/api/identity/customize-users/assignable-tenants",pathForSelectedDisplay:"/api/saas/customize-tenants"}],h=[{name:"tenantName",translateKeys:["Saas::DisplayName:TenantName"]},{dataField:"startDate",translateKeys:["AbpAuditLogging::StartDate"]},{dataField:"endDate",translateKeys:["AbpAuditLogging::EndDate"]},{name:"status",translateKeys:["AbpAccount::Status"]}],m=[{dataField:"id",mapping:["apiKey","id"]},{dataField:"tenantId",queryStringKey:"TenantId",mapping:["tenant","id"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"tokenValue",mapping:["apiKey","tokenValue"]},{dataField:"startDate",queryStringKey:"StartDate",mapping:["apiKey","startDate"]},{dataField:"endDate",queryStringKey:"EndDate",mapping:["apiKey","endDate"]},{name:"status",queryStringKey:"Status",mapping:["apiKey","status"]},{dataField:"concurrencyStamp",mapping:["apiKey","concurrencyStamp"]}],C={popup:{title:"\u65b0\u589e"},form:{colCount:2,items:[{dataField:"tenantId",editorType:"dxSelectBox",colSpan:1,validationRules:[{type:"required"}]},{dataField:"startDate",editorType:"dxDateBox",colSpan:1,validationRules:[{type:"required"}]},{dataField:"endDate",editorType:"dxDateBox",colSpan:1,validationRules:[{type:"required"}]}]}},K={popup:{title:"\u7de8\u8f2f"},form:{colCount:2,items:[{dataField:"tenantId",editorType:"dxSelectBox",colSpan:1,editorOptions:{disabled:!0},validationRules:[{type:"required"}]},{dataField:"startDate",editorType:"dxDateBox",colSpan:1,validationRules:[{type:"required"}]},{dataField:"endDate",editorType:"dxDateBox",colSpan:1,validationRules:[{type:"required"}]}]}};var e=o(19212),A=o(67),D=o(72783),k=o(20515),y=o(2173),I=o(69784),b=o(50469),_=o(10313),f=o(24270),v=o(16358);let M=(()=>{class t{constructor(n){this.toastService=n,this.copyToClipboard=()=>{navigator.clipboard.writeText(this.value).then(()=>{this.toastService.info(`\u5df2\u8907\u88fdToken: ${this.value}`),console.log("Text copied to clipboard")}).catch(a=>{console.error("Error copying text: ",a)})}}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(f.P))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-copy-to-clipboard"]],inputs:{value:"value",cellInfo:"cellInfo"},decls:1,vars:0,consts:[["stylingMode","contained","icon","copy","type","normal",3,"onClick"]],template:function(a,i){1&a&&(e.TgZ(0,"dx-button",0),e.NdJ("onClick",function(){return i.copyToClipboard()}),e.qZA())},dependencies:[v.K],encapsulation:2})}return t})();var N=o(53009);let U=(()=>{class t{constructor(n,a){this.restService=n,this.toastService=a,this.regenerateApiKey=()=>{this.restService.request({url:`/api/app/api-keys/regenerate-token-value/${this.value}`,method:"PUT"}).subscribe(()=>{this.grid.instance.refresh(),this.toastService.info("\u5df2\u91cd\u65b0\u7522\u751fToken!")})}}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(N.$),e.Y36(f.P))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-regnerate-token-button"]],inputs:{value:"value",grid:"grid"},decls:1,vars:0,consts:[["stylingMode","contained","icon","refresh","type","success",3,"onClick"]],template:function(a,i){1&a&&(e.TgZ(0,"dx-button",0),e.NdJ("onClick",function(){return i.regenerateApiKey()}),e.qZA())},dependencies:[v.K],encapsulation:2})}return t})();const B=["grid"];function O(t,r){if(1&t&&e._UZ(0,"app-copy-to-clipboard",9),2&t){const n=r.$implicit;e.Q6J("cellInfo",n)("value",null==n.row||null==n.row.data?null:n.row.data.tokenValue)}}function Q(t,r){if(1&t&&e._UZ(0,"app-regnerate-token-button",10),2&t){const n=r.$implicit;e.oxw();const a=e.MAs(1);e.Q6J("value",null==n.row||null==n.row.data?null:n.row.data.id)("grid",a)}}function R(t,r){if(1&t&&e._UZ(0,"app-grid-general-filter",11),2&t){e.oxw();const n=e.MAs(1);e.Q6J("grid",n)}}function J(t,r){1&t&&e.GkF(0)}const Z=t=>({$implicit:t});function w(t,r){if(1&t&&(e.ynx(0),e.YNc(1,J,1,0,"ng-container",13),e.BQk()),2&t){const n=r.$implicit,a=e.oxw().$implicit,i=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",i.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",e.VKq(2,Z,n))}}function P(t,r){if(1&t&&(e.ynx(0),e.YNc(1,w,2,4,"ng-container",12),e.BQk()),2&t){const n=r.$implicit;e.xp6(),e.Q6J("dxTemplateOf",n.key)}}const V=()=>({type:"default",stylingMode:"contained"}),Y=[{path:"",component:(()=>{class t{constructor(n,a,i){this.gridDataSourceService=n,this.templateStore=a,this.configStateService=i,this.columns=T,this.cRUDEndpoints=g,this.dataFieldLookupSourceMapping=S,this.dataFieldTranslationKeysMapping=h,this.relatedDataValueAndQueryStringKeyMapping=m,this.editingPropertiesForCreating=C,this.editingPropertiesForUpdating=K,this.configStateService.getOne("currentUser").tenantId&&(this.editingPropertiesForCreating.form.items[0].visible=!1,this.editingPropertiesForUpdating.form.items[0].visible=!1)}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(g,m)}onInitNewRow(n){const a=this.configStateService.getOne("currentUser");a.tenantId&&(n.data.tenantId=a.tenantId)}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(A.I),e.Y36(D.z),e.Y36(l.XJE))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-api-keys"]],viewQuery:function(a,i){if(1&a&&e.Gf(B,5),2&a){let p;e.iGM(p=e.CRH())&&(i.grid=p.first)}},decls:11,vars:14,consts:[["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","onInitNewRow"],["grid",""],[3,"cellInfo","value",4,"dxTemplate","dxTemplateOf"],[3,"value","grid",4,"dxTemplate","dxTemplateOf"],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo","value"],[3,"value","grid"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(a,i){1&a&&(e.TgZ(0,"dx-data-grid",0,1),e.NdJ("onInitNewRow",function(E){return i.onInitNewRow(E)}),e.YNc(2,O,1,2,"app-copy-to-clipboard",2)(3,Q,1,2,"app-regnerate-token-button",3),e.TgZ(4,"dxo-toolbar"),e._UZ(5,"dxi-item",4),e.TgZ(6,"dxi-item",5),e.YNc(7,R,1,1,"app-grid-general-filter",6),e.qZA(),e._UZ(8,"dxi-item",7),e.qZA(),e.YNc(9,P,2,1,"ng-container",8),e.ALo(10,"keyvalue"),e.qZA()),2&a&&(e.Q6J("dataFieldTranslationKeysMapping",i.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",i.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",i.dataFieldLookupSourceMapping)("editingPropertiesForCreating",i.editingPropertiesForCreating)("editingPropertiesForUpdating",i.editingPropertiesForUpdating)("columns",i.columns)("dataSource",i.gridDataSource),e.xp6(2),e.Q6J("dxTemplateOf","copy-token-value"),e.xp6(),e.Q6J("dxTemplateOf","regenerate-token-button"),e.xp6(2),e.Q6J("options",e.DdM(13,V)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(10,11,i.templateStore.gridTemplates)))},dependencies:[s.sg,s.tP,k.e,y.ZT3,y.y1f,I.p6,b._,_.w,M,U,s.Nd],encapsulation:2})}return t})(),canActivate:[l.a1M,l.nG9]}];let $=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#a=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(Y),u.Bz]})}return t})();var L=o(9452);let z=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#a=this.\u0275inj=e.cJS({imports:[s.ez,$,L.m]})}return t})()}}]);