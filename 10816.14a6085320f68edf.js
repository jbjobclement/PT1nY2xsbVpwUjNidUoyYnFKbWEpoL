"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[10816],{10816:(tt,g,o)=>{o.r(g),o.d(g,{InstantNotificationInfosModule:()=>W});var c=o(96814),b=o(31610),m=o(88762),u=o(23758),l=o(35461),d=o(85054);const I=[{type:"buttons",fixed:!0,buttons:[{name:"edit",template:"grid-view-button"},{name:"delete",template:"grid-delete-button",disabled:i=>!i.row?.data?.isDeletable}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:l.I.text,validationRules:[d.L]},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:l.I.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:l.I.text},{name:"notificationProviderNames",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:l.I.text},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:l.I.text},{name:"pushTime",caption:"\u63a8\u9001\u6642\u9593 (\u591a\u7b46)",dataType:"string",filterOperations:l.I.text,visible:!1},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:l.I.text,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:l.I.text,visible:!1},{name:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean",visible:!1},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"notificationProviderDefinitionIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviders",validationRules:[d.L]},{dataField:"isForAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isForAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"isUsingSpecificNotificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettingItems"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[d.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[d.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"notificationTemplateId",caption:"\u901a\u77e5\u6a21\u677f Id",dataType:"string",visible:!1},{dataField:"notificationTemplateArgs",caption:"\u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"notificationTemplateArgs"}],T={index:"/api/app/instant-notification-infos",get:"/api/app/instant-notification-infos",create:"/api/app/instant-notification-infos",update:"/api/app/instant-notification-infos",delete:"/api/app/instant-notification-infos"},C=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"},{dataField:"notificationTemplateId",path:"/api/app/notification-infos/assignable-notification-templates",pathForSelectedDisplay:"/api/app/notification-templates"}],y=[{dataField:"id",mapping:["id"]},{dataField:"concurrencyStamp",mapping:["concurrencyStamp"]},{dataField:"title",queryStringKey:"Title",mapping:["title"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenantName"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategoryName"]},{name:"notificationProviderNames",queryStringKey:"NotificationProviderNames",mapping:["notificationProviderNames"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{name:"pushTime",queryStringKey:"PushTime",mapping:["pushTime"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["hookEndpoint"]},{name:"isFinished",queryStringKey:"IsFinished",mapping:["isFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderDefinitionIds",mapping:["notificationProviderDefinitionIds"]},{dataField:"isForAllReceivers",mapping:["isForAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"isUsingSpecificNotificationSettings",mapping:["isUsingSpecificNotificationSettings"]},{dataField:"notificationSettingItems",mapping:["notificationSettingItems"]},{dataField:"notificationCategoryId",mapping:["notificationCategoryId"]},{dataField:"subtitle",mapping:["subtitle"]},{dataField:"textContent",mapping:["textContent"]},{dataField:"htmlContent",mapping:["htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["isFetchNotificationDataByEachReceiver"]},{dataField:"notificationTemplateId",mapping:["notificationTemplateId"]},{dataField:"notificationTemplateArgs",mapping:["notificationTemplateArgs"]}],f=[{itemType:"group",name:"TopGroup",colCount:8,cssClass:"basic-edit-form-top-group",items:[{itemType:"group",name:"TopLeftGroup",caption:"\u57fa\u672c",colSpan:5,cssClass:"top-left-group",items:[{dataField:"notificationProviderDefinitionIds",label:{visible:!1}},{dataField:"isForAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]},{itemType:"group",name:"TopRightGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",label:{visible:!1}}]}]},{itemType:"group",name:"BottomGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{imageUpload:{fileUploadMode:"both",tabs:["url","file"]},toolbar:{items:[{name:"undo"},{name:"redo"},{name:"separator"},{name:"size",acceptedValues:["8pt","10pt","12pt","14pt","18pt","24pt","36pt"]},{name:"font",acceptedValues:["Arial","Georgia","Tahoma","Times New Roman","Verdana"]},{name:"separator"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"underline"},{name:"separator"},{name:"alignLeft"},{name:"alignCenter"},{name:"alignRight"},{name:"alignJustify"},{name:"separator"},{name:"orderedList"},{name:"bulletList"},{name:"separator"},{name:"header",acceptedValues:[!1,1,2,3,4,5]},{name:"separator"},{name:"color"},{name:"background"},{name:"separator"},{name:"link"},{name:"image"},{name:"separator"},{name:"clear"},{name:"codeBlock"},{name:"blockquote"},{name:"separator"},{name:"insertTable"},{name:"deleteTable"},{name:"insertRowAbove"},{name:"insertRowBelow"},{name:"deleteRow"},{name:"insertColumnLeft"},{name:"insertColumnRight"},{name:"deleteColumn"},{name:"cellProperties"},{name:"tableProperties"}]},height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"notificationTemplateId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"notificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"NotificationEndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"}]}]}],h={popup:{title:"::\u65b0\u589e",wrapperAttr:{class:"basic-popup"},toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:f,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}},S={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup basic-popup--readonly"},toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar-readonly"}]},form:{colCount:1,items:f,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}};var x=o(59187),t=o(19212),N=o(67),_=o(72783),A=o(58420),R=o(20843),v=o(2173),U=o(25012),D=o(20481),E=o(65343),B=o(73953);let O=(()=>{class i{constructor(){this.confirmButtonEvent=new t.vpe}static#t=this.\u0275fac=function(a){return new(a||i)};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-button"]],outputs:{confirmButtonEvent:"confirmButtonEvent"},standalone:!0,features:[t.jDz],decls:2,vars:0,consts:[[1,"basic-button","basic-button--confirm",3,"click"]],template:function(a,e){1&a&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return e.confirmButtonEvent.emit()}),t._uU(1,"\u78ba\u8a8d"),t.qZA())},styles:[".basic-button--confirm[_ngcontent-%COMP%]{background-color:var(--blue-1)}"]})}return i})();var P=o(49291);const G=["grid"];function M(i,s){if(1&i&&t._UZ(0,"app-grid-after-tool-bar",9),2&i){t.oxw();const n=t.MAs(1);t.Q6J("grid",n)}}function Q(i,s){if(1&i){const n=t.EpF();t.TgZ(0,"div")(1,"app-confirm-button",10),t.NdJ("confirmButtonEvent",function(){t.CHM(n);const e=t.oxw();return t.KtG(e.closeReadOnlyPopup())}),t.qZA()()}}function J(i,s){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",9),t.qZA()),2&i){t.oxw();const n=t.MAs(1);t.xp6(),t.Q6J("grid",n)}}function k(i,s){1&i&&t.GkF(0)}const F=i=>({$implicit:i});function K(i,s){if(1&i&&(t.ynx(0),t.YNc(1,k,1,0,"ng-container",8),t.BQk()),2&i){const n=s.$implicit,a=t.oxw().$implicit,e=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",e.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",t.VKq(2,F,n))}}function Z(i,s){if(1&i&&(t.ynx(0),t.YNc(1,K,2,4,"ng-container",6),t.BQk()),2&i){const n=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",n.key)}}function L(i,s){1&i&&t.GkF(0)}const V=(i,s,n,a)=>({isForAllReceivers:i,tenantId:s,isUsingSpecificNotificationSettings:n,notificationTemplateId:a});function Y(i,s){if(1&i&&(t.ynx(0),t.YNc(1,L,1,0,"ng-container",8),t.BQk()),2&i){const n=s.$implicit,a=t.oxw().$implicit,e=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",e.notificationFormTemplateStore.getFormTemplates(a.key))("ngTemplateOutletContext",e.configureContext(a.key,n,t.l5B(2,V,e.isForAllReceivers,e.tenantId,e.isUsingSpecificNotificationSettings,e.notificationTemplateId)))}}function $(i,s){if(1&i&&(t.ynx(0),t.YNc(1,Y,2,7,"ng-container",6),t.BQk()),2&i){const n=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",n.key)}}function j(i,s){1&i&&t.GkF(0)}const z=()=>({type:"default",stylingMode:"contained"}),H=[{path:"",component:(()=>{class i{constructor(n,a,e,r){this.gridDataSourceService=n,this.configStateService=a,this.templateStore=e,this.notificationFormTemplateStore=r,this.columns=I,this.cRUDEndpoints=T,this.dataFieldLookupSourceMapping=C,this.relatedDataValueAndQueryStringKeyMapping=y,this.editingPropertiesForCreating=h,this.editingPropertiesForUpdating=S,this.configureContext=x.m,this.isReadOnlyMode=!1}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(T,y),this.configStateService.getOne$("currentUser").subscribe(n=>{this.tenantId=n.tenantId})}onEditingStart(){this.isReadOnlyMode=!0}closeReadOnlyPopup(){this.isReadOnlyMode=!1,this.grid.instance.cancelEditData()}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(N.I),t.Y36(m.XJE),t.Y36(_.z),t.Y36(A.z))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-instant-notification"]],viewQuery:function(a,e){if(1&a&&t.Gf(G,5),2&a){let r;t.iGM(r=t.CRH())&&(e.grid=r.first)}},decls:14,vars:26,consts:[["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","tenantId","isForAllReceivers","isUsingSpecificNotificationSettings","isUsingTemplate","notificationTemplateId","isForAllReceiversChange","isUsingSpecificNotificationSettingsChange","isUsingTemplateChange","notificationTemplateIdChange","onEditingStart"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"dxTemplate","dxTemplateOf"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"grid"],[3,"confirmButtonEvent"]],template:function(a,e){if(1&a&&(t.TgZ(0,"dx-data-grid",0,1),t.NdJ("isForAllReceiversChange",function(p){return e.isForAllReceivers=p})("isUsingSpecificNotificationSettingsChange",function(p){return e.isUsingSpecificNotificationSettings=p})("isUsingTemplateChange",function(p){return e.isUsingTemplate=p})("notificationTemplateIdChange",function(p){return e.notificationTemplateId=p})("onEditingStart",function(){return e.onEditingStart()}),t.TgZ(2,"dxo-toolbar"),t._UZ(3,"dxi-item",2),t.TgZ(4,"dxi-item",3),t.YNc(5,M,1,1,"app-grid-after-tool-bar",4),t.qZA(),t._UZ(6,"dxi-item",5),t.qZA(),t.YNc(7,Q,2,0,"div",6)(8,J,2,1,"div",6)(9,Z,2,1,"ng-container",7),t.ALo(10,"keyvalue"),t.YNc(11,$,2,1,"ng-container",7),t.ALo(12,"keyvalue"),t.qZA(),t.YNc(13,j,1,0,"ng-container",8)),2&a){const r=t.MAs(1);t.Q6J("datafieldValueQueryStringKeyMapping",e.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",e.dataFieldLookupSourceMapping)("editingPropertiesForCreating",e.editingPropertiesForCreating)("editingPropertiesForUpdating",e.editingPropertiesForUpdating)("columns",e.columns)("dataSource",e.gridDataSource)("isEditingDataAsync",!0)("tenantId",e.tenantId)("isForAllReceivers",e.isForAllReceivers)("isUsingSpecificNotificationSettings",e.isUsingSpecificNotificationSettings)("isUsingTemplate",e.isUsingTemplate)("notificationTemplateId",e.notificationTemplateId),t.xp6(3),t.Q6J("options",t.DdM(23,z)),t.xp6(4),t.Q6J("dxTemplateOf","bottom-toolbar-readonly"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("ngForOf",t.lcZ(10,19,e.templateStore.gridTemplates)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(12,21,e.notificationFormTemplateStore.formTemplates)),t.xp6(2),t.Q6J("ngTemplateOutlet",e.notificationFormTemplateStore.getFormTemplates("notificationPager"))("ngTemplateOutletContext",t.VKq(24,F,r))}},dependencies:[c.sg,c.tP,R.p6,v.ZT3,U.e,v.y1f,D._,E.f,B.R,O,P.V,c.Nd]})}return i})(),canActivate:[m.a1M,m.nG9]}];let w=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(H),u.Bz]})}return i})();var X=o(5533),q=o(68862);let W=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#i=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[c.ez,w,X.P,q.O,b.m]})}return i})()}}]);