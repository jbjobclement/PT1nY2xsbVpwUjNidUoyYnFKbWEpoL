"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[64420],{64420:(W,c,i)=>{i.r(c),i.d(c,{ApiKeysModule:()=>X});var s=i(96814),d=i(88762),u=i(23758),l=i(35461);const x=[{type:"buttons",fixed:!0,caption:"\u64cd\u4f5c",buttons:[{name:"edit",template:"grid-edit-button"},{name:"delete",template:"grid-delete-button"},{name:"copy-token-value",template:"copy-token-value"},{name:"regenerate-token-button",template:"regenerate-token-button"}]},{dataField:"id",visible:!1},{dataField:"name",dataType:"string"},{dataField:"SpecifiedTenantId",caption:"\u79df\u6236",dataType:"string",visible:!1},{name:"tenantName",caption:"\u79df\u6236",dataType:"string",filterOperations:l.I.text},{name:"value",caption:"Value",allowFiltering:!1,width:200},{dataField:"startTime",caption:"\u8d77\u65e5",dataType:"date",filterOperations:l.I.date},{dataField:"endTime",caption:"\u8fc4\u65e5",dataType:"date",filterOperations:l.I.date},{name:"status",caption:"\u72c0\u614b",dataType:"string",minWidth:120,lookup:{valueExpr:"id",displayExpr:"name",allowClearing:!0,dataSource:[{id:0,name:"\u5931\u6548"},{id:1,name:"\u6709\u6548"},{id:2,name:"\u672a\u751f\u6548"}]}},{dataField:"concurrencyStamp",dataType:"string",visible:!1}],m={index:"/api/app/jbnotifier-admin/api-keys",get:"/api/app/jbnotifier-admin/api-keys",create:"/api/app/jbnotifier-admin/api-keys",update:"/api/app/jbnotifier-admin/api-keys",delete:"/api/app/jbnotifier-admin/api-keys"},F=[{dataField:"SpecifiedTenantId",path:"/api/app/jbnotifier-admin/api-keys/assignable-tenants"}],h=[{name:"tenantName",translateKeys:["Saas::DisplayName:TenantName"]},{dataField:"startDate",translateKeys:["AbpAuditLogging::StartDate"]},{dataField:"endDate",translateKeys:["AbpAuditLogging::EndDate"]},{name:"status",translateKeys:["AbpAccount::Status"]}],g=[{dataField:"id",mapping:["apiKey","id"]},{dataField:"name",mapping:["apiKey","name"]},{dataField:"SpecifiedTenantId",queryStringKey:"TenantId",mapping:["tenant","id"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"value",mapping:["apiKey","value"]},{dataField:"startTime",queryStringKey:"StartTime",mapping:["apiKey","startTime"]},{dataField:"endTime",queryStringKey:"EndTime",mapping:["apiKey","endTime"]},{name:"status",queryStringKey:"Status",mapping:["apiKey","status"]},{dataField:"concurrencyStamp",mapping:["apiKey","concurrencyStamp"]}],A={popup:{title:"\u65b0\u589e"},form:{colCount:2,items:[{dataField:"SpecifiedTenantId",editorType:"dxSelectBox",colSpan:1},{dataField:"name",editorType:"dxTextBox",colSpan:1},{dataField:"startTime",editorType:"dxDateBox",colSpan:1},{dataField:"endTime",editorType:"dxDateBox",colSpan:1}]}},b={popup:{title:"\u7de8\u8f2f"},form:{colCount:2,items:[{dataField:"SpecifiedTenantId",editorType:"dxSelectBox",colSpan:1,editorOptions:{disabled:!0}},{dataField:"name",editorType:"dxTextBox",colSpan:1},{dataField:"startTime",editorType:"dxDateBox",colSpan:1},{dataField:"endTime",editorType:"dxDateBox",colSpan:1}]}};var e=i(19212),I=i(67),k=i(72783),M=i(44347),y=i(10313),N=i(20843),f=i(2173),U=i(25012),D=i(21194),T=i(24270),v=i(16358);let B=(()=>{class t{constructor(n){this.toastService=n,this.copyToClipboard=()=>{navigator.clipboard.writeText(this.value).then(()=>{this.toastService.info(`\u5df2\u8907\u88fdToken: ${this.value}`),console.log("Text copied to clipboard")}).catch(a=>{console.error("Error copying text: ",a)})}}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(T.P))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-copy-to-clipboard"]],inputs:{value:"value",cellInfo:"cellInfo"},decls:1,vars:0,consts:[["stylingMode","contained","icon","copy","type","normal",3,"onClick"]],template:function(a,o){1&a&&(e.TgZ(0,"dx-button",0),e.NdJ("onClick",function(){return o.copyToClipboard()}),e.qZA())},dependencies:[v.K],encapsulation:2})}return t})();var O=i(53009);let _=(()=>{class t{constructor(n,a){this.restService=n,this.toastService=a,this.regenerateApiKey=()=>{this.restService.request({url:`/api/app/api-keys/regenerate-token-value/${this.value}`,method:"PUT"}).subscribe(()=>{this.grid.instance.refresh(),this.toastService.info("\u5df2\u91cd\u65b0\u7522\u751fToken!")})}}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(O.$),e.Y36(T.P))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-regnerate-token-button"]],inputs:{value:"value",grid:"grid"},decls:1,vars:0,consts:[["stylingMode","contained","icon","refresh","type","success",3,"onClick"]],template:function(a,o){1&a&&(e.TgZ(0,"dx-button",0),e.NdJ("onClick",function(){return o.regenerateApiKey()}),e.qZA())},dependencies:[v.K],encapsulation:2})}return t})();const Q=["grid"];function J(t,r){if(1&t&&e._UZ(0,"app-copy-to-clipboard",9),2&t){const n=r.$implicit;e.Q6J("cellInfo",n)("value",null==n.row||null==n.row.data?null:n.row.data.tokenValue)}}function Z(t,r){if(1&t&&e._UZ(0,"app-regnerate-token-button",10),2&t){const n=r.$implicit;e.oxw();const a=e.MAs(2);e.Q6J("value",null==n.row||null==n.row.data?null:n.row.data.id)("grid",a)}}function P(t,r){if(1&t&&e._UZ(0,"app-grid-general-filter",11),2&t){e.oxw();const n=e.MAs(2);e.Q6J("grid",n)}}function w(t,r){1&t&&e.GkF(0)}const R=t=>({$implicit:t});function Y(t,r){if(1&t&&(e.ynx(0),e.YNc(1,w,1,0,"ng-container",13),e.BQk()),2&t){const n=r.$implicit,a=e.oxw().$implicit,o=e.oxw();e.xp6(),e.Q6J("ngTemplateOutlet",o.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",e.VKq(2,R,n))}}function L(t,r){if(1&t&&(e.ynx(0),e.YNc(1,Y,2,4,"ng-container",12),e.BQk()),2&t){const n=r.$implicit;e.xp6(),e.Q6J("dxTemplateOf",n.key)}}const V=()=>({type:"default",stylingMode:"contained"}),$=[{path:"",component:(()=>{class t{constructor(n,a,o){this.gridDataSourceService=n,this.templateStore=a,this.configStateService=o,this.columns=x,this.cRUDEndpoints=m,this.dataFieldLookupSourceMapping=F,this.dataFieldTranslationKeysMapping=h,this.relatedDataValueAndQueryStringKeyMapping=g,this.editingPropertiesForCreating=A,this.editingPropertiesForUpdating=b,this.configStateService.getOne("currentUser").tenantId&&(this.columns[3].visible=!1,this.editingPropertiesForCreating.form.items[0].visible=!1,this.editingPropertiesForUpdating.form.items[0].visible=!1)}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(m,g)}onInitNewRow(n){const a=this.configStateService.getOne("currentUser");a.tenantId&&(n.data.tenantId=a.tenantId)}static#e=this.\u0275fac=function(a){return new(a||t)(e.Y36(I.I),e.Y36(k.z),e.Y36(d.XJE))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-api-keys"]],viewQuery:function(a,o){if(1&a&&e.Gf(Q,5),2&a){let p;e.iGM(p=e.CRH())&&(o.grid=p.first)}},decls:12,vars:15,consts:[["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","syncLookupFilterValues","onInitNewRow"],["grid",""],[3,"cellInfo","value",4,"dxTemplate","dxTemplateOf"],[3,"value","grid",4,"dxTemplate","dxTemplateOf"],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo","value"],[3,"value","grid"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(a,o){1&a&&(e._UZ(0,"app-tenant-chooser"),e.TgZ(1,"dx-data-grid",0,1),e.NdJ("onInitNewRow",function(H){return o.onInitNewRow(H)}),e.YNc(3,J,1,2,"app-copy-to-clipboard",2)(4,Z,1,2,"app-regnerate-token-button",3),e.TgZ(5,"dxo-toolbar"),e._UZ(6,"dxi-item",4),e.TgZ(7,"dxi-item",5),e.YNc(8,P,1,1,"app-grid-general-filter",6),e.qZA(),e._UZ(9,"dxi-item",7),e.qZA(),e.YNc(10,L,2,1,"ng-container",8),e.ALo(11,"keyvalue"),e.qZA()),2&a&&(e.xp6(),e.Q6J("dataFieldTranslationKeysMapping",o.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("editingPropertiesForCreating",o.editingPropertiesForCreating)("editingPropertiesForUpdating",o.editingPropertiesForUpdating)("columns",o.columns)("dataSource",o.gridDataSource)("syncLookupFilterValues",!1),e.xp6(2),e.Q6J("dxTemplateOf","copy-token-value"),e.xp6(),e.Q6J("dxTemplateOf","regenerate-token-button"),e.xp6(2),e.Q6J("options",e.DdM(14,V)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(11,12,o.templateStore.gridTemplates)))},dependencies:[s.sg,s.tP,M._,y.w,N.p6,f.ZT3,U.e,f.y1f,D.D,B,_,s.Nd],encapsulation:2})}return t})(),canActivate:[d.a1M,d.nG9]}];let j=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#a=this.\u0275inj=e.cJS({imports:[u.Bz.forChild($),u.Bz]})}return t})();var E=i(31610),G=i(5533),z=i(41992);let X=(()=>{class t{static#e=this.\u0275fac=function(a){return new(a||t)};static#t=this.\u0275mod=e.oAB({type:t});static#a=this.\u0275inj=e.cJS({imports:[s.ez,j,E.m,G.P,z.e,y.w]})}return t})()}}]);