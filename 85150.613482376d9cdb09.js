"use strict";(self.webpackChunkJBNotifier=self.webpackChunkJBNotifier||[]).push([[85150],{85150:(Ci,m,o)=>{o.r(m),o.d(m,{RecurringNotificationInfosModule:()=>yi});var d=o(96814),B=o(66648),f=o(88762),h=o(23758),c=o(35461),p=o(85054);const V=[{type:"buttons",fixed:!0,buttons:[{name:"schedule-plans",template:"grid-schedule-plans-button"},{name:"edit",template:"grid-edit-button",disabled:e=>!e.row?.data?.isEditable},{name:"delete",template:"grid-delete-button",disabled:e=>!e.row?.data?.isDeletable}]},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:c.I.text,validationRules:[p.L]},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:c.I.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:c.I.text},{name:"notificationProviderNames",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:c.I.text},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:c.I.text},{name:"cronDescriptions",caption:"Cron \u63cf\u8ff0",dataType:"string",filterOperations:c.I.text,visible:!1},{name:"pushCount",caption:"\u5df2\u63a8\u9001\u6b21\u6578",dataType:"number",filterOperations:c.I.number,visible:!1},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:c.I.text,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:c.I.text,visible:!1},{name:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean",visible:!1},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"notificationProviderDefinitionIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviders",validationRules:[p.L]},{dataField:"isForAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isForAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"isUsingSpecificNotificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notification-setting-items"},{dataField:"notificationSchedulePlans",caption:"\u91cd\u8907\u6642\u9593\u8a08\u756b",dataType:"object",visible:!1,editCellTemplate:"notification-schedule-plans"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[p.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[p.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1,validationRules:[p.L]},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1,validationRules:[p.L]},{visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1}],v={index:"/api/app/recurring-notification-infos",get:"/api/app/recurring-notification-infos",create:"/api/app/recurring-notification-infos",update:"/api/app/recurring-notification-infos",delete:"/api/app/recurring-notification-infos"},U=[{dataField:"notificationCategoryId",path:"/api/app/notification-infos/assignable-notification-categories",pathForSelectedDisplay:"/api/app/notification-categories"}],b=[{dataField:"id",mapping:["id"]},{dataField:"concurrencyStamp",mapping:["concurrencyStamp"]},{dataField:"tenantId",mapping:["tenantId"]},{dataField:"title",queryStringKey:"Title",mapping:["title"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenantName"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategoryName"]},{name:"notificationProviderNames",queryStringKey:"NotificationProviderNames",mapping:["notificationProviderNames"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{name:"cronDescriptions",queryStringKey:"CronDescriptions",mapping:["cronDescriptions"]},{name:"pushCount",queryStringKey:"PushCount",mapping:["pushCount"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["hookEndpoint"]},{name:"isFinished",queryStringKey:"IsFinished",mapping:["isFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderDefinitionIds",mapping:["notificationProviderDefinitionIds"]},{dataField:"isForAllReceivers",mapping:["isForAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"isUsingSpecificNotificationSettings",mapping:["isUsingSpecificNotificationSettings"]},{dataField:"notificationSettingItems",mapping:["notificationSettingItems"]},{dataField:"notificationSchedulePlans",mapping:["notificationSchedulePlans"]},{dataField:"notificationCategoryId",mapping:["notificationCategoryId"]},{dataField:"subtitle",mapping:["subtitle"]},{dataField:"textContent",mapping:["textContent"]},{dataField:"htmlContent",mapping:["htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["isFetchNotificationDataByEachReceiver"]}],g=[{itemType:"group",name:"TopGroup",colCount:8,cssClass:"basic-edit-form-top-group",items:[{itemType:"group",name:"TopLeftGroup",caption:"\u57fa\u672c",colSpan:5,cssClass:"top-left-group",items:[{dataField:"notificationProviderDefinitionIds",label:{visible:!1}},{dataField:"isForAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}}]},{itemType:"group",name:"TopRightGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isUsingSpecificNotificationSettings"},{dataField:"notificationSettingItems",label:{visible:!1}}]}]},{itemType:"group",name:"MidGroup",caption:"\u91cd\u8907\u6642\u9593\u8a08\u5283",items:[{dataField:"notificationSchedulePlans",label:{visible:!1}}]},{itemType:"group",name:"BottomGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"NotificationContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{focusStateEnabled:!1,activeStateEnabled:!1,tableResizing:{enabled:!0},imageUpload:{fileUploadMode:"both",tabs:["url","file"]},toolbar:{items:[{name:"undo"},{name:"redo"},{name:"separator"},{name:"size",acceptedValues:["8pt","10pt","12pt","14pt","18pt","24pt","36pt"]},{name:"font",acceptedValues:["Arial","Georgia","Tahoma","Times New Roman","Verdana"]},{name:"separator"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"underline"},{name:"separator"},{name:"alignLeft"},{name:"alignCenter"},{name:"alignRight"},{name:"alignJustify"},{name:"separator"},{name:"orderedList"},{name:"bulletList"},{name:"separator"},{name:"header",acceptedValues:[!1,1,2,3,4,5]},{name:"separator"},{name:"color"},{name:"background"}]},height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationEndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"}]}]}],E={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"}},form:{colCount:1,items:g,elementAttr:{class:"basic-form basic-form-edit"}}},O={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"}},form:{colCount:1,items:g,elementAttr:{class:"basic-form basic-form-edit"}}};var i=o(19212),P=o(67),x=o(72783),Z=o(69420),T=o(20481),J=o(65343),Q=o(49291),I=o(16358),_=o(20843),u=o(2173),y=o(25012),C=o(61157),S=o(53009);function w(e,s){1&e&&(i.TgZ(0,"span",7),i._uU(1,"\xa0*"),i.qZA())}function M(e,s){if(1&e){const t=i.EpF();i.TgZ(0,"div",8)(1,"div",9),i._uU(2),i.qZA(),i.TgZ(3,"div",10),i.NdJ("click",function(){const l=i.CHM(t).$implicit,r=i.oxw();return i.KtG(r.removeProvider(l.id))}),i.qZA()()}if(2&e){const t=s.$implicit;i.xp6(2),i.hij(" ",t.name," ")}}const G=e=>({"notification-tag-box-list--show":e});let F=(()=>{class e{constructor(t){this.appRestService=t,this.label="",this.required=!1,this.fetchUrl="",this.notificationTagBoxList=[],this.notificationTagBoxItems=[]}ngOnInit(){this.initCellInfoItem(),this.fetchNotificationTagBoxList()}onValueChanged(t){this.selectNotificationTagBoxItems(t.value)}initCellInfoItem(){this.label=this.cellInfo.item.label.text,this.required=this.cellInfo.column.validationRules&&"required"===this.cellInfo.column.validationRules[0].type}fetchNotificationTagBoxList(){switch(this.cellInfo.item.dataField){case"notificationProviderDefinitionIds":this.fetchUrl="/api/app/notification-infos/assignable-notification-provider-definitions";break;case"receiverIds":this.fetchUrl="/api/app/notification-infos/assignable-receivers"}this.appRestService.request({method:"GET",url:this.fetchUrl}).subscribe(t=>{this.notificationTagBoxList=t.items,this.initNotificationTagBoxItems()})}initNotificationTagBoxItems(){!this.cellInfo.value||!Array.isArray(this.cellInfo.value)||0===this.cellInfo.value.length||(this.notificationTagBoxItems=this.notificationTagBoxList.filter(t=>this.cellInfo.value.includes(t.id)))}selectNotificationTagBoxItems(t){this.notificationTagBoxItems=t;const n=this.notificationTagBoxItems.map(a=>a.id);this.cellInfo.setValue(n)}removeProvider(t){const n=this.notificationTagBoxItems.findIndex(a=>a.id===t);this.notificationTagBoxItems.splice(n,1)}static#i=this.\u0275fac=function(n){return new(n||e)(i.Y36(S.$))};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-notification-tag-box"]],inputs:{cellInfo:"cellInfo"},standalone:!0,features:[i.jDz],decls:10,vars:10,consts:[[1,"notification-tag-box"],[1,"notification-tag-box-label","dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],["class","dx-field-item-required-mark"],["appTagBox","","displayExpr","name","validationMessageMode","always","labelMode","outside","placeholder","\u9078\u64c7...",3,"dataSource","value","activeStateEnabled","focusStateEnabled","hoverStateEnabled","onValueChanged"],[1,"notification-tag-box-list",3,"ngClass"],[1,"dx-field-item-required-mark"],[1,"notification-tag-box-item"],[1,"notification-tag-box-item-name"],[1,"notification-tag-box-item-close",3,"click"],["class","notification-tag-box-item"]],template:function(n,a){1&n&&(i.TgZ(0,"div",0)(1,"label",1)(2,"span",2)(3,"span",3),i._uU(4),i.qZA(),i.YNc(5,w,2,0,"span",4),i.qZA()(),i.TgZ(6,"dx-tag-box",5),i.NdJ("onValueChanged",function(r){return a.onValueChanged(r)}),i.qZA(),i.TgZ(7,"div",6),i.SjG(8,M,4,1,"div",11,i.ikw),i.qZA()()),2&n&&(i.xp6(4),i.hij(" ",a.label," "),i.xp6(),i.um2(5,a.required?5:-1),i.xp6(),i.Q6J("dataSource",a.notificationTagBoxList)("value",a.notificationTagBoxItems)("activeStateEnabled",!1)("focusStateEnabled",!1)("hoverStateEnabled",!1),i.xp6(),i.Q6J("ngClass",i.VKq(8,G,a.notificationTagBoxItems.length)),i.xp6(),i.wJu(a.notificationTagBoxItems))},dependencies:[C._,C.U,f.vaR,d.ez,d.mk],styles:[".notification-tag-box{margin-top:16px}  .notification-tag-box-label{margin-bottom:8px}  .notification-tag-box-list{display:flex;flex-wrap:wrap;gap:16px}  .notification-tag-box-list--show{margin-top:16px}  .notification-tag-box-item{border-radius:16px;padding:4px 8px;background-color:var(--blue-2);display:flex;align-items:center;gap:4px;cursor:default}  .notification-tag-box-item:hover{box-shadow:1px 3px 3px #0000001a}  .notification-tag-box-item-close{content:url(remove-icon.17068bf6ca3a3713.svg)}"]})}return e})();var N=o(90962),R=o(98991),D=o(86359);let A=(()=>{class e{constructor(){this.selected=!0,this.notificationRadioButton=[]}ngOnInit(){this.initCellInfoItem()}initCellInfoItem(){return"isForAllReceivers"===this.cellInfo.item.dataField?this.initIsForAllReceivers():"isUsingSpecificNotificationSettings"===this.cellInfo.item.dataField?this.initIsUsingSpecificNotificationSettings():void 0}initIsForAllReceivers(){this.notificationRadioButton=[{name:"\u6240\u6709\u4eba",selected:!0},{name:"\u6307\u5b9a\u63a5\u6536\u8005",selected:!1}],(0!==this.cellInfo.data.receiverGroupIds.length||0!==this.cellInfo.data.receiverIds.length)&&(this.selected=this.cellInfo.value)}initIsUsingSpecificNotificationSettings(){this.notificationRadioButton=[{name:"\u5957\u7528\u5171\u7528\u8a2d\u5b9a",selected:!1},{name:"\u53e6\u884c\u8a2d\u5b9a",selected:!0}],this.selected=this.cellInfo.value}onValueChanged(t){this.cellInfo.setValue(t.value)}static#i=this.\u0275fac=function(n){return new(n||e)};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-notification-radio-button"]],inputs:{cellInfo:"cellInfo"},standalone:!0,features:[i.jDz],decls:1,vars:5,consts:[["appRadioGroup","","layout","horizontal","displayExpr","name","valueExpr","selected",3,"dataSource","value","activeStateEnabled","hoverStateEnabled","focusStateEnabled","onValueChanged"]],template:function(n,a){1&n&&(i.TgZ(0,"dx-radio-group",0),i.NdJ("onValueChanged",function(r){return a.onValueChanged(r)}),i.qZA()),2&n&&i.Q6J("dataSource",a.notificationRadioButton)("value",a.selected)("activeStateEnabled",!1)("hoverStateEnabled",!1)("focusStateEnabled",!1)},dependencies:[D._,D.I]})}return e})();var K=o(6990),L=o(40165);let k=(()=>{class e{constructor(){this.expressionInfos=[]}ngOnInit(){this.expressionInfos=(0,K.cloneDeep)(this.cellInfo.value||[])}onExpressionsChange(t){t.forEach(n=>{n.expectedEndTime=this.transformStringToDate(n.expectedEndTime),n.id=null}),this.cellInfo.setValue(t)}transformStringToDate(t){if(t)return new Date(t)}static#i=this.\u0275fac=function(n){return new(n||e)};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-notification-schedule-plans"]],inputs:{cellInfo:"cellInfo"},decls:1,vars:1,consts:[[3,"expressionInfos","expressionsChange"]],template:function(n,a){1&n&&(i.TgZ(0,"app-cron-expression-generator",0),i.NdJ("expressionsChange",function(r){return a.onExpressionsChange(r)}),i.qZA()),2&n&&i.Q6J("expressionInfos",a.expressionInfos)},dependencies:[L.D]})}return e})();const $=[{type:"buttons",fixed:!0},{name:"cronDescription",caption:"Cron \u63cf\u8ff0",dataType:"string",filterOperations:c.I.text,validationRules:[p.L]},{name:"pushCount",caption:"\u5df2\u63a8\u9001\u6b21\u6578",dataType:"number",filterOperations:c.I.number},{dataField:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean"}],j=[],Y=[{name:"cronDescription",mapping:["cronDescription"]},{name:"pushCount",mapping:["pushCount"]},{dataField:"isFinished",mapping:["isFinished"]}];var q=o(98179);const z=["grid"];function H(e,s){if(1&e){const t=i.EpF();i.TgZ(0,"div")(1,"dx-button",5),i.NdJ("onClick",function(){i.CHM(t);const a=i.oxw();return i.KtG(a.closePopup())}),i.qZA()()}}const X=()=>({toolbar:"bottom",template:"bottom-toolbar",location:"after"}),W=e=>[e];let ii=(()=>{class e{constructor(t,n){this.templateStore=t,this.appRestService=n,this.notificationId="",this.isDetailsTableVisible=!1,this.isDetailsTableVisibleChange=new i.vpe,this.columns=$,this.dataFieldLookupSourceMapping=j,this.relatedDataValueAndQueryStringKeyMapping=Y,this.gridProperties={editing:{allowDeleting:!1,allowUpdating:!1},pager:{visible:!1},filterRow:{visible:!1}},this.gridDataSource=[]}ngOnChanges(){this.loadPlanDetails()}loadPlanDetails(){this.isDetailsTableVisible&&this.notificationId&&this.appRestService.request({method:"GET",url:`/api/app/recurring-notification-infos/notification-schedule-plans/${this.notificationId}`}).subscribe(t=>{this.gridDataSource=[...t]})}closePopup(){this.isDetailsTableVisibleChange.emit(!1)}static#i=this.\u0275fac=function(n){return new(n||e)(i.Y36(x.z),i.Y36(S.$))};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-notification-schedule-plan-details"]],viewQuery:function(n,a){if(1&n&&i.Gf(z,5),2&n){let l;i.iGM(l=i.CRH())&&(a.grid=l.first)}},inputs:{notificationId:"notificationId",isDetailsTableVisible:"isDetailsTableVisible"},outputs:{isDetailsTableVisibleChange:"isDetailsTableVisibleChange"},features:[i.TTD],decls:6,vars:11,consts:[["title","\u6642\u9593\u8a08\u756b\u7d30\u7bc0",3,"visible","toolbarItems","visibleChange"],["appGridFeature","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","columns","dataSource","gridProperties"],["grid",""],["name","applyFilterButton","cssClass","d-none"],[4,"dxTemplate","dxTemplateOf"],["type","primary","text","\u95dc\u9589",3,"onClick"]],template:function(n,a){1&n&&(i.TgZ(0,"dx-popup",0),i.NdJ("visibleChange",function(r){return a.isDetailsTableVisible=r}),i.TgZ(1,"dx-data-grid",1,2)(3,"dxo-toolbar"),i._UZ(4,"dxi-item",3),i.qZA()(),i.YNc(5,H,2,0,"div",4),i.qZA()),2&n&&(i.Q6J("visible",a.isDetailsTableVisible)("toolbarItems",i.VKq(9,W,i.DdM(8,X))),i.xp6(),i.Q6J("datafieldValueQueryStringKeyMapping",a.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",a.dataFieldLookupSourceMapping)("columns",a.columns)("dataSource",a.gridDataSource)("gridProperties",a.gridProperties),i.xp6(4),i.Q6J("dxTemplateOf","bottom-toolbar"))},dependencies:[T._,I.K,_.p6,u.ZT3,q.x,y.e,u.y1f],encapsulation:2})}return e})();const ti=["grid"];function ei(e,s){if(1&e&&i._UZ(0,"app-grid-after-tool-bar",11),2&e){i.oxw();const t=i.MAs(1);i.Q6J("grid",t)}}function ni(e,s){1&e&&i.GkF(0)}const ai=e=>({$implicit:e});function oi(e,s){if(1&e&&(i.ynx(0),i.YNc(1,ni,1,0,"ng-container",13),i.BQk()),2&e){const t=s.$implicit,n=i.oxw().$implicit,a=i.oxw();i.xp6(),i.Q6J("ngTemplateOutlet",a.templateStore.getGridTemplates(n.key))("ngTemplateOutletContext",i.VKq(2,ai,t))}}function si(e,s){if(1&e&&(i.ynx(0),i.YNc(1,oi,2,4,"ng-container",12),i.BQk()),2&e){const t=s.$implicit;i.xp6(),i.Q6J("dxTemplateOf",t.key)}}function li(e,s){1&e&&i._UZ(0,"app-notification-tag-box",14),2&e&&i.Q6J("cellInfo",s.$implicit)}function ri(e,s){1&e&&i._UZ(0,"app-notification-radio-button",14),2&e&&i.Q6J("cellInfo",s.$implicit)}function ci(e,s){if(1&e&&i._UZ(0,"app-notification-tag-box",15),2&e){const t=s.$implicit,n=i.oxw();i.Q6J("cellInfo",t)("hidden",n.isForAllReceivers)}}function pi(e,s){if(1&e&&i._UZ(0,"app-receiver-group-tree-view",15),2&e){const t=s.$implicit,n=i.oxw();i.Q6J("cellInfo",t)("hidden",n.isForAllReceivers)}}function di(e,s){1&e&&i._UZ(0,"app-notification-radio-button",14),2&e&&i.Q6J("cellInfo",s.$implicit)}function fi(e,s){if(1&e&&i._UZ(0,"app-notification-setting-items",15),2&e){const t=s.$implicit,n=i.oxw();i.Q6J("cellInfo",t)("hidden",!n.isUsingSpecificNotificationSettings)}}function ui(e,s){1&e&&i._UZ(0,"app-notification-schedule-plans",14),2&e&&i.Q6J("cellInfo",s.$implicit)}function gi(e,s){if(1&e){const t=i.EpF();i.TgZ(0,"dx-button",16),i.NdJ("click",function(){const l=i.CHM(t).$implicit,r=i.oxw();return i.KtG(r.openDetailsTable(l.data.id))}),i.qZA()}}const mi=()=>({type:"default",stylingMode:"contained"}),hi=[{path:"",component:(()=>{class e{constructor(t,n,a){this.gridDataSourceService=t,this.templateStore=n,this.configStateService=a,this.columns=V,this.cRUDEndpoints=v,this.dataFieldLookupSourceMapping=U,this.relatedDataValueAndQueryStringKeyMapping=b,this.editingPropertiesForCreating=E,this.editingPropertiesForUpdating=O,this.isForAllReceivers=!0,this.isUsingSpecificNotificationSettings=!1,this.tenantId="",this.isDetailsTableVisible=!1,this.notificationId=""}ngOnInit(){this.gridDataSource=this.gridDataSourceService.getDataSource(v,b),this.configStateService.getOne$("currentUser").subscribe(t=>{this.tenantId=t.tenantId})}onInitNewRow(t){t.data.tenantId=this.tenantId,t.data.isForAllReceivers=!0,t.data.isUsingSpecificNotificationSettings=!1,t.data.isFetchNotificationDataByEachReceiver=!1,t.data.receiverIds=[],t.data.receiverGroupIds=[]}onRowValidating(t){console.log(t),t.isValid=!1,this.validateIsForAllReceivers(t)}onOptionChanged(t){"editing.changes"!==t.fullName&&"editing.editRowKey"!==t.fullName||"object"!=typeof t.value||!t.value||Array.isArray(t.value)&&0===t.value.length||(this.checkIsForAllReceivers(t),this.checkIsUsingSpecificNotificationSettings(t))}checkIsForAllReceivers(t){"editing.changes"===t.fullName&&!("isForAllReceivers"in t.value[0].data)||"editing.editRowKey"===t.fullName&&!("isForAllReceivers"in t.value)||"editing.changes"===t.fullName&&this.isForAllReceivers===t.value[0].data.isForAllReceivers||"editing.editRowKey"===t.fullName&&this.isForAllReceivers===t.value.isForAllReceivers||(this.isForAllReceivers="editing.changes"===t.fullName?t.value[0].data.isForAllReceivers:t.value.isForAllReceivers)}checkIsUsingSpecificNotificationSettings(t){"editing.changes"===t.fullName&&!("isUsingSpecificNotificationSettings"in t.value[0].data)||"editing.editRowKey"===t.fullName&&!("isUsingSpecificNotificationSettings"in t.value)||"editing.changes"===t.fullName&&this.isUsingSpecificNotificationSettings===t.value[0].data.isUsingSpecificNotificationSettings||"editing.editRowKey"===t.fullName&&this.isUsingSpecificNotificationSettings===t.value.isUsingSpecificNotificationSettings||(this.isUsingSpecificNotificationSettings="editing.changes"===t.fullName?t.value[0].data.isUsingSpecificNotificationSettings:t.value.isUsingSpecificNotificationSettings)}validateIsForAllReceivers(t){!t.newData.isForAllReceivers||(t.newData.receiverIds=[],t.newData.receiverGroupIds=[],!t.brokenRules.find(a=>"custom"===a.type&&"receiverTagBoxValidationCallback"===a.validationCallback.name)||1!==t.brokenRules.length)||(t.isValid=!0)}resetOption(){this.isForAllReceivers=!0,this.isUsingSpecificNotificationSettings=!1}openDetailsTable(t){this.isDetailsTableVisible=!0,this.notificationId=t}static#i=this.\u0275fac=function(n){return new(n||e)(i.Y36(P.I),i.Y36(x.z),i.Y36(f.XJE))};static#t=this.\u0275cmp=i.Xpm({type:e,selectors:[["app-recurring-notification-infos"]],viewQuery:function(n,a){if(1&n&&i.Gf(ti,5),2&n){let l;i.iGM(l=i.CRH())&&(a.grid=l.first)}},decls:18,vars:22,consts:[["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","onEditCanceled","onRowInserted","onInitNewRow","onOptionChanged","onRowValidating"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hidden",4,"dxTemplate","dxTemplateOf"],["appGridViewButton","",3,"click",4,"dxTemplate","dxTemplateOf"],[3,"isDetailsTableVisible","notificationId","isDetailsTableVisibleChange"],[3,"grid"],[4,"dxTemplate","dxTemplateOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"cellInfo"],[3,"cellInfo","hidden"],["appGridViewButton","",3,"click"]],template:function(n,a){1&n&&(i.TgZ(0,"dx-data-grid",0,1),i.NdJ("onEditCanceled",function(){return a.resetOption()})("onRowInserted",function(){return a.resetOption()})("onInitNewRow",function(r){return a.onInitNewRow(r)})("onOptionChanged",function(r){return a.onOptionChanged(r)})("onRowValidating",function(r){return a.onRowValidating(r)}),i.TgZ(2,"dxo-toolbar"),i._UZ(3,"dxi-item",2),i.TgZ(4,"dxi-item",3),i.YNc(5,ei,1,1,"app-grid-after-tool-bar",4),i.qZA(),i._UZ(6,"dxi-item",5),i.qZA(),i.YNc(7,si,2,1,"ng-container",6),i.ALo(8,"keyvalue"),i.YNc(9,li,1,1,"app-notification-tag-box",7)(10,ri,1,1,"app-notification-radio-button",7)(11,ci,1,2,"app-notification-tag-box",8)(12,pi,1,2,"app-receiver-group-tree-view",8)(13,di,1,1,"app-notification-radio-button",7)(14,fi,1,2,"app-notification-setting-items",8)(15,ui,1,1,"app-notification-schedule-plans",7)(16,gi,1,0,"dx-button",9),i.qZA(),i.TgZ(17,"app-notification-schedule-plan-details",10),i.NdJ("isDetailsTableVisibleChange",function(r){return a.isDetailsTableVisible=r}),i.qZA()),2&n&&(i.Q6J("datafieldValueQueryStringKeyMapping",a.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",a.dataFieldLookupSourceMapping)("editingPropertiesForCreating",a.editingPropertiesForCreating)("editingPropertiesForUpdating",a.editingPropertiesForUpdating)("columns",a.columns)("dataSource",a.gridDataSource)("isEditingDataAsync",!0),i.xp6(3),i.Q6J("options",i.DdM(21,mi)),i.xp6(4),i.Q6J("ngForOf",i.lcZ(8,19,a.templateStore.gridTemplates)),i.xp6(2),i.Q6J("dxTemplateOf","notificationProviders"),i.xp6(),i.Q6J("dxTemplateOf","isForAllReceivers"),i.xp6(),i.Q6J("dxTemplateOf","receiverIds"),i.xp6(),i.Q6J("dxTemplateOf","receiverGroupIds"),i.xp6(),i.Q6J("dxTemplateOf","isUsingSpecificNotificationSettings"),i.xp6(),i.Q6J("dxTemplateOf","notification-setting-items"),i.xp6(),i.Q6J("dxTemplateOf","notification-schedule-plans"),i.xp6(),i.Q6J("dxTemplateOf","grid-schedule-plans-button"),i.xp6(),i.Q6J("isDetailsTableVisible",a.isDetailsTableVisible)("notificationId",a.notificationId))},dependencies:[d.sg,d.tP,Z.p,T._,J.f,Q.V,I.K,_.p6,u.ZT3,y.e,u.y1f,F,N.b,R.D,A,k,ii,d.Nd],encapsulation:2})}return e})(),canActivate:[f.a1M,f.nG9]}];let vi=(()=>{class e{static#i=this.\u0275fac=function(n){return new(n||e)};static#t=this.\u0275mod=i.oAB({type:e});static#e=this.\u0275inj=i.cJS({imports:[h.Bz.forChild(hi),h.Bz]})}return e})();var bi=o(38653),xi=o(36744),Ti=o(77490),Ii=o(68862),_i=o(60752);let yi=(()=>{class e{static#i=this.\u0275fac=function(n){return new(n||e)};static#t=this.\u0275mod=i.oAB({type:e});static#e=this.\u0275inj=i.cJS({imports:[d.ez,vi,B.m,Ti.P,Ii.O,_i.j,F,bi.k,xi.b,N.b,R.D,A]})}return e})()}}]);