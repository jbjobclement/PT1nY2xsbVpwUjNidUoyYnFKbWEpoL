"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[87845],{87845:(st,g,n)=>{n.r(g),n.d(g,{CronExpressionsJobListModule:()=>at});var d=n(96814),m=n(23758),r=n(35461),c=n(85054);const T=[{type:"buttons",fixed:!0,buttons:[{name:"delete",template:"grid-delete-button",visible:e=>e.row.data.isDeletable}]},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:r.I.text},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:r.I.text},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:r.I.text,validationRules:[c.L]},{name:"notificationProviders",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:r.I.text,calculateDisplayValue:e=>e.notificationProviders?.map(s=>s.displayName).join("\u3001")},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:r.I.text},{type:"detailExpand",fixed:!0,fixedPosition:"right"},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:r.I.text,visible:!1},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:r.I.text,visible:!1},{name:"isFullyFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",dataType:"boolean",visible:!1},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"notificationProviderIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviderIds",validationRules:[c.L]},{dataField:"isSendToAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isSendToAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"topicIds",caption:"\u4e3b\u984c (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"topicIds"},{dataField:"isIndependentNotificationSettingUsing",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettings"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"filePaths",dataType:"string",visible:!1},{dataField:"hyperlink",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"textContentNotificationTemplateId",caption:"\u901a\u77e5\u6a21\u677f Id",dataType:"string",visible:!1},{dataField:"textContentNotificationTemplateArgs",caption:"\u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"textContentNotificationTemplateArgs"}],C={index:"/api/app/jbnotifier-admin/cron-expressions/notifications",get:"/api/app/jbnotifier-admin/cron-expressions/notifications",create:"/api/app/jbnotifier-admin/cron-expressions/notifications",update:"/api/app/jbnotifier-admin/cron-expressions/notifications",delete:"/api/app/jbnotifier-admin/cron-expressions/notifications"},b=[{dataField:"notificationProviderIds",path:"/api/app/recurring-notifications/notification-provider-lookup"},{dataField:"receiverIds",path:"/api/app/recurring-notifications/receiver-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receivers"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receiver-groups"},{dataField:"topicIds",path:"/api/app/recurring-notifications/topic-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/topics"},{dataField:"textContentNotificationTemplateId",path:"/api/app/recurring-notifications/notification-template-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/notification-templates"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app//receiver-groups"},{dataField:"notificationCategoryId",path:"/api/app/recurring-notifications/notification-category-lookup",pathForSelectedDisplay:"/api/app/notification-categories"}],u=[{dataField:"id",mapping:["notificationInfo","id"]},{dataField:"concurrencyStamp",mapping:["notificationInfo","concurrencyStamp"]},{dataField:"type",mapping:["notificationInfo","type"]},{dataField:"title",queryStringKey:"Title",mapping:["notificationInfo","title"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategory","name"]},{name:"notificationProviders",queryStringKey:"NotificationProviderNames",mapping:["notificationProviders"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["notificationInfo","hookEndpoint"]},{name:"isFullyFinished",queryStringKey:"IsFullyFinished",mapping:["notificationInfo","isFullyFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderIds",mapping:["notificationProviderIds"]},{dataField:"isSendToAllReceivers",mapping:["notificationInfo","isSendToAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"topicIds",mapping:["topicIds"]},{dataField:"isIndependentNotificationSettingUsing",mapping:["notificationInfo","isIndependentNotificationSettingUsing"]},{dataField:"notificationSettings",mapping:["notificationSettings"]},{dataField:"notificationCategoryId",mapping:["notificationCategory","id"]},{dataField:"subtitle",mapping:["notificationInfo","subtitle"]},{dataField:"textContent",mapping:["notificationInfo","textContent"]},{dataField:"htmlContent",mapping:["notificationInfo","htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["notificationInfo","isFetchNotificationDataByEachReceiver"]},{dataField:"filePaths",mapping:["notificationInfo","filePaths"]},{dataField:"hyperlink",mapping:["notificationInfo","hyperlink"]},{dataField:"textContentNotificationTemplateId",mapping:["textContentNotificationTemplate","id"]},{dataField:"htmlContentNotificationTemplateId",mapping:["htmlContentNotificationTemplate","id"]},{dataField:"textContentNotificationTemplateArgs",mapping:["notificationInfo","textContentNotificationTemplateArgs"]},{dataField:"htmlContentNotificationTemplateArgs",mapping:["notificationInfo","htmlContentNotificationTemplateArgs"]},{name:"notificationSchedulePlan",mapping:["notificationSchedulePlan"]}],f=[{itemType:"group",name:"TopGroup",cssClass:"TopGroup",colCount:8,items:[{itemType:"group",name:"BasicGroup",cssClass:"BasicGroup",caption:"\u57fa\u672c",colSpan:5,items:[{dataField:"notificationProviderIds",label:{visible:!1}},{dataField:"isSendToAllReceivers",cssClass:"isSendToAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}},{dataField:"topicIds",label:{visible:!1}}]},{itemType:"group",name:"SettingGroup",cssClass:"SettingGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",label:{visible:!1}}]}]},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",cssClass:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...n(35130).W,height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"textContentNotificationTemplateId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"textContentNotificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"EndpointGroup",cssClass:"EndpointGroup",colSpan:2,colCount:3,items:[{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"},{dataField:"filePaths",editorType:"dxTextBox"},{dataField:"hyperlink",editorType:"dxTextBox"},{itemType:"empty"},{dataField:"expectedPushCount",editorType:"dxNumberBox",editorOptions:{min:0}},{dataField:"expectedEndTime",editorType:"dxDateBox",editorOptions:{dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss.SSS+08:00"}}]}]}],v={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:f,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}},h={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:f,elementAttr:{class:"custom-form custom-form--edit custom-form--edit-notification"}}};var t=n(19212),I=n(67),_=n(72783),S=n(82310),E=n(16358),N=n(20843),x=n(2173),D=n(25012),A=n(67846),J=n(39150),P=n(65343),L=n(27310),R=n(92931),G=n(60237);const k=["grid"];function w(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"dx-button",10),t.NdJ("onClick",function(){t.CHM(i),t.oxw();const o=t.MAs(1);return t.KtG(o.instance.addRow())}),t.qZA()}}function B(e,s){if(1&e&&t._UZ(0,"app-grid-after-tool-bar",11),2&e){t.oxw();const i=t.MAs(1);t.Q6J("grid",i)}}const O=()=>({class:"custom-button"});function M(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"dx-button",12),t.NdJ("onClick",function(){t.CHM(i),t.oxw();const o=t.MAs(1);return t.KtG(o.instance.cancelEditData())}),t.qZA()()}2&e&&(t.xp6(),t.Q6J("elementAttr",t.DdM(1,O)))}function K(e,s){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-bottom-toolbar-btns",11),t.qZA()),2&e){t.oxw();const i=t.MAs(1);t.xp6(),t.Q6J("grid",i)}}function Q(e,s){1&e&&t.GkF(0)}const y=e=>({$implicit:e});function j(e,s){if(1&e&&(t.ynx(0),t.YNc(1,Q,1,0,"ng-container",9),t.BQk()),2&e){const i=s.$implicit,a=t.oxw().$implicit,o=t.oxw();t.xp6(),t.Q6J("ngTemplateOutlet",o.templateStore.getGridTemplates(a.key))("ngTemplateOutletContext",t.VKq(2,y,i))}}function U(e,s){if(1&e&&(t.ynx(0),t.YNc(1,j,2,4,"ng-container",7),t.BQk()),2&e){const i=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",i.key)}}function Z(e,s){1&e&&t.GkF(0)}const Y=(e,s,i)=>({$implicit:e,templateKey:s,notificationTemplateId:i});function $(e,s){if(1&e&&t.YNc(0,Z,1,0,"ng-container",9),2&e){const i=t.oxw().$implicit,a=t.oxw().$implicit,o=t.oxw();t.Q6J("ngTemplateOutlet",o.notificationTemplateStore.getTemplates(a.key))("ngTemplateOutletContext",t.kEZ(2,Y,i,a.key,o.notificationTemplateId))}}function V(e,s){1&e&&t.GkF(0)}const H=(e,s)=>({$implicit:e,templateKey:s});function z(e,s){if(1&e&&t.YNc(0,V,1,0,"ng-container",9),2&e){const i=t.oxw().$implicit,a=t.oxw().$implicit,o=t.oxw();t.Q6J("ngTemplateOutlet",o.notificationTemplateStore.getTemplates(a.key))("ngTemplateOutletContext",t.WLB(2,H,i,a.key))}}function W(e,s){if(1&e&&(t.ynx(0),t.YNc(1,$,1,6,"ng-container")(2,z,1,5),t.BQk()),2&e){const i=t.oxw().$implicit;t.xp6(),t.um2(1,"textContentNotificationTemplateArgs"===i.key?1:2)}}function X(e,s){if(1&e&&(t.ynx(0),t.YNc(1,W,3,1,"ng-container",7),t.BQk()),2&e){const i=s.$implicit;t.xp6(),t.Q6J("dxTemplateOf",i.key)}}function q(e,s){1&e&&t.GkF(0)}const tt=[{path:"",component:(()=>{class e{constructor(i,a,o,p){this.route=i,this.gridDataSourceService=a,this.templateStore=o,this.notificationTemplateStore=p,this.columns=T,this.cRUDEndpoints=C,this.dataFieldLookupSourceMapping=b,this.relatedDataValueAndQueryStringKeyMapping=u,this.editingPropertiesForCreating=v,this.editingPropertiesForUpdating=h,this.gridProperties={masterDetail:{enabled:!0,template:"basic-master-detail-row-template"}},this.rowExpanded=l=>{this.applyyNotificationMasterDetailRowCollapse(l)}}ngOnInit(){this.route.paramMap.subscribe(i=>{this.cronExpression=i.get("cronExpression")}),this.gridDataSource=this.gridDataSourceService.getDataSource({index:`/api/app/jbnotifier-admin/cron-expressions/${this.cronExpression}/notifications`,create:"/api/app/jbnotifier-admin/cron-expressions/notifications",delete:"/api/app/jbnotifier-admin/cron-expressions/notifications"},u)}onInitNewRow(i){i.data.cronExpression=this.cronExpression}ngAfterViewInit(){this.grid.instance.on("rowExpanded",this.rowExpanded)}applyyNotificationMasterDetailRowCollapse(i){setTimeout(()=>{const o=i.element.querySelector('[aria-label="Collapse"]').parentElement.ariaRowIndex;i.element.querySelector(`tr.dx-row.dx-data-row.dx-row-lines[aria-rowindex="${o}"]`).classList.add("master-detail-row-collapse")}),i.key!==this.masterDetailRowCollapseKey&&(i.component.collapseRow(this.masterDetailRowCollapseKey),this.masterDetailRowCollapseKey=i.key)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(m.gz),t.Y36(I.I),t.Y36(_.z),t.Y36(S.P))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-cron-expressions-job-list"]],viewQuery:function(a,o){if(1&a&&t.Gf(k,5),2&a){let p;t.iGM(p=t.CRH())&&(o.grid=p.first)}},decls:15,vars:21,consts:[["appGridFeature","","appGridFeatureNotification","",3,"datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","isEditingDataAsync","gridProperties","notificationTemplateId","notificationTemplateIdChange","onInitNewRow"],["grid",""],["location","before"],["appGridAddButton","",3,"onClick",4,"dxTemplate"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"dxTemplate","dxTemplateOf"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["appGridAddButton","",3,"onClick"],[3,"grid"],["appCustomButton","","text","\u95dc\u9589",3,"elementAttr","onClick"]],template:function(a,o){if(1&a&&(t.TgZ(0,"dx-data-grid",0,1),t.NdJ("notificationTemplateIdChange",function(l){return o.notificationTemplateId=l})("onInitNewRow",function(l){return o.onInitNewRow(l)}),t.TgZ(2,"dxo-toolbar")(3,"dxi-item",2),t.YNc(4,w,1,0,"dx-button",3),t.qZA(),t.TgZ(5,"dxi-item",4),t.YNc(6,B,1,1,"app-grid-after-tool-bar",5),t.qZA(),t._UZ(7,"dxi-item",6),t.qZA(),t.YNc(8,M,2,2,"div",7)(9,K,2,1,"div",7)(10,U,2,1,"ng-container",8),t.ALo(11,"keyvalue"),t.YNc(12,X,2,1,"ng-container",8),t.ALo(13,"keyvalue"),t.qZA(),t.YNc(14,q,1,0,"ng-container",9)),2&a){const p=t.MAs(1);t.Q6J("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("editingPropertiesForCreating",o.editingPropertiesForCreating)("editingPropertiesForUpdating",o.editingPropertiesForUpdating)("columns",o.columns)("dataSource",o.gridDataSource)("isEditingDataAsync",!0)("gridProperties",o.gridProperties)("notificationTemplateId",o.notificationTemplateId),t.xp6(8),t.Q6J("dxTemplateOf","bottom-toolbar-readonly"),t.xp6(),t.Q6J("dxTemplateOf","bottom-toolbar"),t.xp6(),t.Q6J("ngForOf",t.lcZ(11,15,o.templateStore.gridTemplates)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(13,17,o.notificationTemplateStore.templates)),t.xp6(2),t.Q6J("ngTemplateOutlet",o.notificationTemplateStore.getTemplates("notificationPager"))("ngTemplateOutletContext",t.VKq(19,y,p))}},dependencies:[d.sg,d.tP,E.K,N.p6,x.ZT3,D.e,x.y1f,A.S,J._,P.f,L.A,R.R,G.V,d.Nd]})}return e})()}];let et=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(tt),m.Bz]})}return e})();var it=n(5533),ot=n(31610),nt=n(41992);let at=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#i=this.\u0275inj=t.cJS({imports:[d.ez,it.P,et,ot.m,nt.e]})}return e})()}}]);