"use strict";(self.webpackChunkJbNotifier=self.webpackChunkJbNotifier||[]).push([[49226],{49226:(je,y,s)=>{s.r(y),s.d(y,{CronExpressionsModule:()=>Le});var d=s(96814),C=s(23758);const U=[{type:"buttons",fixed:!0,caption:"\u64cd\u4f5c",buttons:[{name:"job-list",template:"job-list"}]},{dataField:"id",visible:!1},{dataField:"notificationSchedulePlanId ",visible:!1},{dataField:"cronExpression",caption:"Cron\u8868\u793a\u5f0f",dataType:"string"},{dataField:"description",caption:"Cron\u63cf\u8ff0",dataType:"string"},{dataField:"notificationCount",caption:"\u901a\u77e5\u6578\u91cf",dataType:"number"}],b={index:"/api/app/jbnotifier-admin/cron-expressions",get:"/api/app/jbnotifier-admin/cron-expressions",create:"/api/app/jbnotifier-admin/cron-expressions",update:"/api/app/jbnotifier-admin/cron-expressions",delete:"/api/app/jbnotifier-admin/cron-expressions"},V=[{dataField:"tenantId",path:"/api/identity/customize-users/assignable-tenants",pathForSelectedDisplay:"/api/saas/customize-tenants"}],B=[{name:"tenantName",translateKeys:["Saas::DisplayName:TenantName"]},{dataField:"startDate",translateKeys:["AbpAuditLogging::StartDate"]},{dataField:"endDate",translateKeys:["AbpAuditLogging::EndDate"]},{name:"status",translateKeys:["AbpAccount::Status"]}],F=[{dataField:"id",mapping:["cronExpression","id"]},{dataField:"id",mapping:["cronExpression","id"]},{dataField:"cronExpression",queryStringKey:"CronExpression",mapping:["cronExpression","id"]},{dataField:"description",queryStringKey:"Description",mapping:["cronExpression","description"]},{dataField:"notificationCount",queryStringKey:"NotificationCount",mapping:["notificationCount"]},{dataField:"concurrencyStamp",mapping:["apiKey","concurrencyStamp"]}];var c=s(85054);const S=[{dataField:"id",editorType:"dxTextBox",validationRules:[{type:"pattern",pattern:/^(\*|([0-9]|1[0-9]|2[0-3]))(\/\d+)?(\s+(\*|([0-9]|[1-5][0-9]))(\/\d+)?){4}$/,message:"\u683c\u5f0f\u4e0d\u6b63\u78ba!"},c.L],colSpan:1},{dataField:"description",editorType:"dxTextBox",editorOptions:{disabled:!0},colSpan:1}],w={popup:{title:"\u65b0\u589e"},form:{colCount:2,items:S}},Z={popup:{title:"\u7de8\u8f2f"},form:{colCount:2,items:S}};var G=s(10708),e=s(19212),I=s(67),D=s(72783),E=s(53009),L=s(59444),K=s(16358),N=s(20843),m=s(2173),P=s(25012),J=s(44347),R=s(10313),u=s(61157),g=s(88762);function j(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3),e._uU(2),e.qZA(),e.TgZ(3,"div",4),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.removeProvider(r.id))}),e.qZA()()}if(2&i){const t=a.$implicit;e.xp6(2),e.hij(" ",t.name," ")}}let v=(()=>{class i{constructor(t){this.appRestService=t,this.notificationProviderDefinitions=[],this.notificationProviders=[]}ngOnInit(){this.fetchNotificationProviderDefinitions()}onValueChanged(t){this.selectNotificationProvidersId(t.value)}fetchNotificationProviderDefinitions(){this.appRestService.request({method:"GET",url:"/api/app/notification-infos/assignable-notification-provider-definitions"}).subscribe(t=>{this.notificationProviderDefinitions=t.items,this.initNotificationProviders()})}initNotificationProviders(){!this.cellInfo.value||!Array.isArray(this.cellInfo.value)||0===this.cellInfo.value.length||(this.notificationProviders=this.notificationProviderDefinitions.filter(t=>this.cellInfo.value.includes(t.id)))}selectNotificationProvidersId(t){this.notificationProviders=t;const n=this.notificationProviders.map(o=>o.id);this.cellInfo.setValue(n)}removeProvider(t){const n=this.notificationProviders.findIndex(o=>o.id===t);this.notificationProviders.splice(n,1)}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(E.$))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-notification-provider-definitions"]],inputs:{cellInfo:"cellInfo"},standalone:!0,features:[e.jDz],decls:5,vars:5,consts:[["appTagBox","","displayExpr","name","validationMessageMode","always","labelMode","outside","placeholder","\u9078\u64c7...",3,"dataSource","value","activeStateEnabled","focusStateEnabled","hoverStateEnabled","onValueChanged"],[1,"notification-providers"],[1,"notification-provider"],[1,"notification-provider-name"],[1,"notification-provider-close",3,"click"],["class","notification-provider"]],template:function(n,o){1&n&&(e.TgZ(0,"div")(1,"dx-tag-box",0),e.NdJ("onValueChanged",function(p){return o.onValueChanged(p)}),e.qZA(),e.TgZ(2,"div",1),e.SjG(3,j,4,1,"div",5,e.ikw),e.qZA()()),2&n&&(e.xp6(),e.Q6J("dataSource",o.notificationProviderDefinitions)("value",o.notificationProviders)("activeStateEnabled",!1)("focusStateEnabled",!1)("hoverStateEnabled",!1),e.xp6(2),e.wJu(o.notificationProviders))},dependencies:[u._,u.U,g.vaR],styles:[".notification-providers[_ngcontent-%COMP%]{margin-top:16px;display:flex;flex-wrap:wrap;gap:16px}.notification-provider[_ngcontent-%COMP%]{border-radius:16px;padding:4px 8px;background-color:var(--blue-2);display:flex;align-items:center;gap:4px;cursor:default}.notification-provider[_ngcontent-%COMP%]:hover{box-shadow:1px 3px 3px #0000001a}.notification-provider-close[_ngcontent-%COMP%]{content:url(remove-icon.17068bf6ca3a3713.svg)}"]})}return i})();var $=s(37398),A=s(31610),k=s(24106);let x=(()=>{class i{constructor(t,n){this.restService=t,this.localizationService=n,this.isViewMode=!1,this.hideReceiverTagBox=!1,this.receiversDataSource$=null,this.currentDataField="",this.receivers=[]}ngOnChanges(t){window.component=this,!this.hideReceiverTagBox&&this.receivers.length>0&&this.cellInfo.setValue([...this.receivers])}ngOnInit(){this.currentDataField=this.cellInfo.column.dataField,this.cellInfo.column.validationRules=[{type:"custom",message:this.localizationService.instant("AbpValidation::ThisFieldIsRequired."),validationCallback:this.receiverTagBoxValidationCallback}],this.receiversDataSource$=this.restService.request({method:"GET",url:"/api/app/notification-infos/assignable-receivers"}).pipe((0,$.U)(t=>t.items))}onValueChanged(t){this.receivers=[...t.value],this.cellInfo.setValue(t.value)}receiverTagBoxValidationCallback(t){return!!(t.data.isForAllReceivers||t.data[t.column.dataField]&&0!==t.data[t.column.dataField].length)}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(g.vgb),e.Y36(g.oQ8))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-receiver-tag-box"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode",hideReceiverTagBox:"hideReceiverTagBox"},standalone:!0,features:[e.TTD,e.jDz],decls:7,vars:6,consts:[[3,"hidden"],[1,"dx-field-item-label","dx-field-item-label-location-top"],[1,"dx-field-item-label-content"],[1,"dx-field-item-label-text"],["appTagBox","","receiverTagBox","","displayExpr","name","valueExpr","id","validationMessageMode","always",3,"dataSource","value","disabled","onValueChanged"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"label",1)(2,"span",2)(3,"span",3),e._uU(4," \u63a5\u6536\u8005 (\u591a\u7b46) "),e.qZA()()(),e.TgZ(5,"dx-tag-box",4),e.NdJ("onValueChanged",function(p){return o.onValueChanged(p)}),e.ALo(6,"async"),e.qZA()()),2&n&&(e.Q6J("hidden",o.hideReceiverTagBox),e.xp6(5),e.Q6J("dataSource",e.lcZ(6,4,o.receiversDataSource$))("value",o.cellInfo.value)("disabled",o.isViewMode))},dependencies:[u._,u.U,d.ez,d.Ov,A.m,k.x],styles:["dx-tag-box[apptagbox][receiverTagBox] .dx-overlay-wrapper.dx-invalid-message.dx-invalid-message-always{width:100%!important}"]})}return i})();var Q=s(86359);let _=(()=>{class i{constructor(){this.isViewMode=!1,this.notificationSettingRadioGroupDataSource=[],this.notificationSettingRadioGroupValue=null}ngOnInit(){this.notificationSettingRadioGroupDataSource=[{type:"share",text:"\u5957\u7528\u5171\u7528\u8a2d\u5b9a"},{type:"custom",text:"\u53e6\u884c\u8a2d\u5b9a"}],this.notificationSettingRadioGroupValue=this.notificationSettingRadioGroupDataSource[0]}onNotificationSettingRadioGroupChanged(t){this.cellInfo.setValue("share"===t.value.type?"share":"custom")}static#e=this.\u0275fac=function(n){return new(n||i)};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-notification-setting-items-radio-group"]],inputs:{cellInfo:"cellInfo",isViewMode:"isViewMode"},standalone:!0,features:[e.jDz],decls:2,vars:3,consts:[["displayExpr","text","layout","horizontal",3,"dataSource","value","readOnly","valueChange","onValueChanged"],["radioGroup",""]],template:function(n,o){1&n&&(e.TgZ(0,"dx-radio-group",0,1),e.NdJ("valueChange",function(p){return o.notificationSettingRadioGroupValue=p})("onValueChanged",function(p){return o.onNotificationSettingRadioGroupChanged(p)}),e.qZA()),2&n&&e.Q6J("dataSource",o.notificationSettingRadioGroupDataSource)("value",o.notificationSettingRadioGroupValue)("readOnly",o.isViewMode)},dependencies:[Q._,Q.I]})}return i})();var h=s(90962),O=s(10932),Y=s(21194),z=s(98877),l=s(35461);const H=[{type:"buttons",fixed:!0,buttons:[{name:"delete",template:"grid-delete-button",visible:i=>i.row.data.isDeletable}]},{dataField:"notificationSchedulePlanId",visible:!1},{dataField:"id",visible:!1},{dataField:"concurrencyStamp",visible:!1},{name:"tenantName",caption:"\u79df\u6236\u540d\u7a31",dataType:"string",filterOperations:l.I.text},{dataField:"name",caption:"\u901a\u77e5\u540d\u7a31",dataType:"string",filterOperations:l.I.text},{name:"notificationProviders",caption:"\u901a\u77e5\u63d0\u4f9b\u8005\u540d\u7a31 (\u591a\u7b46)",dataType:"string",filterOperations:l.I.text,calculateDisplayValue:i=>i.notificationProviders?.map(a=>a.displayName).join("\u3001")},{name:"notificationCategoryName",caption:"\u5206\u985e\u540d\u7a31",dataType:"string",filterOperations:l.I.text},{dataField:"title",caption:"\u6a19\u984c",dataType:"string",filterOperations:l.I.text,validationRules:[c.L]},{name:"receiverDescription",caption:"\u63a5\u6536\u8005\u63cf\u8ff0",dataType:"string",filterOperations:l.I.text},{dataField:"notificationDataFetchEndpoint",caption:"\u53d6\u5f97\u901a\u77e5\u8cc7\u6599 Endpoint",dataType:"string",filterOperations:l.I.text},{dataField:"hookEndpoint",caption:"Hook",dataType:"string",filterOperations:l.I.text},{name:"isDeletable",caption:"\u662f\u5426\u53ef\u522a\u9664",dataType:"boolean",visible:!1},{name:"isEditable",caption:"\u662f\u5426\u53ef\u7de8\u8f2f",dataType:"boolean",visible:!1},{dataField:"notificationProviderIds",caption:"\u901a\u77e5\u63d0\u4f9b\u8005id (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"notificationProviderIds",validationRules:[c.L]},{dataField:"isSendToAllReceivers",caption:"\u63a5\u6536\u8005",dataType:"boolean",visible:!1,editCellTemplate:"isSendToAllReceivers"},{dataField:"receiverIds",caption:"\u63a5\u6536\u8005 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverIds"},{dataField:"receiverGroupIds",caption:"\u63a5\u6536\u7fa4\u7d44 (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"receiverGroupIds"},{dataField:"topicIds",caption:"\u4e3b\u984c (\u53ef\u8907\u9078)",dataType:"object",visible:!1,editCellTemplate:"topicIds"},{dataField:"isIndependentNotificationSettingUsing",caption:"\u901a\u77e5\u8a2d\u5b9a",dataType:"boolean",visible:!1,editCellTemplate:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",caption:"\u901a\u77e5\u8a2d\u5b9a\u9805\u76ee",dataType:"object",visible:!1,editCellTemplate:"notificationSettings"},{dataField:"notificationSchedulePlans",caption:"\u91cd\u8907\u6642\u9593\u8a08\u756b",dataType:"object",visible:!1,editCellTemplate:"recurringNotificationSchedulePlans"},{dataField:"notificationCategoryId",caption:"\u901a\u77e5\u5206\u985e Id",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"subtitle",caption:"\u5b50\u6a19\u984c",dataType:"string",visible:!1,validationRules:[c.L]},{dataField:"textContent",caption:"\u6587\u5b57\u5167\u5bb9",dataType:"string",visible:!1},{dataField:"htmlContent",caption:"Html \u5167\u5bb9",dataType:"string",visible:!1},{dataField:"isFetchNotificationDataByEachReceiver",caption:"\u662f\u5426\u4f9d\u5404\u901a\u77e5\u63a5\u6536\u8005\u53d6\u5f97\u8cc7\u6599",dataType:"string",visible:!1},{dataField:"filePaths",dataType:"string",visible:!1},{dataField:"hyperlink",dataType:"string",visible:!1},{dataField:"isUsingTemplate",caption:"\u6a21\u677f",dataType:"boolean",visible:!1,editCellTemplate:"isUsingTemplate"},{dataField:"textContentNotificationTemplateId",caption:"\u901a\u77e5\u6a21\u677f Id",dataType:"string",visible:!1},{dataField:"textContentNotificationTemplateArgs",caption:"text content \u901a\u77e5\u6a21\u677f\u53c3\u6578",dataType:"string",visible:!1,editCellTemplate:"textContentNotificationTemplateArgs"},{dataField:"expectedEndTime",caption:"\u9810\u671f\u7d50\u675f\u6642\u9593",setCellValue(i,a,t){i.expectedEndTime=a,i.expectedPushCount=null},dataType:"datetime",format:z.rQ},{dataField:"expectedPushCount",caption:"\u9810\u671f\u767c\u9001\u6b21\u6578",setCellValue(i,a,t){i.expectedPushCount=a,i.expectedEndTime=null},dataType:"number"},{name:"isFinished",caption:"\u662f\u5426\u5df2\u5b8c\u6210",calculateCellValue:i=>i.isFinished,dataType:"boolean"}],X={index:"/api/app/cron-expressions",get:"/api/app/cron-expressions",create:"/api/app/cron-expressions",update:"/api/app/cron-expressions",delete:"/api/app/cron-expressions"},q=[{dataField:"notificationProviderIds",path:"/api/app/recurring-notifications/notification-provider-lookup"},{dataField:"receiverIds",path:"/api/app/recurring-notifications/receiver-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receivers"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/receiver-groups"},{dataField:"topicIds",path:"/api/app/recurring-notifications/topic-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/topics"},{dataField:"textContentNotificationTemplateId",path:"/api/app/recurring-notifications/notification-template-lookup",pathForSelectedDisplay:"/api/app/jbnotifier-admin/notification-templates"},{dataField:"receiverGroupIds",path:"/api/app/recurring-notifications/receiver-group-lookup",pathForSelectedDisplay:"/api/app//receiver-groups"},{dataField:"notificationCategoryId",path:"/api/app/recurring-notifications/notification-category-lookup",pathForSelectedDisplay:"/api/app/notification-categories"}],W=[{name:"tenantName",translateKeys:["Saas::DisplayName:TenantName"]},{dataField:"startDate",translateKeys:["AbpAuditLogging::StartDate"]},{dataField:"endDate",translateKeys:["AbpAuditLogging::EndDate"]},{name:"status",translateKeys:["AbpAccount::Status"]}],M=[{dataField:"id",mapping:["notificationSchedulePlan","id"]},{dataField:"concurrencyStamp",mapping:["notificationInfo","concurrencyStamp"]},{dataField:"name",mapping:["notificationInfo","name"]},{name:"type",mapping:["notificationInfo","type"]},{dataField:"title",queryStringKey:"Title",mapping:["notificationInfo","title"]},{name:"tenantName",queryStringKey:"TenantName",mapping:["tenant","name"]},{name:"notificationCategoryName",queryStringKey:"NotificationCategoryName",mapping:["notificationCategory","name"]},{name:"notificationProviders",queryStringKey:"NotificationProviderNames",mapping:["notificationProviders"]},{name:"receiverDescription",queryStringKey:"ReceiverDescription",mapping:["receiverDescription"]},{dataField:"notificationDataFetchEndpoint",queryStringKey:"NotificationDataFetchEndpoint",mapping:["notificationInfo","notificationDataFetchEndpoint"]},{dataField:"hookEndpoint",queryStringKey:"HookEndpoint",mapping:["notificationInfo","hookEndpoint"]},{name:"isFinished",queryStringKey:"IsFinished",mapping:["notificationInfo","isFinished"]},{name:"isDeletable",queryStringKey:"IsDeletable",mapping:["isDeletable"]},{name:"isEditable",queryStringKey:"IsEditable",mapping:["isEditable"]},{dataField:"notificationProviderIds",mapping:["notificationProviderIds"]},{dataField:"isSendToAllReceivers",mapping:["notificationInfo","isSendToAllReceivers"]},{dataField:"receiverIds",mapping:["receiverIds"]},{dataField:"receiverGroupIds",mapping:["receiverGroupIds"]},{dataField:"topicIds",mapping:["topicIds"]},{dataField:"isIndependentNotificationSettingUsing",mapping:["notificationInfo","isIndependentNotificationSettingUsing"]},{dataField:"notificationSettings",mapping:["notificationSettings"]},{dataField:"notificationSchedulePlan",mapping:["notificationSchedulePlan"]},{dataField:"notificationCategoryId",mapping:["notificationCategory","id"]},{dataField:"subtitle",mapping:["notificationInfo","subtitle"]},{dataField:"textContent",mapping:["notificationInfo","textContent"]},{dataField:"htmlContent",mapping:["notificationInfo","htmlContent"]},{dataField:"isFetchNotificationDataByEachReceiver",mapping:["notificationInfo","isFetchNotificationDataByEachReceiver"]},{dataField:"filePaths",mapping:["notificationInfo","filePaths"]},{dataField:"hyperlink",mapping:["notificationInfo","hyperlink"]},{dataField:"textContentNotificationTemplateId",mapping:["notificationInfo","textContentNotificationTemplateId"]},{dataField:"textContentNotificationTemplateArgs",mapping:["notificationInfo","textContentNotificationTemplateArgs"]},{dataField:"expectedPushCount",mapping:["notificationSchedulePlan","expectedPushCount"]},{dataField:"expectedEndTime",mapping:["notificationSchedulePlan","expectedEndTime"]}],T=[{itemType:"group",name:"TopGroup",cssClass:"TopGroup",colCount:8,items:[{itemType:"group",name:"BasicGroup",cssClass:"BasicGroup",caption:"\u57fa\u672c",colSpan:5,items:[{dataField:"name"},{dataField:"notificationProviderIds",label:{visible:!1}},{dataField:"isSendToAllReceivers"},{dataField:"receiverIds",label:{visible:!1}},{dataField:"receiverGroupIds",label:{visible:!1}},{dataField:"topicIds",label:{visible:!1}}]},{itemType:"group",name:"SettingGroup",cssClass:"SettingGroup",caption:"\u8a2d\u5b9a",colSpan:3,items:[{dataField:"isIndependentNotificationSettingUsing"},{dataField:"notificationSettings",label:{visible:!1}}]}]},{itemType:"group",name:"NotificationContentGroup",cssClass:"NotificationContentGroup",caption:"\u901a\u77e5\u5167\u5bb9",colCount:2,items:[{dataField:"isUsingTemplate",cssClass:"isUsingTemplate",label:{visible:!1}},{itemType:"empty"},{dataField:"notificationCategoryId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"title",editorType:"dxTextBox"},{dataField:"subtitle",editorType:"dxTextBox"},{itemType:"group",name:"CustomContentGroup",cssClass:"CustomContentGroup",colSpan:2,colCount:8,items:[{dataField:"textContent",editorType:"dxTextArea",editorOptions:{height:"240px"},colSpan:3},{dataField:"htmlContent",editorType:"dxHtmlEditor",editorOptions:{...s(35130).W,height:"240px"},colSpan:5}]},{itemType:"group",name:"NotificationTemplateGroup",cssClass:"NotificationTemplateGroup NotificationTemplateGroup--inactive",colSpan:2,colCount:2,items:[{dataField:"textContentNotificationTemplateId",editorType:"dxSelectBox"},{itemType:"empty"},{dataField:"textContentNotificationTemplateArgs",label:{visible:!1},colSpan:2}]},{itemType:"group",name:"EndpointGroup",cssClass:"EndpointGroup",colSpan:2,colCount:3,items:[{dataField:"expectedPushCount",editorType:"dxNumberBox",editorOptions:{min:0}},{dataField:"expectedEndTime",editorType:"dxDateBox",editorOptions:{dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss.SSS+08:00"}},{dataField:"notificationDataFetchEndpoint",editorType:"dxTextBox"},{dataField:"hookEndpoint",editorType:"dxTextBox"},{dataField:"isFetchNotificationDataByEachReceiver",editorType:"dxCheckBox",cssClass:"basic-form-checkbox"},{dataField:"filePaths",editorType:"dxTextBox"},{dataField:"hyperlink",editorType:"dxTextBox"}]}]}],ie={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:T,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}},te={popup:{title:"::\u7de8\u8f2f",wrapperAttr:{class:"basic-popup"},showCloseButton:!0,toolbarItems:[{toolbar:"bottom",template:"bottom-toolbar"}]},form:{colCount:1,items:T,elementAttr:{class:"basic-form basic-form-edit basic-form-edit-notification"}}};var ne=s(82310),oe=s(98179),ae=s(92931);function se(i,a){if(1&i&&e._UZ(0,"app-grid-general-filter",13),2&i){e.oxw();const t=e.MAs(3);e.Q6J("grid",t)}}function re(i,a){1&i&&e.GkF(0)}const pe=i=>({$implicit:i});function le(i,a){if(1&i&&(e.ynx(0),e.YNc(1,re,1,0,"ng-container",14),e.BQk()),2&i){const t=a.$implicit,n=e.oxw().$implicit,o=e.oxw(2);e.xp6(),e.Q6J("ngTemplateOutlet",o.templateStore.getGridTemplates(n.key))("ngTemplateOutletContext",e.VKq(2,pe,t))}}function de(i,a){if(1&i&&(e.ynx(0),e.YNc(1,le,2,4,"ng-container",1),e.BQk()),2&i){const t=a.$implicit;e.xp6(),e.Q6J("dxTemplateOf",t.key)}}function ce(i,a){1&i&&e._UZ(0,"app-notification-provider-definitions",15),2&i&&e.Q6J("cellInfo",a.$implicit)}function fe(i,a){if(1&i&&e._UZ(0,"app-receiver-tag-box",16),2&i){const t=a.$implicit;e.Q6J("cellInfo",t)("hideReceiverTagBox",t.row.data.isForAllReceivers)}}function me(i,a){if(1&i&&e._UZ(0,"app-receiver-group-tree-view",17),2&i){const t=a.$implicit;e.Q6J("cellInfo",t)("hideReceiverTreeView",t.row.data.isForAllReceivers)}}function ue(i,a){1&i&&e._UZ(0,"app-notification-setting-items-radio-group",15),2&i&&e.Q6J("cellInfo",a.$implicit)}function ge(i,a){if(1&i&&e._UZ(0,"app-notification-setting-items",18),2&i){const t=a.$implicit;e.Q6J("isUseCustomSetting","custom"===t.row.data.notificationSettingRadioGroup)("cellInfo",t)}}function ve(i,a){1&i&&e._UZ(0,"app-notification-schedule-plans",15),2&i&&e.Q6J("cellInfo",a.$implicit)}function xe(i,a){1&i&&e.GkF(0)}const _e=(i,a,t)=>({$implicit:i,templateKey:a,notificationTemplateId:t});function he(i,a){if(1&i&&e.YNc(0,xe,1,0,"ng-container",14),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.notificationTemplateStore.getTemplates(n.key))("ngTemplateOutletContext",e.kEZ(2,_e,t,n.key,o.notificationTemplateId))}}function Te(i,a){1&i&&e.GkF(0)}const ye=(i,a)=>({$implicit:i,templateKey:a});function Ce(i,a){if(1&i&&e.YNc(0,Te,1,0,"ng-container",14),2&i){const t=e.oxw().$implicit,n=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.notificationTemplateStore.getTemplates(n.key))("ngTemplateOutletContext",e.WLB(2,ye,t,n.key))}}function be(i,a){if(1&i&&(e.ynx(0),e.YNc(1,he,1,6,"ng-container")(2,Ce,1,5),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(),e.um2(1,"textContentNotificationTemplateArgs"===t.key?1:2)}}function Fe(i,a){if(1&i&&(e.ynx(0),e.YNc(1,be,3,1,"ng-container",1),e.BQk()),2&i){const t=a.$implicit;e.xp6(),e.Q6J("dxTemplateOf",t.key)}}function Se(i,a){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-bottom-toolbar-btns",13),e.qZA()),2&i){e.oxw();const t=e.MAs(3);e.xp6(),e.Q6J("grid",t)}}const Ie=()=>({type:"default",stylingMode:"contained"});function De(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"dx-data-grid",2,3),e.NdJ("onInitNewRow",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onInitNewRow(o))}),e.TgZ(4,"dxo-toolbar"),e._UZ(5,"dxi-item",4),e.TgZ(6,"dxi-item",5),e.YNc(7,se,1,1,"app-grid-general-filter",6),e.qZA(),e._UZ(8,"dxi-item",7),e.qZA(),e.YNc(9,de,2,1,"ng-container",8),e.ALo(10,"keyvalue"),e.YNc(11,ce,1,1,"app-notification-provider-definitions",9)(12,fe,1,2,"app-receiver-tag-box",10)(13,me,1,2,"app-receiver-group-tree-view",11)(14,ue,1,1,"app-notification-setting-items-radio-group",9)(15,ge,1,2,"app-notification-setting-items",12)(16,ve,1,1,"app-notification-schedule-plans",9)(17,Fe,2,1,"ng-container",8),e.ALo(18,"keyvalue"),e.YNc(19,Se,2,1,"div",1),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("dataFieldTranslationKeysMapping",t.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",t.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",t.dataFieldLookupSourceMapping)("editingPropertiesForCreating",t.editingPropertiesForCreating)("editingPropertiesForUpdating",t.editingPropertiesForUpdating)("columns",t.columns)("dataSource",t.gridDataSource),e.xp6(3),e.Q6J("options",e.DdM(21,Ie)),e.xp6(4),e.Q6J("ngForOf",e.lcZ(10,17,t.templateStore.gridTemplates)),e.xp6(2),e.Q6J("dxTemplateOf","notification-provider-definition"),e.xp6(),e.Q6J("dxTemplateOf","receivers-tag-box"),e.xp6(),e.Q6J("dxTemplateOf","receiver-groups-tag-box"),e.xp6(),e.Q6J("dxTemplateOf","notification-setting-radio-group"),e.xp6(),e.Q6J("dxTemplateOf","notification-setting-items"),e.xp6(),e.Q6J("dxTemplateOf","notification-schedule-plans"),e.xp6(),e.Q6J("ngForOf",e.lcZ(18,19,t.notificationTemplateStore.templates)),e.xp6(2),e.Q6J("dxTemplateOf","bottom-toolbar")}}let Ee=(()=>{class i{constructor(t,n,o){this.gridDataSourceService=t,this.templateStore=n,this.notificationTemplateStore=o,this.visibleChange=new e.vpe,this.columns=H,this.cRUDEndpoints=X,this.dataFieldLookupSourceMapping=q,this.dataFieldTranslationKeysMapping=W,this.relatedDataValueAndQueryStringKeyMapping=M,this.editingPropertiesForCreating=ie,this.editingPropertiesForUpdating=te,this.onHidden=()=>{this.visibleChange.emit(!1)},this.onInitNewRow=r=>{r.data.cronExpression=this.cronExpression,r.data.isSendToAllReceivers=!0,r.data.isIndependentNotificationSettingUsing=!1,r.data.isUsingTemplate=!1,r.data.isFetchNotificationDataByEachReceiver=!1,r.data.receiverIds=[],r.data.receiverGroupIds=[],r.data.topicIds=[]}}ngOnChanges(t){this.cronExpression&&t.visible?.currentValue&&(this.gridDataSource=this.gridDataSourceService.getDataSource({index:`/api/app/jbnotifier-admin/cron-expressions/${this.cronExpression}/notifications`,create:"/api/app/jbnotifier-admin/cron-expressions/notifications",delete:"/api/app/jbnotifier-admin/cron-expressions/notifications"},M))}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(I.I),e.Y36(D.z),e.Y36(ne.P))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-job-list"]],inputs:{visible:"visible",cronExpression:"cronExpression",cronDescription:"cronDescription"},outputs:{visibleChange:"visibleChange"},features:[e.TTD],decls:2,vars:4,consts:[["contentTemplate","content",3,"visible","showCloseButton","title","visibleChange","onHidden"],[4,"dxTemplate","dxTemplateOf"],["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource","onInitNewRow"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],[4,"ngFor","ngForOf"],[3,"cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hideReceiverTagBox",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hideReceiverTreeView",4,"dxTemplate","dxTemplateOf"],[3,"isUseCustomSetting","cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"grid"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"cellInfo"],[3,"cellInfo","hideReceiverTagBox"],[3,"cellInfo","hideReceiverTreeView"],[3,"isUseCustomSetting","cellInfo"]],template:function(n,o){1&n&&(e.TgZ(0,"dx-popup",0),e.NdJ("visibleChange",function(p){return o.visible=p})("onHidden",function(){return o.onHidden()}),e.YNc(1,De,20,22,"div",1),e.qZA()),2&n&&(e.Q6J("visible",o.visible)("showCloseButton",!0)("title","\u901a\u77e5\u6e05\u55ae |"+o.cronDescription),e.xp6(),e.Q6J("dxTemplateOf","content"))},dependencies:[d.sg,d.tP,N.p6,m.ZT3,oe.x,P.e,m.y1f,J._,ae.R,R.w,v,x,_,h.b,d.Nd]})}return i})();const Ne=["grid"];function Pe(i,a){if(1&i&&e._UZ(0,"app-grid-general-filter",12),2&i){e.oxw();const t=e.MAs(2);e.Q6J("grid",t)}}function Je(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"dx-button",13),e.NdJ("onClick",function(){const r=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.showJobList(r.data.cronExpression,r.data.description))}),e.qZA()}2&i&&e.Q6J("text","\u901a\u77e5\u6e05\u55ae")}function Re(i,a){1&i&&e._UZ(0,"app-notification-provider-definitions",14),2&i&&e.Q6J("cellInfo",a.$implicit)}function Ae(i,a){if(1&i&&e._UZ(0,"app-receiver-tag-box",15),2&i){const t=a.$implicit,n=e.oxw();e.Q6J("cellInfo",t)("hideReceiverTagBox",n.isForAllReceivers)}}function Qe(i,a){if(1&i&&e._UZ(0,"app-notification-tree-view",16),2&i){const t=a.$implicit,n=e.oxw();e.Q6J("cellInfo",t)("hideReceiverTreeView",n.isForAllReceivers)}}function Oe(i,a){1&i&&e._UZ(0,"app-notification-setting-items-radio-group",14),2&i&&e.Q6J("cellInfo",a.$implicit)}function Me(i,a){if(1&i&&e._UZ(0,"app-notification-setting-items",17),2&i){const t=a.$implicit,n=e.oxw();e.Q6J("isUseCustomSetting",n.isUseCustomSetting)("cellInfo",t)}}function Ue(i,a){1&i&&e._UZ(0,"app-notification-schedule-plans",14),2&i&&e.Q6J("cellInfo",a.$implicit)}const Ve=()=>({type:"default",stylingMode:"contained"}),Be=[{path:"",component:(()=>{class i{constructor(t,n,o,r){this.gridDataSourceService=t,this.templateStore=n,this.appRestService=o,this.tenantChooserService=r,this.columns=U,this.cRUDEndpoints=b,this.dataFieldLookupSourceMapping=V,this.dataFieldTranslationKeysMapping=B,this.relatedDataValueAndQueryStringKeyMapping=F,this.editingPropertiesForCreating=w,this.editingPropertiesForUpdating=Z,this.gridProperties={repaintChangesOnly:!0,editing:{allowAdding:!1}},this.jobListVisible=!1,this.showJobList=(p,f)=>{this.jobListVisible=!0,this.cronExpression=p,this.cronDescription=f},this.columns[1].setCellValue=(p,f,Ye)=>{if(/^(\*|([0-9]|1[0-9]|2[0-3]))(\/\d+)?(\s+(\*|([0-9]|[1-5][0-9]))(\/\d+)?){4}$/.test(f))return(0,G.n)(this.appRestService.request({method:"GET",url:`/api/app/jbnotifier-admin/cron-expressions/description/${f}`})).then(Ke=>{p.id=f,p.description=Ke.description})},this.gridDataSource=this.gridDataSourceService.getDataSource(b,F),this.tenantChooserService.tenantId$.subscribe(p=>{this.grid.instance.refresh()})}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(I.I),e.Y36(D.z),e.Y36(E.$),e.Y36(L.L))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-cron-expressions"]],viewQuery:function(n,o){if(1&n&&e.Gf(Ne,5),2&n){let r;e.iGM(r=e.CRH())&&(o.grid=r.first)}},decls:16,vars:19,consts:[["appGridFeature","",3,"dataFieldTranslationKeysMapping","datafieldValueQueryStringKeyMapping","dataFieldLookUpSourceMapping","editingPropertiesForCreating","editingPropertiesForUpdating","columns","dataSource"],["grid",""],["name","addRowButton","location","before","widget","dxButton","cssClass","mb-1",3,"options"],["location","after"],[3,"grid",4,"dxTemplate"],["name","applyFilterButton","cssClass","d-none"],["type","default",3,"text","onClick",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hideReceiverTagBox",4,"dxTemplate","dxTemplateOf"],[3,"cellInfo","hideReceiverTreeView",4,"dxTemplate","dxTemplateOf"],[3,"isUseCustomSetting","cellInfo",4,"dxTemplate","dxTemplateOf"],[3,"visible","cronExpression","cronDescription","visibleChange"],[3,"grid"],["type","default",3,"text","onClick"],[3,"cellInfo"],[3,"cellInfo","hideReceiverTagBox"],[3,"cellInfo","hideReceiverTreeView"],[3,"isUseCustomSetting","cellInfo"]],template:function(n,o){1&n&&(e._UZ(0,"app-tenant-chooser"),e.TgZ(1,"dx-data-grid",0,1)(3,"dxo-toolbar"),e._UZ(4,"dxi-item",2),e.TgZ(5,"dxi-item",3),e.YNc(6,Pe,1,1,"app-grid-general-filter",4),e.qZA(),e._UZ(7,"dxi-item",5),e.qZA(),e.YNc(8,Je,1,1,"dx-button",6)(9,Re,1,1,"app-notification-provider-definitions",7)(10,Ae,1,2,"app-receiver-tag-box",8)(11,Qe,1,2,"app-notification-tree-view",9)(12,Oe,1,1,"app-notification-setting-items-radio-group",7)(13,Me,1,2,"app-notification-setting-items",10)(14,Ue,1,1,"app-notification-schedule-plans",7),e.qZA(),e.TgZ(15,"app-job-list",11),e.NdJ("visibleChange",function(p){return o.jobListVisible=p}),e.qZA()),2&n&&(e.xp6(),e.Q6J("dataFieldTranslationKeysMapping",o.dataFieldTranslationKeysMapping)("datafieldValueQueryStringKeyMapping",o.relatedDataValueAndQueryStringKeyMapping)("dataFieldLookUpSourceMapping",o.dataFieldLookupSourceMapping)("editingPropertiesForCreating",o.editingPropertiesForCreating)("editingPropertiesForUpdating",o.editingPropertiesForUpdating)("columns",o.columns)("dataSource",o.gridDataSource),e.xp6(3),e.Q6J("options",e.DdM(18,Ve)),e.xp6(4),e.Q6J("dxTemplateOf","job-list"),e.xp6(),e.Q6J("dxTemplateOf","notification-provider-definition"),e.xp6(),e.Q6J("dxTemplateOf","receivers-tag-box"),e.xp6(),e.Q6J("dxTemplateOf","receiver-groups-tag-box"),e.xp6(),e.Q6J("dxTemplateOf","notification-setting-radio-group"),e.xp6(),e.Q6J("dxTemplateOf","notification-setting-items"),e.xp6(),e.Q6J("dxTemplateOf","notification-schedule-plans"),e.xp6(),e.Q6J("visible",o.jobListVisible)("cronExpression",o.cronExpression)("cronDescription",o.cronDescription))},dependencies:[K.K,N.p6,m.ZT3,P.e,m.y1f,J._,R.w,v,x,_,h.b,O.m,Y.D,Ee]})}return i})()}];let we=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[C.Bz.forChild(Be),C.Bz]})}return i})();var Ze=s(5533),Ge=s(41992);let Le=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[d.ez,Ze.P,we,A.m,v,x,_,h.b,O.m,Ge.e]})}return i})()}}]);